{"version":3,"sources":["../../../../../../apps/web/components/Sidebar.tsx","../../../../../../apps/web/components/AppShell.tsx","../../../../../../apps/web/components/Dashboard.tsx","../../../../../../apps/web/components/LivestockApp.tsx","../../../../../../apps/web/components/DietComposer.tsx","../../../../../../apps/web/components/AnimalInventory.tsx","../../../../../../apps/web/components/Calculator.tsx","../../../../../../apps/web/components/EventsList.tsx","../../../../../../apps/web/components/ReportsManager.tsx","../../../../../../apps/web/components/UsersManager.tsx","../../../../../../apps/web/components/UserProfile.tsx","../../../../../../apps/web/components/DataManager.tsx","../../../../../../apps/web/services/appConfig.ts","../../../../../../apps/web/services/sigpacService.ts","../../../../../../apps/web/services/weightEngine.ts","../../../../../../apps/web/components/DataSeeder.tsx","../../../../../../node_modules/shared/src/utils.ts","../../../../../../apps/web/services/priceEngine.ts","../../../../../../node_modules/lucide-react/src/defaultAttributes.ts","../../../../../../apps/web/hooks/useAnimalCalculator.ts","../../../../../../apps/web/services/weatherService.ts","../../../../../../node_modules/lucide-react/src/icons/plus.ts","../../../../../../node_modules/lucide-react/src/icons/chart-column.ts","../../../../../../node_modules/lucide-react/src/icons/credit-card.ts","../../../../../../node_modules/lucide-react/src/icons/user.ts","../../../../../../node_modules/lucide-react/src/icons/house.ts","../../../../../../node_modules/lucide-react/src/icons/circle-alert.ts","../../../../../../node_modules/lucide-react/src/icons/users.ts","../../../../../../node_modules/lucide-react/src/icons/upload.ts","../../../../../../node_modules/lucide-react/src/icons/database.ts","../../../../../../node_modules/lucide-react/src/icons/trash-2.ts","../../../../../../node_modules/lucide-react/src/createLucideIcon.ts","../../../../../../node_modules/lucide-react/src/icons/search.ts","../../../../../../node_modules/lucide-react/src/icons/calendar.ts","../../../../../../node_modules/lucide-react/src/icons/x.ts","../../../../../../node_modules/lucide-react/src/icons/trending-up.ts","../../../../../../node_modules/lucide-react/src/icons/log-out.ts","../../../../../../node_modules/lucide-react/src/icons/download.ts","../../../../../../node_modules/lucide-react/src/icons/briefcase.ts","../../../../../../apps/web/services/feedDatabase.ts","../../../../../../apps/web/services/carcassEngine.ts","../../../../../../apps/web/services/locationService.ts","../../../../../../node_modules/lucide-react/src/Icon.ts","../../../../../../node_modules/lucide-react/src/icons/map-pin.ts","../../../../../../node_modules/lucide-react/src/icons/save.ts","../../../../../../node_modules/lucide-react/src/icons/pen.ts","../../../../../../node_modules/lucide-react/src/icons/phone.ts","../../../../../../node_modules/lucide-react/src/icons/shield.ts","../../../../../../apps/web/services/lifecycleEngine.ts","../../../../../../node_modules/lucide-react/src/icons/beef.ts","../../../../../../apps/web/services/soilEngine.ts","../../../../../../apps/web/services/eventManager.ts","../../../../../../apps/web/services/carcassQualityEngine.ts","../../../../../../apps/web/services/breedManager.ts","../../../../../../apps/web/services/nutritionEngine.ts","../../../../../../apps/web/components/FarmsManager.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React from 'react';\r\nimport { useStorage } from '@/context/StorageContext';\r\nimport {\r\n    Home,\r\n    MapPin,\r\n    Beef,\r\n    Calendar,\r\n    TrendingUp,\r\n    BarChart3,\r\n    Database,\r\n    User,\r\n    Users,\r\n    LogOut\r\n} from 'lucide-react';\r\n\r\ninterface SidebarProps {\r\n    activeTab: string;\r\n    onTabChange: (tab: string) => void;\r\n    onLogout: () => void;\r\n}\r\n\r\nexport function Sidebar({ activeTab, onTabChange, onLogout }: SidebarProps) {\r\n    const { read, write } = useStorage();\r\n    const sessionUser = read('appSession', 'Usuario') as string;\r\n    const userAvatar = read('userAvatar', null);\r\n\r\n    // Auto-promote Gerencia if stuck as worker\r\n    React.useEffect(() => {\r\n        const users = read<any[]>('users', []);\r\n        // Check for Gerencia account existence and permissions\r\n        const gerenciaUser = users.find((u: any) => u.name.toLowerCase().includes('gerencia') || u.email === 'gerencia@sotodelprior.com');\r\n\r\n        if (!gerenciaUser) {\r\n            // Create Gerencia if missing\r\n            const newGerencia = {\r\n                name: 'Gerencia',\r\n                email: 'gerencia@sotodelprior.com',\r\n                pass: 'admin123',\r\n                role: 'admin',\r\n                joined: new Date().toISOString(),\r\n                jobTitle: 'Direcci√≥n General',\r\n                firstName: 'Gerencia',\r\n                lastName: 'Soto del Prior'\r\n            };\r\n            write('users', [...users, newGerencia]);\r\n            console.log('Auto-created Gerencia account');\r\n        } else if (gerenciaUser.role !== 'admin') {\r\n            // Promote to admin\r\n            const updatedUser = { ...gerenciaUser, role: 'admin' };\r\n            const otherUsers = users.filter((u: any) => u.name !== gerenciaUser.name);\r\n            write('users', [...otherUsers, updatedUser]);\r\n            // Force page reload to reflect changes\r\n            window.location.reload();\r\n        }\r\n    }, [sessionUser, read, write]);\r\n\r\n    const users = read<any[]>('users', []);\r\n    const currentUser = users.find((u: any) => u.name === sessionUser);\r\n    const role = currentUser?.role || 'worker';\r\n\r\n    // Hard override for Gerencia to ensure access even if DB is out of sync\r\n    const isGerencia = sessionUser?.toLowerCase().includes('gerencia') || sessionUser === 'gerencia@sotodelprior.com';\r\n    const isAdmin = role === 'admin' || isGerencia;\r\n\r\n    const navItems = [\r\n        { id: 'home', label: 'Inicio', icon: Home },\r\n        { id: 'farms', label: 'Fincas', icon: MapPin },\r\n        { id: 'animals', label: 'Animales', icon: Beef },\r\n        { id: 'events', label: 'Eventos', icon: Calendar },\r\n        { id: 'calculator', label: 'Rendimiento', icon: TrendingUp },\r\n        { id: 'reports', label: 'Reportes', icon: BarChart3 },\r\n        { id: 'users', label: 'Equipo', icon: Users },\r\n        { id: 'data', label: 'Datos', icon: Database }\r\n    ].filter(item => {\r\n        if (item.id === 'calculator' || item.id === 'reports' || item.id === 'data' || item.id === 'users') {\r\n            return isAdmin; // Only Admins see Financials/Data/Users\r\n        }\r\n        return true;\r\n    });\r\n\r\n    const displayUser = sessionUser || 'Usuario';\r\n\r\n    return (\r\n        <aside className=\"w-64 bg-white border-r border-gray-200 h-screen flex flex-col fixed left-0 top-0 z-30 shadow-sm\">\r\n            <div className=\"p-4 flex justify-center border-b border-gray-100\">\r\n                <img src=\"/logo-text.png\" alt=\"SOTO DEL PRIOR\" className=\"h-12\" />\r\n            </div>\r\n            <div className=\"p-6 border-b border-gray-100 flex items-center gap-3\">\r\n                {userAvatar ? (\r\n                    <img\r\n                        src={userAvatar}\r\n                        alt=\"Profile\"\r\n                        className=\"w-10 h-10 rounded-full object-cover\"\r\n                    />\r\n                ) : (\r\n                    <div className=\"w-10 h-10 bg-green-600 rounded-full flex items-center justify-center text-white font-bold text-lg\">\r\n                        {displayUser.charAt(0).toUpperCase()}\r\n                    </div>\r\n                )}\r\n                <div>\r\n                    <p className=\"font-bold text-gray-800 text-sm truncate w-32\">{displayUser}</p>\r\n                    <p className=\"text-xs text-gray-500 capitalize\">{isAdmin ? 'Administrador' : role}</p>\r\n                </div>\r\n            </div>\r\n\r\n            <nav className=\"flex-1 p-4 space-y-1 overflow-y-auto\">\r\n                {navItems.map((item) => (\r\n                    <button\r\n                        key={item.id}\r\n                        onClick={() => onTabChange(item.id)}\r\n                        className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium transition-colors ${activeTab === item.id\r\n                            ? 'bg-green-50 text-green-700'\r\n                            : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900'\r\n                            }`}\r\n                    >\r\n                        <item.icon className=\"w-5 h-5\" />\r\n                        {item.label}\r\n                    </button>\r\n                ))}\r\n            </nav>\r\n\r\n            <div className=\"p-4 border-t border-gray-100 space-y-2\">\r\n                <button\r\n                    onClick={() => onTabChange('profile')}\r\n                    className={`w-full flex items-center gap-3 px-4 py-2 text-sm font-medium transition-colors ${activeTab === 'profile'\r\n                        ? 'bg-green-50 text-green-700'\r\n                        : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900'\r\n                        }`}\r\n                >\r\n                    <User className=\"w-5 h-5\" />\r\n                    <span>Mi Perfil</span>\r\n                </button>\r\n\r\n                <button\r\n                    onClick={onLogout}\r\n                    className=\"w-full flex items-center gap-3 px-4 py-2 text-sm text-red-600 hover:text-red-700 rounded-lg hover:bg-red-50\"\r\n                >\r\n                    <LogOut className=\"w-5 h-5\" />\r\n                    <span>Cerrar Sesi√≥n</span>\r\n                </button>\r\n            </div>\r\n        </aside>\r\n    );\r\n}\r\n","'use client';\r\n\r\nimport React from 'react';\r\nimport { Sidebar } from './Sidebar';\r\n\r\ninterface AppShellProps {\r\n    children: React.ReactNode;\r\n    activeTab: string;\r\n    onTabChange: (tab: string) => void;\r\n    onLogout: () => void;\r\n}\r\n\r\nexport function AppShell({ children, activeTab, onTabChange, onLogout }: AppShellProps) {\r\n    return (\r\n        <div className=\"min-h-screen bg-gray-50 flex\">\r\n            <Sidebar activeTab={activeTab} onTabChange={onTabChange} onLogout={onLogout} />\r\n            <main className=\"flex-1 ml-64 p-8\">\r\n                <div className=\"max-w-7xl mx-auto\">\r\n                    {children}\r\n                </div>\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n","'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useStorage } from '@/context/StorageContext';\r\nimport { WeatherService } from '@/services/weatherService';\r\nimport { EventManager } from '@/services/eventManager';\r\n\r\nexport function Dashboard({ onNavigate }: { onNavigate?: (tab: string) => void }) {\r\n\r\n\r\n    const { read } = useStorage();\r\n    const [weather, setWeather] = useState<any>(null);\r\n    const [loadingWeather, setLoadingWeather] = useState(true);\r\n    const [animalStats, setAnimalStats] = useState<any>({ males: {}, females: {} });\r\n    const [upcomingEvents, setUpcomingEvents] = useState<any[]>([]);\r\n    const [selectedTabIndex, setSelectedTabIndex] = useState(0);\r\n    const [farmsList, setFarmsList] = useState<any[]>([]);\r\n\r\n    useEffect(() => {\r\n        try {\r\n            // 1. Load Weather\r\n            // 1. Load Weather for SELECTED FARM\r\n            const sessionUser = read('appSession', '');\r\n\r\n            // Ensure we read as 'fincas_' + sessionUser\r\n            const farms = read<any[]>(`fincas_${sessionUser}`, []);\r\n            setFarmsList(farms);\r\n\r\n            if (!farms || farms.length === 0) {\r\n                setLoadingWeather(false);\r\n                setWeather(null);\r\n            } else {\r\n                // Determine which farm to show based on selected tab\r\n                const currentFarm = farms[selectedTabIndex] || farms[0];\r\n\r\n                // Default coordinates (Madrid - Center of Spain) if farm has no coords\r\n                let lat = 40.4168;\r\n                let lon = -3.7038;\r\n                let farmName = currentFarm.name || 'General';\r\n\r\n                // Retrieve coordinates from the selected farm\r\n                if (currentFarm.coords && currentFarm.coords.lat && currentFarm.coords.lng) {\r\n                    lat = currentFarm.coords.lat;\r\n                    lon = currentFarm.coords.lng;\r\n                }\r\n\r\n                WeatherService.getCurrentWeather(lat, lon).then(async data => {\r\n                    // Fetch Forecast\r\n                    const forecast = await WeatherService.getForecast(lat, lon);\r\n\r\n                    const windyUrl = `https://embed.windy.com/embed2.html?lat=${lat}&lon=${lon}&width=650&height=450&zoom=8&level=surface&overlay=wind&product=ecmwf&menu=&message=&marker=true&pressure=&type=map&location=coordinates&detail=&metricWind=km%2Fh&metricTemp=%C2%B0C&radarRange=-1`;\r\n\r\n                    if (data) {\r\n                        setWeather({\r\n                            temp: data.temperature,\r\n                            condition: data.weather_desc,\r\n                            location: farmName,\r\n                            mapUrl: windyUrl,\r\n                            icon: WeatherService.getWeatherIcon ? WeatherService.getWeatherIcon(data.weather_code) : '‚õÖ',\r\n                            humidity: data.humidity,\r\n                            wind: data.wind_speed,\r\n                            forecast: forecast\r\n                        });\r\n                    } else {\r\n                        setWeather(null);\r\n                    }\r\n                    setLoadingWeather(false);\r\n                }).catch(err => {\r\n                    console.error(\"Weather load error:\", err);\r\n                    setWeather(null);\r\n                    setLoadingWeather(false);\r\n                });\r\n            }\r\n\r\n            // 2. Load Animal Stats\r\n            const animals = read(`animals_${sessionUser}`, []);\r\n            const stats = calculateAnimalStats(animals);\r\n            setAnimalStats(stats);\r\n\r\n            // 3. Load Events\r\n            const events = read('events', []);\r\n            const upcoming = EventManager.getUpcomingEvents(events, 30);\r\n            setUpcomingEvents(upcoming);\r\n\r\n        } catch (e) {\r\n            // Silent catch for initialization errors\r\n        }\r\n    }, [read, selectedTabIndex]);\r\n\r\n    const calculateAnimalStats = (animals: any[]) => {\r\n        const maleCounts: Record<string, number> = {\r\n            'Bueyes': 0, 'Toros': 0, 'Utreros': 0, 'Novillos': 0, 'A√±ojos': 0, 'Terneros': 0, 'Becerros': 0\r\n        };\r\n        const femaleCounts: Record<string, number> = {\r\n            'Nodrizas': 0, 'Vacas': 0, 'Novillas': 0, 'A√±ojas': 0, 'Terneras': 0, 'Becerras': 0\r\n        };\r\n\r\n        animals.forEach((a: any) => {\r\n            // Filter out non-active animals from stats\r\n            // Explicitly list all statuses that should be excluded from active stats\r\n            const excludedStatuses = ['Sacrificado', 'Muerto', 'Vendido', 'Baja', 'Inactivo', 'Retirado'];\r\n            if (a.status && excludedStatuses.includes(a.status)) return;\r\n            // Also ensure that if a status is present, it must be 'Activo' to be included\r\n            if (a.status && a.status !== 'Activo') return;\r\n\r\n            // If category is missing, calculate it based on Age\r\n            let cat = a.category;\r\n\r\n            if (!cat || cat === 'Sin Clasificar') {\r\n                const birth = new Date(a.birth || a.birthDate);\r\n                const now = new Date();\r\n                const ageMonths = (now.getTime() - birth.getTime()) / (1000 * 60 * 60 * 24 * 30.44);\r\n\r\n                if (a.sex === 'Macho') {\r\n                    if (ageMonths < 6) cat = 'Becerros';\r\n                    else if (ageMonths < 12) cat = 'Terneros';\r\n                    else if (ageMonths < 24) cat = 'A√±ojos'; // Often 12-24\r\n                    else if (ageMonths < 36) cat = 'Novillos';\r\n                    else if (ageMonths < 48) cat = 'Utreros'; // 3-4 years\r\n                    else cat = 'Toros';\r\n                } else {\r\n                    if (ageMonths < 6) cat = 'Becerras';\r\n                    else if (ageMonths < 12) cat = 'Terneras';\r\n                    else if (ageMonths < 24) cat = 'A√±ojas';\r\n                    else if (ageMonths < 36) cat = 'Novillas';\r\n                    else cat = 'Vacas'; // Default adult\r\n                }\r\n            }\r\n\r\n            // Stats Correction: Force 'Castrado' to display as 'Buey' for now.\r\n            // In a full implementation, we would check the exact castration date vs birth date here.\r\n            // But to ensure the 3 Bueyes appear correctly for the user despite stale data:\r\n            if (a.sex === 'Castrado') {\r\n                cat = 'Buey';\r\n            }\r\n\r\n            if (a.sex === 'Macho' || a.sex === 'Castrado') {\r\n                if (maleCounts[cat] !== undefined) maleCounts[cat]++;\r\n                else if (cat === 'Buey') maleCounts['Bueyes']++; // Special case for Buey -> Bueyes\r\n                else {\r\n                    // Fallback for \"Toro\" vs \"Toros\"\r\n                    if (maleCounts[cat + 's'] !== undefined) maleCounts[cat + 's']++;\r\n                }\r\n            } else {\r\n                if (femaleCounts[cat] !== undefined) femaleCounts[cat]++;\r\n                else {\r\n                    if (femaleCounts[cat + 's'] !== undefined) femaleCounts[cat + 's']++;\r\n                }\r\n            }\r\n        });\r\n        return { males: maleCounts, females: femaleCounts };\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* Header */}\r\n            <div>\r\n                <h2 className=\"text-2xl font-bold text-gray-800\">Resumen General</h2>\r\n                <p className=\"text-gray-600\">Vista general de tu operaci√≥n ganadera</p>\r\n            </div>\r\n\r\n            {/* Dashboard Main Grid: Weather (Left) & Animals (Right) */}\r\n            <div className=\"grid grid-cols-1 xl:grid-cols-2 gap-6\">\r\n\r\n                {/* Weather Card Column */}\r\n                <div className=\"flex flex-col h-full space-y-2\">\r\n                    {/* Tabs for Farms */}\r\n                    {farmsList.length > 0 && (\r\n                        <div className=\"flex space-x-1 overflow-x-auto pb-1\">\r\n                            {farmsList.map((farm, idx) => (\r\n                                <button\r\n                                    key={farm.id || idx}\r\n                                    onClick={() => {\r\n                                        setSelectedTabIndex(idx);\r\n                                        setLoadingWeather(true); // Trigger loading state\r\n                                    }}\r\n                                    className={`px-4 py-2 rounded-t-lg text-sm font-medium transition-colors border-t border-l border-r ${selectedTabIndex === idx\r\n                                        ? 'bg-white text-green-700 border-gray-200 border-b-white z-10 -mb-px shadow-[0_-2px_5px_rgba(0,0,0,0.02)]'\r\n                                        : 'bg-gray-100 text-gray-500 hover:bg-gray_50 border-transparent hover:text-gray-700'\r\n                                        }`}\r\n                                >\r\n                                    {farm.name}\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n\r\n                    {(weather || loadingWeather) && (\r\n                        <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6 h-full flex flex-col justify-between\">\r\n                            {/* Top Row: Current Weather */}\r\n                            <div className=\"flex justify-between items-start mb-6\">\r\n                                <div>\r\n                                    <p className=\"text-gray-500 font-bold text-xs uppercase tracking-wider mb-1\">Clima en: {weather?.location || '...'}</p>\r\n                                    {loadingWeather ? (\r\n                                        <p className=\"text-sm animate-pulse text-gray-400\">Cargando...</p>\r\n                                    ) : weather ? (\r\n                                        <div className=\"flex items-center gap-4\">\r\n                                            <span className=\"text-4xl\">{weather.icon}</span>\r\n                                            <div>\r\n                                                <span className=\"text-4xl font-extrabold block text-gray-800\">{weather.temp}¬∞C</span>\r\n                                                <span className=\"text-sm text-gray-500 capitalize font-medium\">{weather.condition}</span>\r\n                                            </div>\r\n                                        </div>\r\n                                    ) : (\r\n                                        <p className=\"text-sm text-gray-400\">No disponible</p>\r\n                                    )}\r\n                                </div>\r\n                                {weather && (\r\n                                    <div className=\"text-right text-xs text-gray-400 font-medium space-y-1 bg-gray-50 px-3 py-2 rounded-lg\">\r\n                                        <p>üíß {weather.humidity}% Humedad</p>\r\n                                        <p>üí® {weather.wind} km/h Viento</p>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n\r\n                            {/* Bottom Row: Split View */}\r\n                            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4 border-t border-gray-100 pt-4 flex-1\">\r\n\r\n                                {/* Left: Windy Map */}\r\n                                {!loadingWeather && weather?.mapUrl && (\r\n                                    <div className=\"h-48 rounded-lg overflow-hidden border border-gray-200 shadow-sm relative group\">\r\n                                        <div className=\"absolute top-2 left-2 z-10 bg-white/80 text-gray-700 text-[10px] px-2 py-1 rounded backdrop-blur-md font-bold shadow-sm\">\r\n                                            üå™Ô∏è Viento vivo\r\n                                        </div>\r\n                                        <iframe\r\n                                            src={weather.mapUrl}\r\n                                            className=\"w-full h-full border-none\"\r\n                                            title=\"Windy Weather Map\"\r\n                                        />\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* Right: Forecast */}\r\n                                {!loadingWeather && weather?.forecast && (\r\n                                    <div className=\"flex flex-col justify-between h-48\">\r\n                                        <p className=\"text-xs font-bold text-gray-400 uppercase tracking-widest mb-2\">Pron√≥stico 3 D√≠as</p>\r\n                                        <div className=\"flex-1 flex flex-col gap-2\">\r\n                                            {weather.forecast.map((d: any, i: number) => (\r\n                                                <div key={i} className=\"flex items-center justify-between bg-gray-50 rounded-lg p-3 border border-gray-100 hover:border-gray-300 transition-colors flex-1\">\r\n                                                    <div className=\"flex items-center gap-3\">\r\n                                                        <span className=\"text-xl\">{d.icon}</span>\r\n                                                        <span className=\"text-sm font-bold text-gray-700 capitalize\">\r\n                                                            {new Date(d.date).toLocaleDateString(undefined, { weekday: 'short' })}\r\n                                                        </span>\r\n                                                    </div>\r\n\r\n                                                    <div className=\"flex items-center gap-3\">\r\n                                                        {d.precip > 0 && (\r\n                                                            <span className=\"text-[10px] font-bold text-gray-800 bg-gray-100 px-1.5 py-0.5 rounded-full flex items-center gap-1\">\r\n                                                                ‚òî {d.precip}mm\r\n                                                            </span>\r\n                                                        )}\r\n                                                        <div className=\"text-sm font-bold text-gray-800\">\r\n                                                            <span className=\"text-gray-900\">{Math.round(d.max)}¬∞</span>\r\n                                                            <span className=\"mx-1 text-gray-300\">/</span>\r\n                                                            <span className=\"text-gray-500\">{Math.round(d.min)}¬∞</span>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Animals Card Column */}\r\n                <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6 h-full\">\r\n                    <h3 className=\"text-lg font-bold text-gray-800 mb-4\">Distribuci√≥n de Animales</h3>\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8 h-full\">\r\n                        <div>\r\n                            <h4 className=\"text-blue-600 font-semibold mb-3 border-b border-blue-100 pb-2\">Machos</h4>\r\n                            <div className=\"space-y-2 text-sm\">\r\n                                {Object.entries(animalStats.males).map(([cat, count]) => (\r\n                                    <div key={cat} className=\"flex justify-between\">\r\n                                        <span className=\"text-gray-600\">{cat}</span>\r\n                                        <span className=\"font-bold text-gray-900\">{String(count)}</span>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                        <div>\r\n                            <h4 className=\"text-pink-600 font-semibold mb-3 border-b border-pink-100 pb-2\">Hembras</h4>\r\n                            <div className=\"space-y-2 text-sm\">\r\n                                {Object.entries(animalStats.females).map(([cat, count]) => (\r\n                                    <div key={cat} className=\"flex justify-between\">\r\n                                        <span className=\"text-gray-600\">{cat}</span>\r\n                                        <span className=\"font-bold text-gray-900\">{String(count)}</span>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Grid: Actions & Alerts */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                {/* Quick Actions */}\r\n                <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">\r\n                    <h3 className=\"text-lg font-bold text-gray-800 mb-4\">Acciones R√°pidas</h3>\r\n                    <div className=\"space-y-3\">\r\n                        <button\r\n                            onClick={() => onNavigate?.('animals')}\r\n                            className=\"w-full bg-green-50 text-green-700 font-medium py-2 px-4 rounded-lg hover:bg-green-100 transition-colors text-left flex items-center gap-2\"\r\n                        >\r\n                            Registrar nuevo animal\r\n                        </button>\r\n                        <button\r\n                            onClick={() => onNavigate?.('events')}\r\n                            className=\"w-full bg-green-50 text-green-700 font-medium py-2 px-4 rounded-lg hover:bg-green-100 transition-colors text-left flex items-center gap-2\"\r\n                        >\r\n                            Registrar evento sanitario\r\n                        </button>\r\n                        <button\r\n                            onClick={() => onNavigate?.('reports')}\r\n                            className=\"w-full bg-green-50 text-green-700 font-medium py-2 px-4 rounded-lg hover:bg-green-100 transition-colors text-left flex items-center gap-2\"\r\n                        >\r\n                            Generar reporte mensual\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Events */}\r\n                <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6\">\r\n                    <h3 className=\"text-lg font-bold text-gray-800 mb-4\">Pr√≥ximos Eventos</h3>\r\n                    <div className=\"space-y-3\">\r\n                        {upcomingEvents.length === 0 ? (\r\n                            <p className=\"text-gray-500 italic text-sm\">No hay eventos pr√≥ximos.</p>\r\n                        ) : (\r\n                            upcomingEvents.map((evt, i) => (\r\n                                <div key={i} className=\"flex items-start gap-3 p-3 bg-gray-50 rounded-lg\">\r\n                                    <div className=\"w-2 h-2 mt-2 rounded-full bg-green-500 shrink-0\"></div>\r\n                                    <div>\r\n                                        <p className=\"font-medium text-gray-800 text-sm\">{evt.type}</p>\r\n                                        <p className=\"text-xs text-gray-500\">{new Date(evt.date).toLocaleDateString()} - {evt.animalId || 'General'}</p>\r\n                                    </div>\r\n                                </div>\r\n                            ))\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { signOut } from 'next-auth/react';\r\nimport { useStorage } from '@/context/StorageContext';\r\nimport { AppShell } from '@/components/AppShell';\r\n\r\nimport { Dashboard } from '@/components/Dashboard';\r\nimport { FarmsManager } from '@/components/FarmsManager';\r\nimport { AnimalInventory } from '@/components/AnimalInventory';\r\nimport { Calculator } from '@/components/Calculator';\r\nimport { EventsList } from '@/components/EventsList';\r\nimport { ReportsManager } from '@/components/ReportsManager';\r\nimport { UsersManager } from '@/components/UsersManager';\r\nimport { UserProfile } from '@/components/UserProfile';\r\nimport { DataSeeder } from '@/components/DataSeeder';\r\nimport { DataManager } from '@/components/DataManager';\r\n\r\n\r\n\r\nexport function LivestockApp({ session }: { session: any }) {\r\n    const { write, isLoaded } = useStorage();\r\n    const [activeTab, setActiveTab] = useState('home');\r\n\r\n    // Sync session name for the app components that expect a local user\r\n    const sessionUser = session?.user?.name || session?.user?.email || null;\r\n\r\n    useEffect(() => {\r\n        if (sessionUser && isLoaded) {\r\n            write('appSession', sessionUser);\r\n            write('sessionUser', sessionUser); // Sync for legacy components\r\n        }\r\n    }, [sessionUser, isLoaded, write]);\r\n\r\n    const handleLogout = async () => {\r\n        write('appSession', null);\r\n        await signOut({ callbackUrl: '/login' });\r\n    };\r\n\r\n    if (!isLoaded) {\r\n        return (\r\n            <div className=\"flex items-center justify-center min-h-screen bg-gray-50\">\r\n                <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600\"></div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <AppShell activeTab={activeTab} onTabChange={setActiveTab} onLogout={handleLogout}>\r\n            <DataSeeder />\r\n            {activeTab === 'home' && <Dashboard onNavigate={setActiveTab} />}\r\n            {activeTab === 'farms' && <FarmsManager />}\r\n            {activeTab === 'animals' && <AnimalInventory />}\r\n            {activeTab === 'events' && <EventsList />}\r\n            {activeTab === 'calculator' && <Calculator />}\r\n            {activeTab === 'reports' && <ReportsManager />}\r\n            {activeTab === 'users' && <UsersManager />}\r\n            {activeTab === 'profile' && <UserProfile />}\r\n            {activeTab === 'data' && <DataManager />}\r\n        </AppShell>\r\n    );\r\n}\r\n","'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { NutritionEngine, DietAlert, SynergyResult } from '@/services/nutritionEngine';\r\nimport { CarcassEngine } from '@/services/carcassEngine';\r\nimport { FEED_DATABASE, FeedItem } from '@/services/feedDatabase';\r\nimport { BreedManager } from '@/services/breedManager';\r\n\r\nimport { Breed } from '@/services/breedManager';\r\n\r\ninterface DietComposerProps {\r\n    animal: any; // Using any for flexibility with the AnimalInventory types\r\n    onClose: () => void;\r\n    fatherBreed?: Breed;\r\n    motherBreed?: Breed;\r\n}\r\n\r\n// ... imports ...\r\n\r\ninterface RationItem {\r\n    id: string;\r\n    feed: FeedItem;\r\n    kg_as_fed: number;\r\n}\r\n\r\nexport function DietComposer({ animal, onClose, fatherBreed, motherBreed }: DietComposerProps) {\r\n    // --- State ---\r\n    const [ration, setRation] = useState<RationItem[]>([]);\r\n    const [availableFeeds, setAvailableFeeds] = useState<FeedItem[]>(FEED_DATABASE);\r\n    const [selectedFeedId, setSelectedFeedId] = useState('');\r\n\r\n    // NEW: Bellota Type State\r\n    const [bellotaType, setBellotaType] = useState<string>('ENCINA'); // ENCINA | ROBLE\r\n\r\n    // Results State\r\n    const [stats, setStats] = useState<any>(null);\r\n    const [alerts, setAlerts] = useState<DietAlert[]>([]);\r\n    const [synergies, setSynergies] = useState<SynergyResult[]>([]);\r\n    const [carcass, setCarcass] = useState<any>(null);\r\n    const [adg, setAdg] = useState(0);\r\n\r\n    // --- Format Helpers ---\r\n    const formatNum = (n: number, d = 2) => n ? n.toFixed(d) : '0';\r\n\r\n    // --- Calculations ---\r\n    useEffect(() => {\r\n        calculateDiet();\r\n    }, [ration, animal, bellotaType]); // Added bellotaType dep\r\n\r\n    const calculateDiet = () => {\r\n        // 1. Aggregates\r\n        let totalKg = 0;\r\n        let totalDM = 0;\r\n        let totalMcal = 0;\r\n        let totalProteinG = 0;\r\n        let totalFDN_kg = 0;\r\n        let bellotaKg = 0;\r\n\r\n\r\n\r\n        const ingredientsForEngine: any[] = [];\r\n        let hasBellota = false;\r\n\r\n        ration.forEach(item => {\r\n            const kg = item.kg_as_fed;\r\n            const dm = item.feed.dm_percent / 100;\r\n            const kgDM = kg * dm;\r\n\r\n            totalKg += kg;\r\n            totalDM += kgDM;\r\n            totalMcal += (item.feed.energy_mcal * kgDM);\r\n            totalProteinG += (item.feed.protein_percent / 100 * kgDM * 1000);\r\n            totalFDN_kg += (item.feed.fiber_percent / 100 * kgDM);\r\n\r\n            if (item.feed.name.toLowerCase().includes('bellota')) {\r\n                bellotaKg += kgDM;\r\n                hasBellota = true;\r\n            }\r\n\r\n            ingredientsForEngine.push({\r\n                feed_name: item.feed.name,\r\n                type: item.feed.category,\r\n                percent_dm: 0, // calc later\r\n                dm_kg: kgDM\r\n            });\r\n        });\r\n\r\n        // Calc Percentages\r\n        ingredientsForEngine.forEach(i => {\r\n            i.percent_dm = totalDM > 0 ? (i.dm_kg / totalDM) * 100 : 0;\r\n        });\r\n\r\n        // 2. Nutrition Engine Calls\r\n        const dietCP = totalDM > 0 ? (totalProteinG / 1000 / totalDM) * 100 : 0;\r\n        const dietMcal = totalDM > 0 ? totalMcal / totalDM : 0;\r\n        const dietFDN = totalDM > 0 ? (totalFDN_kg / totalDM) * 100 : 0;\r\n        // const bellotaPct = totalDM > 0 ? (bellotaKg / totalDM) * 100 : 0; // Calculated but unused directly in new signature\r\n\r\n        // --- NEW: Calculate Requirements for Validation ---\r\n        const age = calculateAgeMonths(animal.birth || animal.birthDate);\r\n        const breed = BreedManager.getBreedByName(animal.breed) || BreedManager.getAllBreeds()[0];\r\n        const adgTarget = breed.adg_feedlot || 1.2;\r\n\r\n        const reqs = NutritionEngine.calculateRequirements(\r\n            animal.weight || animal.currentWeight || 400,\r\n            adgTarget,\r\n            age,\r\n            'Cebo', // Defaulting to Cebo/Growth for composer\r\n            animal.sex || 'Macho'\r\n        );\r\n\r\n        // Validation\r\n        const activeFeeds = ration.map(r => ({ item: r.feed, amount: r.kg_as_fed }));\r\n        const metrics = {\r\n            totalDMI: totalDM,\r\n            totalFDN: totalFDN_kg, // kg\r\n            totalProteinVal: totalProteinG, // grams\r\n            totalEnergy: totalMcal, // Total Mcal\r\n            reqs: reqs\r\n        };\r\n\r\n        const system = hasBellota ? 'Montanera' : 'Intensivo'; // Simple inference\r\n\r\n        const newAlerts = NutritionEngine.validateDiet(\r\n            activeFeeds,\r\n            metrics,\r\n            system\r\n        );\r\n        setAlerts(newAlerts);\r\n\r\n        // Synergies\r\n        const currentMonth = new Date().getMonth(); // 0-11\r\n\r\n        // Tolerance context for synergies\r\n        const context = {\r\n            currentMonth,\r\n            breedTolerance: breed.heat_tolerance,\r\n            breedCode: breed.code\r\n        };\r\n\r\n        const activeSynergies = NutritionEngine.calculateSynergies(\r\n            ingredientsForEngine,\r\n            { sex: animal.sex, ageMonths: age },\r\n            { bellotaType } // NEW\r\n        );\r\n        setSynergies(activeSynergies);\r\n\r\n        // ADG Prediction\r\n        // Map active synergies to the format expected by predictPerformance if needed\r\n        // Or simply pass the codes\r\n        const activeCodes = activeSynergies.filter(s => s.active).map(s => s.name);\r\n\r\n        // Pass \"active\" boolean to the specific legacy synergy object if needed, or use the new array\r\n        // We updated predictPerformance to accept activeSynergies: string[]\r\n        const predictedADG = NutritionEngine.predictPerformance(\r\n            breed,\r\n            dietMcal,\r\n            totalDM,\r\n            animal.weight || animal.currentWeight || 400,\r\n            { currentMonth, activeSynergies: activeCodes }\r\n        );\r\n        setAdg(predictedADG);\r\n\r\n        // Carcass Prediction\r\n        const synergyBonusObj = { marbling: 0, yield_percent: 0 };\r\n        activeSynergies.forEach(s => {\r\n            if (s.active) {\r\n                synergyBonusObj.marbling += s.bonus_marbling;\r\n                synergyBonusObj.yield_percent += s.bonus_yield;\r\n            }\r\n        });\r\n\r\n        const carcassPred = CarcassEngine.calculateCarcass(\r\n            animal.weight || animal.currentWeight || 400,\r\n            age,\r\n            breed,\r\n            dietMcal,\r\n            predictedADG,\r\n            {\r\n                sex: animal.sex,\r\n                synergyBonuses: synergyBonusObj,\r\n                currentMonth,\r\n                fatherBreed: fatherBreed || (animal.father ? BreedManager.getBreedByName(animal.father) : undefined),\r\n                motherBreed: motherBreed || (animal.mother ? BreedManager.getBreedByName(animal.mother) : undefined)\r\n            }\r\n        );\r\n        setCarcass(carcassPred);\r\n\r\n        // Env Impact\r\n        const env = NutritionEngine.calculateNitrogenBalance(\r\n            animal.weight || 400,\r\n            predictedADG,\r\n            dietCP,\r\n            totalDM\r\n        );\r\n\r\n        setStats({\r\n            dmi: totalDM,\r\n            mcal: dietMcal,\r\n            cp: dietCP,\r\n            fdn: dietFDN,\r\n            cost: ration.reduce((sum, i) => sum + (i.kg_as_fed * i.feed.cost_per_kg), 0),\r\n            env,\r\n            hasBellota // Store for UI\r\n        });\r\n    };\r\n\r\n    const calculateAgeMonths = (birthStr: string) => {\r\n        if (!birthStr) return 12;\r\n        const b = new Date(birthStr);\r\n        const n = new Date();\r\n        return (n.getTime() - b.getTime()) / (1000 * 60 * 60 * 24 * 30.44);\r\n    };\r\n\r\n    const addFeed = () => {\r\n        if (!selectedFeedId) return;\r\n        const feed = availableFeeds.find(f => f.id === selectedFeedId);\r\n        if (feed) {\r\n            setRation([...ration, { id: Date.now().toString(), feed, kg_as_fed: 1.0 }]);\r\n        }\r\n    };\r\n\r\n    const updateKg = (id: string, kg: number) => {\r\n        setRation(ration.map(r => r.id === id ? { ...r, kg_as_fed: kg } : r));\r\n    };\r\n\r\n    const removeFeed = (id: string) => {\r\n        setRation(ration.filter(r => r.id !== id));\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-full bg-gray-50 rounded-xl overflow-hidden\">\r\n            {/* Header */}\r\n            <div className=\"bg-gray-900 text-white p-4 flex justify-between items-center\">\r\n                <div>\r\n                    <h3 className=\"font-bold text-lg flex items-center gap-2\">\r\n                        üß™ Compositor de Dieta Cient√≠fica\r\n                        {synergies.length > 0 && <span className=\"bg-yellow-500 text-black text-xs px-2 py-0.5 rounded font-black animate-pulse\">SINERGIA ACTIVA</span>}\r\n                    </h3>\r\n                    <p className=\"text-gray-400 text-xs\">{animal.breed} ‚Ä¢ {animal.weight}kg ‚Ä¢ {animal.sex}</p>\r\n                </div>\r\n                <button onClick={onClose} className=\"text-gray-400 hover:text-white\">&times;</button>\r\n            </div>\r\n\r\n            <div className=\"flex-1 flex flex-col md:flex-row overflow-hidden\">\r\n                {/* Left: Ingredients */}\r\n                <div className=\"w-full md:w-1/2 p-4 flex flex-col gap-4 border-r border-gray-200 overflow-y-auto\">\r\n                    {/* Selector */}\r\n                    <div className=\"bg-white p-4 rounded-lg shadow-sm\">\r\n                        <label className=\"text-xs font-bold text-gray-500 uppercase mb-2 block\">A√±adir Ingrediente</label>\r\n                        <div className=\"flex gap-2\">\r\n                            <select\r\n                                className=\"flex-1 border rounded px-3 py-2 text-sm\"\r\n                                value={selectedFeedId}\r\n                                onChange={e => setSelectedFeedId(e.target.value)}\r\n                            >\r\n                                <option value=\"\">Seleccionar...</option>\r\n                                <optgroup label=\"Forrajes\">\r\n                                    {availableFeeds.filter(f => f.category === 'Forraje').map(f => <option key={f.id} value={f.id}>{f.name}</option>)}\r\n                                </optgroup>\r\n                                <optgroup label=\"Concentrados\">\r\n                                    {availableFeeds.filter(f => f.category === 'Concentrado').map(f => <option key={f.id} value={f.id}>{f.name}</option>)}\r\n                                </optgroup>\r\n                                <optgroup label=\"Suplementos\">\r\n                                    {availableFeeds.filter(f => f.category === 'Suplemento').map(f => <option key={f.id} value={f.id}>{f.name}</option>)}\r\n                                </optgroup>\r\n                            </select>\r\n                            <button\r\n                                onClick={addFeed}\r\n                                className=\"bg-green-600 text-white px-4 py-2 rounded text-sm hover:bg-green-700 font-bold\"\r\n                            >\r\n                                +\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* NEW: Bellota Type Selector */}\r\n                    {stats?.hasBellota && (\r\n                        <div className=\"bg-green-50 border border-green-200 p-4 rounded-lg shadow-sm animate-in fade-in slide-in-from-top-2\">\r\n                            <h4 className=\"flex items-center gap-2 text-sm font-bold text-green-900 mb-3\">\r\n                                üå≤ Origen de Montanera (Bellota)\r\n                            </h4>\r\n                            <div className=\"flex gap-4\">\r\n                                <label className={`flex-1 cursor-pointer border rounded-lg p-3 transition-all ${bellotaType === 'ENCINA' ? 'bg-white border-green-500 ring-2 ring-green-100 shadow' : 'bg-transparent border-green-200 hover:bg-white'}`}>\r\n                                    <div className=\"flex items-center gap-2 mb-1\">\r\n                                        <input\r\n                                            type=\"radio\"\r\n                                            name=\"bellotaType\"\r\n                                            value=\"ENCINA\"\r\n                                            checked={bellotaType === 'ENCINA'}\r\n                                            onChange={() => setBellotaType('ENCINA')}\r\n                                            className=\"text-green-600 focus:ring-green-500\"\r\n                                        />\r\n                                        <span className=\"font-bold text-gray-800 text-sm\">Bellota Encina</span>\r\n                                    </div>\r\n                                    <div className=\"text-xs text-green-700 font-medium pl-6\">Perfil: Alto Oleico</div>\r\n                                </label>\r\n\r\n                                <label className={`flex-1 cursor-pointer border rounded-lg p-3 transition-all ${bellotaType === 'ROBLE' ? 'bg-white border-green-500 ring-2 ring-green-100 shadow' : 'bg-transparent border-green-200 hover:bg-white'}`}>\r\n                                    <div className=\"flex items-center gap-2 mb-1\">\r\n                                        <input\r\n                                            type=\"radio\"\r\n                                            name=\"bellotaType\"\r\n                                            value=\"ROBLE\"\r\n                                            checked={bellotaType === 'ROBLE'}\r\n                                            onChange={() => setBellotaType('ROBLE')}\r\n                                            className=\"text-green-600 focus:ring-green-500\"\r\n                                        />\r\n                                        <span className=\"font-bold text-gray-800 text-sm\">Bellota Roble</span>\r\n                                    </div>\r\n                                    <div className=\"text-xs text-green-700 font-medium pl-6\">Perfil: Taninos</div>\r\n                                </label>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* List */}\r\n                    <div className=\"space-y-2\">\r\n                        {ration.map((item) => (\r\n                            <div key={item.id} className=\"bg-white p-3 rounded-lg shadow-sm border border-gray-100 flex items-center justify-between group\">\r\n                                <div className=\"flex-1\">\r\n                                    <div className=\"font-bold text-gray-800\">{item.feed.name}</div>\r\n                                    <div className=\"text-xs text-gray-400\">\r\n                                        {item.feed.category} ‚Ä¢ {(item.feed.dm_percent)}% MS\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <div className=\"flex flex-col items-end\">\r\n                                        <input\r\n                                            type=\"number\"\r\n                                            step=\"0.1\"\r\n                                            min=\"0\"\r\n                                            className=\"w-16 text-right border rounded px-1 py-1 font-mono text-sm font-bold text-gray-900 focus:ring-2 focus:ring-green-500 outline-none\"\r\n                                            value={item.kg_as_fed}\r\n                                            onChange={e => updateKg(item.id, parseFloat(e.target.value) || 0)}\r\n                                        />\r\n                                        <span className=\"text-[10px] text-gray-400\">kg fresco</span>\r\n                                    </div>\r\n                                    <button\r\n                                        onClick={() => removeFeed(item.id)}\r\n                                        className=\"text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity\"\r\n                                    >\r\n                                        üóëÔ∏è\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                        {ration.length === 0 && (\r\n                            <div className=\"text-center py-10 text-gray-400 italic text-sm\">\r\n                                No hay ingredientes en la raci√≥n.\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Right: Dashboard */}\r\n                <div className=\"w-full md:w-1/2 bg-gray-50 flex flex-col overflow-y-auto\">\r\n\r\n                    {/* 1. Alerts Section */}\r\n                    <div className=\"p-4 space-y-2\">\r\n                        {alerts.map((alert, i) => (\r\n                            <div key={i} className={`p-3 rounded-lg border text-sm flex items-start gap-3 ${alert.level === 'critical' ? 'bg-red-50 border-red-200 text-red-800' : 'bg-yellow-50 border-yellow-200 text-yellow-800'\r\n                                }`}>\r\n                                <span className=\"text-xl\">{alert.level === 'critical' ? '‚õî' : '‚ö†Ô∏è'}</span>\r\n                                <div>\r\n                                    <div className=\"font-bold\">{alert.message}</div>\r\n                                    {alert.action && <div className=\"text-xs mt-1 opacity-80 font-medium\">Recomendaci√≥n: {alert.action}</div>}\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                        {synergies.map((syn, i) => (\r\n                            <div key={`syn-${i}`} className=\"bg-indigo-50 border border-indigo-200 p-3 rounded-lg text-sm flex items-start gap-3 text-indigo-900\">\r\n                                <span className=\"text-xl\">üß¨</span>\r\n                                <div>\r\n                                    <div className=\"font-bold\">{syn.name.replace(/_/g, ' ')} DETECTADA</div>\r\n                                    <div className=\"text-xs mt-1\">{syn.description}</div>\r\n                                    <div className=\"text-xs mt-1 font-mono bg-indigo-100 px-1 rounded inline-block\">\r\n                                        +{(syn.bonus_marbling || 0).toFixed(1)} BMS ‚Ä¢ +{(syn.bonus_yield || 0).toFixed(1)}% Rendimiento\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n\r\n                    {/* 2. KPIs Grid */}\r\n                    <div className=\"grid grid-cols-2 gap-px bg-gray-200 border-t border-b border-gray-200\">\r\n                        <div className=\"bg-white p-4 flex flex-col items-center justify-center\">\r\n                            <span className=\"text-xs text-gray-500 uppercase tracking-wider\">ADG Predicha</span>\r\n                            <span className={`text-2xl font-black ${adg < 0 ? 'text-red-600' : (adg > 1.2 ? 'text-green-600' : 'text-gray-700')}`}>\r\n                                {formatNum(adg)} <span className=\"text-sm font-normal text-gray-400\">kg/d√≠a</span>\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"bg-white p-4 flex flex-col items-center justify-center\">\r\n                            <span className=\"text-xs text-gray-500 uppercase tracking-wider\">Coste D√≠a</span>\r\n                            <span className=\"text-2xl font-black text-gray-700\">\r\n                                {formatNum(stats ? stats.cost : 0)} <span className=\"text-sm font-normal text-gray-400\">‚Ç¨</span>\r\n                            </span>\r\n                        </div>\r\n                        <div className=\"bg-white p-4 flex flex-col items-center justify-center\">\r\n                            <span className=\"text-xs text-gray-500 uppercase tracking-wider\">Marmoleo (BMS)</span>\r\n                            <span className=\"text-2xl font-black text-purple-700\">\r\n                                {carcass ? carcass.bms : '?'} <span className=\"text-sm font-normal text-purple-300\">/ 12</span>\r\n                            </span>\r\n                            <span className=\"text-[10px] text-gray-400\">Score: {carcass ? carcass.marbling_score : 0}</span>\r\n                        </div>\r\n                        <div className=\"bg-white p-4 flex flex-col items-center justify-center\">\r\n                            <span className=\"text-xs text-gray-500 uppercase tracking-wider\">Clasificaci√≥n</span>\r\n                            <span className=\"text-2xl font-black text-gray-800\">\r\n                                {carcass ? carcass.conformation : '?'}\r\n                            </span>\r\n                            <span className=\"text-[10px] text-gray-400\">Rend: {carcass ? carcass.rc_percent : 0}%</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* 3. Nutrient Breakdown (Mini) */}\r\n                    <div className=\"p-4 bg-white\">\r\n                        <h4 className=\"text-xs font-bold text-gray-400 uppercase mb-3\">Balance Nutricional</h4>\r\n                        <div className=\"space-y-2 text-sm\">\r\n                            <div className=\"flex justify-between\">\r\n                                <span className=\"text-gray-600\">Energ√≠a Dieta</span>\r\n                                <span className=\"font-mono font-bold\">{formatNum(stats?.mcal)} Mcal/kg</span>\r\n                            </div>\r\n                            <div className=\"w-full bg-gray-100 h-2 rounded-full overflow-hidden\">\r\n                                <div className=\"bg-blue-500 h-full\" style={{ width: `${Math.min(100, (stats?.mcal || 0) / 3 * 100)}%` }}></div>\r\n                            </div>\r\n\r\n                            <div className=\"flex justify-between pt-2\">\r\n                                <span className=\"text-gray-600\">Prote√≠na Bruta</span>\r\n                                <span className=\"font-mono font-bold\">{formatNum(stats?.cp)} %</span>\r\n                            </div>\r\n                            <div className=\"w-full bg-gray-100 h-2 rounded-full overflow-hidden\">\r\n                                <div className=\"bg-green-500 h-full\" style={{ width: `${Math.min(100, (stats?.cp || 0) / 20 * 100)}%` }}></div>\r\n                            </div>\r\n\r\n                            <div className=\"flex justify-between pt-2\">\r\n                                <span className=\"text-gray-600\">Fibra (FDN)</span>\r\n                                <span className={`font-mono font-bold ${stats?.fdn < 28 ? 'text-red-500' : 'text-gray-900'}`}>{formatNum(stats?.fdn)} %</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* 4. Eco Impact */}\r\n                    {stats?.env && (\r\n                        <div className={`p-4 border-t ${stats.env.is_critical ? 'bg-red-50' : 'bg-green-50'}`}>\r\n                            <h4 className=\"text-xs font-bold uppercase mb-2 flex items-center gap-2\">\r\n                                <span className=\"text-lg\">üåç</span> Impacto Ambiental\r\n                            </h4>\r\n                            <div className=\"grid grid-cols-2 gap-2 text-xs\">\r\n                                <div>\r\n                                    <div className=\"text-gray-500\">Eficiencia N</div>\r\n                                    <div className=\"font-bold text-lg\">{stats.env.efficiency_pct}%</div>\r\n                                </div>\r\n                                <div>\r\n                                    <div className=\"text-gray-500\">Excreci√≥n/kg Ganancia</div>\r\n                                    <div className={`font-bold text-lg ${stats.env.is_critical ? 'text-red-600' : 'text-green-700'}`}>\r\n                                        {stats.env.excretion_per_gain} g N\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                </div>\r\n            </div>\r\n            {/* Footer Actions */}\r\n            <div className=\"p-4 bg-white border-t border-gray-200 flex justify-end gap-2\">\r\n                <button\r\n                    className=\"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg text-sm font-medium\"\r\n                    onClick={onClose}\r\n                >\r\n                    Cancelar\r\n                </button>\r\n                <button\r\n                    className=\"px-6 py-2 bg-gray-900 text-white rounded-lg text-sm font-bold hover:bg-black transition-colors shadow-lg flex items-center gap-2\"\r\n                    onClick={() => alert(\"Guardado en historial (Simulado)\")}\r\n                >\r\n                    üíæ Guardar Dieta\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\n// Helper mock if needed for calculateAge but I added it inside.\r\n","'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useStorage } from '@/context/StorageContext';\r\n\r\nimport { CarcassEngine } from '@/services/carcassEngine';\r\nimport { CarcassQualityEngine } from '@/services/carcassQualityEngine';\r\nimport { BreedManager } from '@/services/breedManager';\r\nimport { DietComposer } from './DietComposer';\r\nimport { NutritionEngine } from '@/services/nutritionEngine';\r\n\r\nexport function AnimalInventory() {\r\n    const { read, write } = useStorage();\r\n\r\n    // Helper for Detailed Age\r\n    const calculateAgeDetailed = (birthDateStr: string) => {\r\n        if (!birthDateStr) return '?';\r\n        const birth = new Date(birthDateStr);\r\n        const now = new Date();\r\n\r\n        let years = now.getFullYear() - birth.getFullYear();\r\n        let months = now.getMonth() - birth.getMonth();\r\n        let days = now.getDate() - birth.getDate();\r\n\r\n        if (days < 0) {\r\n            months--;\r\n            const prevMonth = new Date(now.getFullYear(), now.getMonth(), 0);\r\n            days += prevMonth.getDate();\r\n        }\r\n        if (months < 0) {\r\n            years--;\r\n            months += 12;\r\n        }\r\n\r\n        const parts = [];\r\n        if (years > 0) parts.push(`${years} a√±os`);\r\n        if (months > 0) parts.push(`${months} meses`);\r\n        if (days >= 0) parts.push(`${days} d√≠as`);\r\n\r\n        return parts.join(', ');\r\n    };\r\n\r\n    // Helper for Current Diet Status\r\n    const getDietStatus = (animal: any) => {\r\n        const birth = new Date(animal.birth || animal.birthDate);\r\n        const now = new Date();\r\n        const ageMonths = (now.getTime() - birth.getTime()) / (1000 * 60 * 60 * 24 * 30.44);\r\n\r\n        const isBellota = NutritionEngine.checkBellotaCompliance(\r\n            { ageMonths },\r\n            now.getMonth()\r\n        ).compliant;\r\n\r\n        // \"Solo los bueyes comen bellota y lecitina de soja\"\r\n        const isOx = animal.category === 'Buey' || (animal.sex === 'Castrado' && ageMonths > 12);\r\n\r\n        if (isBellota && isOx) {\r\n            return { label: 'Bellota y Soja (Premium)', color: 'bg-emerald-800 text-white border-emerald-900' };\r\n        } else if (animal.status === 'Lactancia' || animal.category?.includes('Nodriza')) {\r\n            return { label: 'Pasto + Suplemento Materno', color: 'bg-blue-100 text-blue-800 border-blue-200' };\r\n        } else if (animal.farm && animal.farm.toLowerCase().includes('feedlot')) {\r\n            return { label: 'Cebo Intensivo', color: 'bg-orange-100 text-orange-800 border-orange-200' };\r\n        } else {\r\n            return { label: 'Pasto / Mantenimiento', color: 'bg-green-50 text-green-700 border-green-200' };\r\n        }\r\n\r\n    };\r\n\r\n\r\n\r\n    const [animals, setAnimals] = useState<any[]>([]);\r\n    const [events, setEvents] = useState<any[]>([]); // Added Events State\r\n    const [farms, setFarms] = useState<any[]>([]);\r\n    const [sessionUser, setSessionUser] = useState('');\r\n    const [showForm, setShowForm] = useState(false);\r\n    const [showDiet, setShowDiet] = useState(false); // Diet Composer State\r\n\r\n    // New Animal Form State\r\n    const [newAnimal, setNewAnimal] = useState({\r\n        id: '',\r\n        name: '',\r\n        farm: '',\r\n        breed: '',\r\n        sex: '',\r\n        birth: '',\r\n        weight: '',\r\n        notes: '',\r\n        father: '',\r\n        mother: '',\r\n        corral: ''\r\n    });\r\n\r\n    useEffect(() => {\r\n        const user = read<string>('sessionUser', '');\r\n        setSessionUser(user);\r\n\r\n        if (user) {\r\n            const cleanKey = `animals_${user}`;\r\n            const dirtyKey = `animals_${user} `;\r\n\r\n            let animalsList = read<any[]>(cleanKey, []);\r\n            const dirtyList = read<any[]>(dirtyKey, []);\r\n            let needsSave = false;\r\n\r\n            // 1. Recover from dirty key if clean is empty\r\n            if (dirtyList.length > 0 && animalsList.length === 0) {\r\n                console.log(\"Recuperando datos antiguos...\");\r\n                animalsList = [...dirtyList];\r\n                write(dirtyKey, []); // Clear old\r\n                needsSave = true;\r\n            }\r\n\r\n            // 1b. HYDRATION: Convert Compact Arrays (Storage) -> Objects (Runtime UI)\r\n            // This allows us to store minimal data [500, 520] but use powerful objects {date, weight} in UI\r\n            animalsList = animalsList.map(a => {\r\n                if (a.h_w && Array.isArray(a.h_w) && !a.monthlyRecords) {\r\n                    // Reconstruct monthlyRecords from [weights]\r\n                    const records = [];\r\n                    const endDate = a.h_end ? new Date(a.h_end) : new Date();\r\n                    // Assume h_w is in chronological order ending at h_end\r\n                    for (let i = 0; i < a.h_w.length; i++) {\r\n                        const w = a.h_w[i];\r\n                        // Calculate date (reverse from end)\r\n                        // h_w index 0 is oldest? Let's assume index 0 is oldest.\r\n                        // Actually easier: h_w last item is h_end.\r\n                        const offsetMonths = (a.h_w.length - 1) - i;\r\n                        const d = new Date(endDate);\r\n                        d.setMonth(d.getMonth() - offsetMonths);\r\n\r\n                        records.push({\r\n                            date: d.toISOString().split('T')[0].substring(0, 7) + \"-01\",\r\n                            weightKg: w,\r\n                            adg: 0 // ADG lost in compression, can derive if needed or 0\r\n                        });\r\n                    }\r\n                    return { ...a, monthlyRecords: records };\r\n                }\r\n                return a;\r\n            });\r\n\r\n\r\n            // 2. Smart Synchronization (Fix weights using History)\r\n            const globalEvents = read<any[]>('events', []);\r\n\r\n            const syncedAnimals = animalsList.map(a => {\r\n                let correctedWeight = parseFloat(a.weight) || 0;\r\n                let source = 'current';\r\n\r\n                // Strategy A: Trust 'monthlyRecords' (calculated metrics)\r\n                if (a.monthlyRecords && Array.isArray(a.monthlyRecords) && a.monthlyRecords.length > 0) {\r\n                    // Sort by date desc\r\n                    const sortedRecords = [...a.monthlyRecords].sort((r1: any, r2: any) =>\r\n                        new Date(r2.date).getTime() - new Date(r1.date).getTime()\r\n                    );\r\n                    const lastRecord = sortedRecords[0];\r\n                    if (lastRecord && (lastRecord.weightKg || lastRecord.w)) {\r\n                        correctedWeight = parseFloat(lastRecord.weightKg || lastRecord.w);\r\n                        source = 'monthlyRecord';\r\n                    }\r\n                }\r\n                // Strategy B: Trace 'Pesaje' events if no records\r\n                else {\r\n                    const animalEvents = globalEvents.filter(e =>\r\n                        (e.animalId === a.id || e.animalCrotal === a.crotal) && e.type === 'Pesaje'\r\n                    ).sort((e1, e2) => new Date(e2.date).getTime() - new Date(e1.date).getTime());\r\n\r\n                    if (animalEvents.length > 0) {\r\n                        correctedWeight = parseFloat(animalEvents[0].weight) || correctedWeight;\r\n                        source = 'event';\r\n                    }\r\n                }\r\n\r\n                // Verify and Update if different (epsilon check for floats)\r\n                if (Math.abs(correctedWeight - parseFloat(a.weight)) > 0.1) {\r\n                    console.log(`Corrigiendo peso de ${a.crotal}: ${a.weight} -> ${correctedWeight} (Fuente: ${source})`);\r\n                    needsSave = true;\r\n                    return { ...a, weight: correctedWeight, currentWeight: correctedWeight };\r\n                }\r\n                return a;\r\n            });\r\n\r\n            if (needsSave) {\r\n                console.log(\"Sincronizando pesos con historial...\");\r\n                animalsList = syncedAnimals;\r\n                // Note: We write back full objects temporarily on load sync? \r\n                // Or should we keep them compact? \r\n                // Creating a save-back loop might re-trigger quota error if we expanded too much.\r\n                // Let's SKIP writing back on load for now unless critical, or re-compress.\r\n                // For safety, let's NOT write syncedList immediately if it's huge. \r\n                // But we must update state.\r\n            }\r\n\r\n            setAnimals(animalsList);\r\n            setFarms(read<any[]>(`fincas_${user}`, []));\r\n            setEvents(globalEvents);\r\n        }\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [read]);\r\n\r\n    const closeDetail = () => {\r\n        setSelectedAnimal(null);\r\n        setShowDiet(false);\r\n    };\r\n\r\n    const handleSaveAnimal = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!newAnimal.id || !newAnimal.farm || !newAnimal.sex || !newAnimal.breed) {\r\n            alert(\"Por favor completa los campos obligatorios\");\r\n            return;\r\n        }\r\n\r\n        // Check duplicate ID\r\n        if (animals.find(a => a.id === newAnimal.id)) {\r\n            alert(\"Ya existe un animal con ese Crotal\");\r\n            return;\r\n        }\r\n\r\n        const animalEntry = {\r\n            ...newAnimal,\r\n            weight: parseFloat(newAnimal.weight) || 0,\r\n            category: 'Sin Clasificar', // Logic for category calculation could be added here\r\n            joined: new Date().toISOString()\r\n        };\r\n\r\n\r\n        const updated = [...animals, animalEntry];\r\n        setAnimals(updated);\r\n        write(`animals_${sessionUser}`, updated);\r\n\r\n        setShowForm(false);\r\n        setNewAnimal({\r\n            id: '', name: '', farm: '', breed: '', sex: '', birth: '', weight: '', notes: '', father: '', mother: '', corral: ''\r\n        });\r\n    };\r\n\r\n    const handleDownloadCSV = () => {\r\n        const headers = ['Crotal', 'Nombre', 'Finca', 'Raza', 'Sexo', 'Nacimiento', 'Peso', 'Notas', 'Padre', 'Madre'];\r\n        const csvContent = \"data:text/csv;charset=utf-8,\" + headers.join(\",\") + \"\\n\";\r\n        const encodedUri = encodeURI(csvContent);\r\n        const link = document.createElement(\"a\");\r\n        link.setAttribute(\"href\", encodedUri);\r\n        link.setAttribute(\"download\", \"plantilla_animales.csv\");\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n    };\r\n\r\n    const handleImportCSV = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (!file) return;\r\n\r\n        const reader = new FileReader();\r\n        reader.onload = (event) => {\r\n            const text = event.target?.result as string;\r\n            if (!text) return;\r\n\r\n            const lines = text.split('\\n');\r\n            const newAnimals: any[] = [];\r\n            let errorCount = 0;\r\n\r\n            // Skip header (i=1)\r\n            for (let i = 1; i < lines.length; i++) {\r\n                const line = lines[i].trim();\r\n                if (!line) continue;\r\n\r\n                const cols = line.split(',');\r\n                // Simple validation: check if required fields exist (Crotal)\r\n                if (cols.length < 5 || !cols[0]) {\r\n                    errorCount++;\r\n                    continue;\r\n                }\r\n\r\n                newAnimals.push({\r\n                    id: cols[0].trim(),\r\n                    name: cols[1]?.trim() || '',\r\n                    farm: cols[2]?.trim() || 'Sin Asignar',\r\n                    breed: cols[3]?.trim() || 'Desconocida',\r\n                    sex: cols[4]?.trim() || 'Hembra',\r\n                    birth: cols[5]?.trim() || '',\r\n                    weight: parseFloat(cols[6]) || 0,\r\n                    notes: cols[7]?.trim() || '',\r\n                    father: cols[8]?.trim() || '',\r\n                    mother: cols[9]?.trim() || '',\r\n                    corral: '', // Default empty corral\r\n                    joined: new Date().toISOString()\r\n                });\r\n            }\r\n\r\n            if (newAnimals.length > 0) {\r\n                const updated = [...animals, ...newAnimals];\r\n                setAnimals(updated);\r\n                write(`animals_${sessionUser}`, updated);\r\n                alert(`Importados ${newAnimals.length} animales.${errorCount > 0 ? `(${errorCount} errores)` : ''} `);\r\n            } else {\r\n                alert(\"No se pudieron importar animales. Verifica el formato del CSV.\");\r\n            }\r\n        };\r\n        reader.readAsText(file);\r\n    };\r\n\r\n\r\n\r\n    // Helper for Crotal Formatting\r\n    const formatCrotal = (crotal: string, invert: boolean = false) => {\r\n        if (!crotal) return '';\r\n        const len = crotal.length;\r\n        if (len < 4) return <span className={`font - medium ${invert ? 'text-white' : 'text-gray-900'} `}>{crotal}</span>;\r\n\r\n        const prefix = crotal.substring(0, len - 4);\r\n        const suffix = crotal.substring(len - 4);\r\n\r\n        return (\r\n            <span className={`${invert ? 'text-white' : 'text-gray-900'} inline-flex font-mono tracking-tight items-baseline`}>\r\n                <span className={`${invert ? 'text-green-100' : 'text-gray-400'} font-normal text-sm`}>{prefix}</span>\r\n                <span className=\"font-black text-xl\">{suffix}</span>\r\n            </span>\r\n        );\r\n    };\r\n\r\n    // Search Logic\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [showArchived, setShowArchived] = useState(false);\r\n\r\n    const filteredAnimals = animals.filter(a => {\r\n        // Status Filter: Toggle Mode\r\n        // If showArchived is TRUE -> Show ONLY Dead/Sacrificed/Sold\r\n        // If showArchived is FALSE -> Show ONLY Active (or undefined)\r\n        const isActive = !a.status || a.status === 'Activo';\r\n\r\n        if (showArchived) {\r\n            if (isActive) return false; // Hide active if we want archived\r\n        } else {\r\n            if (!isActive) return false; // Hide archived if we want active\r\n        }\r\n\r\n        if (!searchTerm) return true;\r\n        const term = searchTerm.toLowerCase();\r\n        // Check full ID, last 4 digits, or breed\r\n        return a.id.toLowerCase().includes(term) ||\r\n            a.id.slice(-4).includes(term) ||\r\n            (a.breed && a.breed.toLowerCase().includes(term));\r\n    });\r\n\r\n    // Detail Modal State\r\n    const [selectedAnimal, setSelectedAnimal] = useState<any>(null);\r\n\r\n    // Helper to find castration date from events or estimate\r\n    const getCastrationInfo = (animal: any) => {\r\n        // ideally we would look up events, but if not available we rely on properties\r\n        // For the specific oxen, we know they are castrated. \r\n        // We'll simulate finding the event date or using a property if we added one.\r\n        // For now, let's calculate based on birth + 7 months used in seeder if it's one of ours.\r\n        if (animal.sex === 'Castrado') {\r\n            const birth = new Date(animal.birth || animal.birthDate);\r\n            const castDate = new Date(birth);\r\n            castDate.setMonth(birth.getMonth() + 7); // Approximation matching seeder\r\n            return { isCastrated: true, date: castDate.toLocaleDateString() };\r\n        }\r\n        return { isCastrated: false, date: null };\r\n    };\r\n\r\n\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <div className=\"flex justify-between items-center\">\r\n                {/* ... rest of existing code ... */}\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-gray-800\">Inventario de Animales</h2>\r\n                    <p className=\"text-gray-600\">Registro y monitoreo individual</p>\r\n                </div>\r\n                <div className=\"flex gap-2\">\r\n                    <button\r\n                        onClick={handleDownloadCSV}\r\n                        className=\"bg-green-50 text-green-700 hover:bg-green-100 font-medium py-2 px-4 rounded-lg transition-colors text-sm\"\r\n                    >\r\n                        ‚¨á Plantilla CSV\r\n                    </button>\r\n                    <label className=\"bg-green-50 text-green-700 hover:bg-green-100 font-medium py-2 px-4 rounded-lg transition-colors cursor-pointer text-sm flex items-center\">\r\n                        ‚¨Ü Cargar CSV\r\n                        <input type=\"file\" accept=\".csv\" onChange={handleImportCSV} className=\"hidden\" />\r\n                    </label>\r\n\r\n                    <button\r\n                        onClick={() => setShowForm(!showForm)}\r\n                        className=\"bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg transition-colors\"\r\n                    >\r\n                        {showForm ? 'Cancelar' : 'Nuevo Animal'}\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Search Bar & Filters */}\r\n            <div className=\"flex flex-col md:flex-row gap-4 items-center justify-between\">\r\n                <div className=\"relative flex-1 w-full\">\r\n                    <input\r\n                        type=\"text\"\r\n                        placeholder=\"Buscar por Crotal (ej. 1234), Raza...\"\r\n                        className=\"w-full border rounded-lg px-4 py-3 text-lg shadow-sm focus:ring-2 focus:ring-green-500 outline-none\"\r\n                        value={searchTerm}\r\n                        onChange={e => setSearchTerm(e.target.value)}\r\n                    />\r\n                </div>\r\n\r\n                <label className=\"flex items-center gap-2 text-gray-700 font-medium cursor-pointer select-none whitespace-nowrap bg-gray-50 px-4 py-3 rounded-lg border border-gray-200 hover:bg-gray-100\">\r\n                    <input\r\n                        type=\"checkbox\"\r\n                        checked={showArchived}\r\n                        onChange={e => setShowArchived(e.target.checked)}\r\n                        className=\"w-5 h-5 text-green-600 rounded focus:ring-green-500\"\r\n                    />\r\n                    Ver Bajas\r\n                </label>\r\n            </div>\r\n\r\n            {/* Form */}\r\n            {showForm && (\r\n                <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100 animate-in fade-in slide-in-from-top-4\">\r\n                    <h3 className=\"text-lg font-bold text-gray-800 mb-4\">Registrar Animal</h3>\r\n                    <form onSubmit={handleSaveAnimal} className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                        {/* Fields remain same */}\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Crotal (ID) *</label>\r\n                            <input type=\"text\" required className=\"w-full border rounded-lg px-3 py-2\"\r\n                                value={newAnimal.id} onChange={e => setNewAnimal({ ...newAnimal, id: e.target.value })} />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Nombre (Opcional)</label>\r\n                            <input type=\"text\" className=\"w-full border rounded-lg px-3 py-2\"\r\n                                value={newAnimal.name} onChange={e => setNewAnimal({ ...newAnimal, name: e.target.value })} />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Finca *</label>\r\n                            <select required className=\"w-full border rounded-lg px-3 py-2\"\r\n                                value={newAnimal.farm} onChange={e => setNewAnimal({ ...newAnimal, farm: e.target.value })}>\r\n                                <option value=\"\">Selecciona Finca</option>\r\n                                <option value={farms[0]?.name || \"SOTO del PRIOR\"}>{farms[0]?.name || \"SOTO del PRIOR\"}</option>\r\n                                {farms.slice(1).map(f => <option key={f.id} value={f.name}>{f.name}</option>)}\r\n                            </select>\r\n                        </div>\r\n                        {/* Corral Selector (New) */}\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Corral</label>\r\n                            <select\r\n                                className=\"w-full border rounded-lg px-3 py-2\"\r\n                                value={newAnimal.corral || ''}\r\n                                onChange={e => setNewAnimal({ ...newAnimal, corral: e.target.value })}\r\n                                disabled={!newAnimal.farm}\r\n                            >\r\n                                <option value=\"\">Sin Asignar</option>\r\n                                {(() => {\r\n                                    const f = farms.find(farm => farm.name === newAnimal.farm);\r\n                                    if (!f) return null;\r\n\r\n                                    if (f.corralNames && f.corralNames.length > 0) {\r\n                                        return f.corralNames.map((name: string, i: number) => (\r\n                                            <option key={i} value={name}>{name}</option>\r\n                                        ));\r\n                                    }\r\n                                    return Array.from({ length: f.corrals || 0 }, (_, i) => i + 1).map(n => (\r\n                                        <option key={n} value={n}>Corral {n}</option>\r\n                                    ));\r\n                                })()}\r\n                            </select>\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Raza *</label>\r\n                            <select required className=\"w-full border rounded-lg px-3 py-2\"\r\n                                value={newAnimal.breed} onChange={e => setNewAnimal({ ...newAnimal, breed: e.target.value })}>\r\n                                <option value=\"\">Selecciona Raza</option>\r\n                                <option value=\"Wagyu\">Wagyu</option>\r\n                                <option value=\"Angus\">Angus</option>\r\n                                <option value=\"Hereford\">Hereford</option>\r\n                                <option value=\"Charolais\">Charolais</option>\r\n                                <option value=\"Limousin\">Limousin</option>\r\n                                <option value=\"Brahman\">Brahman</option>\r\n                                <option value=\"Nelore\">Nelore</option>\r\n                                <option value=\"Droughtmaster\">Droughtmaster</option>\r\n                                <option value=\"Retinta\">Retinta</option>\r\n                                <option value=\"Morucha\">Morucha</option>\r\n                                <option value=\"Pirenaica\">Pirenaica</option>\r\n                                <option value=\"Betiz√∫\">Betiz√∫</option>\r\n                                <option value=\"Berrenda\">Berrenda</option>\r\n                                <option value=\"Simmental\">Simmental</option>\r\n                                <option value=\"Blonde d'Aquitaine\">Blonde d&apos;Aquitaine</option>\r\n                                <option value=\"Azul Belga\">Azul Belga</option>\r\n                                <option value=\"Cruzada\">Cruzada</option>\r\n                            </select>\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Sexo *</label>\r\n                            <select required className=\"w-full border rounded-lg px-3 py-2\"\r\n                                value={newAnimal.sex} onChange={e => setNewAnimal({ ...newAnimal, sex: e.target.value })}>\r\n                                <option value=\"\">Selecciona Sexo</option>\r\n                                <option value=\"Macho\">Macho</option>\r\n                                <option value=\"Hembra\">Hembra</option>\r\n                            </select>\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Fecha Nacimiento</label>\r\n                            <input type=\"date\" className=\"w-full border rounded-lg px-3 py-2\"\r\n                                value={newAnimal.birth} onChange={e => setNewAnimal({ ...newAnimal, birth: e.target.value })} />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Peso Actual (kg)</label>\r\n                            <input type=\"number\" step=\"0.1\" className=\"w-full border rounded-lg px-3 py-2\"\r\n                                value={newAnimal.weight} onChange={e => setNewAnimal({ ...newAnimal, weight: e.target.value })} />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Padre (Crotal) - Opcional</label>\r\n                            <input type=\"text\" className=\"w-full border rounded-lg px-3 py-2\" placeholder=\"ID del Padre\"\r\n                                value={newAnimal.father} onChange={e => setNewAnimal({ ...newAnimal, father: e.target.value })} />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Madre (Crotal) - Opcional</label>\r\n                            <input type=\"text\" className=\"w-full border rounded-lg px-3 py-2\" placeholder=\"ID de la Madre\"\r\n                                value={newAnimal.mother} onChange={e => setNewAnimal({ ...newAnimal, mother: e.target.value })} />\r\n                        </div>\r\n                        <div className=\"md:col-span-2\">\r\n                            <button type=\"submit\" className=\"bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-6 rounded-lg w-full md:w-auto\">\r\n                                Guardar Animal\r\n                            </button>\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            )}\r\n\r\n            {/* List */}\r\n            <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden\">\r\n                <table className=\"w-full text-left\">\r\n                    <thead className=\"bg-gray-50 text-gray-600 font-medium text-sm\">\r\n                        <tr>\r\n                            <th className=\"p-4 w-1/3\">Crotal</th>\r\n                            <th className=\"p-4 w-1/3\">Sexo</th>\r\n                            <th className=\"p-4 w-1/3\">Finca</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"divide-y divide-gray-100\">\r\n                        {filteredAnimals.length === 0 ? (\r\n                            <tr><td colSpan={3} className=\"p-8 text-center text-gray-500\">No hay animales que coincidan.</td></tr>\r\n                        ) : (\r\n                            filteredAnimals.map((a, i) => {\r\n                                return (\r\n                                    <tr key={i}\r\n                                        onClick={() => setSelectedAnimal(a)}\r\n                                        className=\"hover:bg-green-50 transition-colors cursor-pointer group\"\r\n                                    >\r\n                                        <td className=\"p-4\">\r\n                                            <div className=\"flex flex-col\">\r\n                                                {formatCrotal(a.id)}\r\n                                            </div>\r\n                                        </td>\r\n                                        <td className=\"p-4 text-gray-600\">{a.sex}</td>\r\n                                        <td className=\"p-4 text-gray-600\">\r\n                                            <div className=\"flex flex-col text-sm\">\r\n                                                <span>{a.farm}</span>\r\n                                                {a.corral && <span className=\"text-xs text-green-600 font-medium\">‚ûú {a.corral}</span>}\r\n                                            </div>\r\n                                        </td>\r\n                                    </tr>\r\n                                )\r\n                            })\r\n                        )}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n            {/* Detail Modal */}\r\n            {selectedAnimal && (\r\n                <div className=\"fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center p-4 backdrop-blur-sm\">\r\n                    <div className=\"bg-white rounded-2xl shadow-2xl w-full max-w-4xl overflow-hidden animate-in fade-in zoom-in-95 h-[90vh] flex flex-col\">\r\n\r\n                        {/* 1. DIET COMPOSER MODE */}\r\n                        {showDiet ? (\r\n                            <DietComposer\r\n                                animal={selectedAnimal}\r\n                                onClose={() => setShowDiet(false)}\r\n                                fatherBreed={(() => {\r\n                                    if (!selectedAnimal.father) return undefined;\r\n                                    const parent = animals.find(a => a.id === selectedAnimal.father);\r\n                                    return BreedManager.getBreedByName(parent ? parent.breed : selectedAnimal.father);\r\n                                })()}\r\n                                motherBreed={(() => {\r\n                                    if (!selectedAnimal.mother) return undefined;\r\n                                    const parent = animals.find(a => a.id === selectedAnimal.mother);\r\n                                    return BreedManager.getBreedByName(parent ? parent.breed : selectedAnimal.mother);\r\n                                })()}\r\n                            />\r\n                        ) : (\r\n                            /* 2. STANDARD DETAIL MODE */\r\n                            <div className=\"flex flex-col h-full\">\r\n                                {/* Header */}\r\n                                <div className=\"bg-green-700 px-6 py-5 flex justify-between items-start text-white relative overflow-hidden flex-shrink-0\">\r\n                                    <div className=\"absolute top-0 right-0 opacity-10 transform translate-x-1/4 -translate-y-1/4\">\r\n                                        <svg width=\"200\" height=\"200\" viewBox=\"0 0 200 200\" fill=\"currentColor\">\r\n                                            <path d=\"M100 0L200 200H0L100 0Z\" />\r\n                                        </svg>\r\n                                    </div>\r\n\r\n                                    <div className=\"relative z-10\">\r\n                                        <div className=\"scale-125 origin-top-left mb-1\">\r\n                                            {formatCrotal(selectedAnimal.id, true)}\r\n                                        </div>\r\n                                        <div className=\"flex items-center gap-2 mt-2 opacity-90 text-sm font-medium\">\r\n                                            <span className=\"bg-white/20 px-2 py-0.5 rounded backdrop-blur-sm\">\r\n                                                {selectedAnimal.breed}\r\n                                            </span>\r\n                                            <span>‚Ä¢</span>\r\n                                            <span>{selectedAnimal.sex}</span>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"flex gap-2 z-10 items-center\">\r\n                                        <button\r\n                                            onClick={() => setShowDiet(true)}\r\n                                            className=\"bg-yellow-400 hover:bg-yellow-300 text-yellow-900 px-4 py-2 rounded-lg font-bold text-sm shadow-lg transform hover:scale-105 transition-all flex items-center gap-2\"\r\n                                            title=\"Simular Dieta Cient√≠fica\"\r\n                                        >\r\n                                            üß™ Crear Dieta\r\n                                        </button>\r\n                                        <button onClick={() => window.print()} className=\"bg-white/20 hover:bg-white/30 text-white p-2 rounded-lg backdrop-blur-sm transition-colors\" title=\"Imprimir Ficha\">\r\n                                            üñ®Ô∏è\r\n                                        </button>\r\n                                        <button onClick={() => { setSelectedAnimal(null); setShowDiet(false); }} className=\"text-white hover:text-green-200 text-3xl leading-none\">&times;</button>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Body */}\r\n                                <div className=\"p-6 space-y-6 overflow-y-auto flex-1\">\r\n                                    {/* Stats */}\r\n                                    <div className=\"grid grid-cols-2 gap-4\">\r\n                                        <div className=\"bg-green-50 p-4 rounded-xl border border-green-100\">\r\n                                            <p className=\"text-green-600 text-xs font-bold uppercase tracking-wider mb-1\">Peso Actual</p>\r\n                                            <div className=\"flex items-baseline gap-1\">\r\n                                                <span className=\"text-3xl font-black text-gray-900\">{selectedAnimal.currentWeight || selectedAnimal.weight}</span>\r\n                                                <span className=\"text-base font-medium text-gray-500\">kg</span>\r\n                                            </div>\r\n                                            <p className=\"text-xs text-green-700 mt-1 flex items-center gap-1\">\r\n                                                <span>‚öñÔ∏è</span> √öltimo pesaje verificado\r\n                                            </p>\r\n                                        </div>\r\n                                        <div className=\"bg-blue-50 p-4 rounded-xl border border-blue-100\">\r\n                                            <p className=\"text-blue-600 text-xs font-bold uppercase tracking-wider mb-1\">Edad Exacta</p>\r\n                                            <p className=\"font-bold text-gray-900 text-lg leading-tight\">\r\n                                                {calculateAgeDetailed(selectedAnimal.birth || selectedAnimal.birthDate)}\r\n                                            </p>\r\n                                            <p className=\"text-xs text-blue-700 mt-2\">\r\n                                                Nacimiento: {selectedAnimal.birth || 'Desconocido'}\r\n                                            </p>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Strategy */}\r\n                                    <div className=\"bg-gray-50 rounded-xl border border-gray-100 p-4\">\r\n                                        <h4 className=\"font-bold text-gray-800 text-sm mb-3 flex items-center gap-2\">\r\n                                            <span>üåæ</span> Estrategia Nutricional\r\n                                        </h4>\r\n                                        {(() => {\r\n                                            const diet = getDietStatus(selectedAnimal);\r\n                                            return (\r\n                                                <div className=\"flex items-center justify-between\">\r\n                                                    <div>\r\n                                                        <p className=\"text-xs text-gray-500 mb-1\">Programa Actual</p>\r\n                                                        <span className={`px - 3 py - 1 rounded - full text - sm font - bold border ${diet.color} `}>\r\n                                                            {diet.label}\r\n                                                        </span>\r\n                                                    </div>\r\n                                                </div>\r\n                                            );\r\n                                        })()}\r\n                                    </div>\r\n\r\n                                    {/* Location & Genealogy */}\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 text-sm border-t pt-4\">\r\n                                        <div>\r\n                                            <p className=\"text-gray-500 text-xs uppercase font-bold tracking-wider mb-1\">Ubicaci√≥n Actual</p>\r\n                                            <p className=\"font-medium text-gray-900 text-base mb-2\">{selectedAnimal.farm}</p>\r\n                                            {selectedAnimal.corral && (\r\n                                                <span className=\"text-green-700 font-bold text-xs bg-white px-2 py-1 rounded border border-green-200 shadow-sm inline-block\">\r\n                                                    üìç Corral {selectedAnimal.corral}\r\n                                                </span>\r\n                                            )}\r\n                                        </div>\r\n                                        <div>\r\n                                            <p className=\"text-gray-500 text-xs uppercase font-bold tracking-wider mb-1\">Genealog√≠a</p>\r\n                                            <div className=\"space-y-1\">\r\n                                                <div className=\"flex items-center gap-2\">\r\n                                                    <span className=\"text-xs font-bold text-blue-600\">P:</span>\r\n                                                    <span>{selectedAnimal.father || 'N/A'}</span>\r\n                                                </div>\r\n                                                <div className=\"flex items-center gap-2\">\r\n                                                    <span className=\"text-xs font-bold text-pink-600\">M:</span>\r\n                                                    <span>{selectedAnimal.mother || 'N/A'}</span>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Historical Table */}\r\n                                    <div className=\"mt-6 border-t pt-4\">\r\n                                        <h4 className=\"font-bold text-gray-800 text-sm mb-3\">Historial de Eventos</h4>\r\n                                        <div className=\"border rounded-lg overflow-hidden text-sm\">\r\n                                            <table className=\"w-full text-left\">\r\n                                                <thead className=\"bg-gray-50 text-gray-600 text-xs uppercase\">\r\n                                                    <tr>\r\n                                                        <th className=\"px-3 py-2\">Fecha</th>\r\n                                                        <th className=\"px-3 py-2\">Evento</th>\r\n                                                        <th className=\"px-3 py-2\">Detalle</th>\r\n                                                    </tr>\r\n                                                </thead>\r\n                                                <tbody className=\"divide-y divide-gray-100\">\r\n                                                    {events\r\n                                                        .filter(e => e.animalId === selectedAnimal.id || e.animalCrotal === selectedAnimal.id)\r\n                                                        .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime())\r\n                                                        .map((evt, idx) => (\r\n                                                            <tr key={idx} className=\"hover:bg-gray-50\">\r\n                                                                <td className=\"px-3 py-2 font-mono text-xs text-gray-500\">{evt.date}</td>\r\n                                                                <td className=\"px-3 py-2 font-medium text-gray-800\">{evt.type}</td>\r\n                                                                <td className=\"px-3 py-2 text-gray-600\">{evt.desc}</td>\r\n                                                            </tr>\r\n                                                        ))}\r\n                                                </tbody>\r\n                                            </table>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Footer */}\r\n                                <div className=\"bg-gray-50 px-6 py-4 flex justify-between items-center border-t border-gray-100 flex-shrink-0\">\r\n                                    <span className=\"text-xs text-gray-400 font-mono\">ID: {selectedAnimal.id}</span>\r\n                                    <button onClick={() => { setSelectedAnimal(null); setShowDiet(false); }} className=\"px-4 py-2 bg-white border border-gray-200 text-gray-700 font-medium rounded-lg hover:bg-gray-50 text-sm shadow-sm transition-colors\">\r\n                                        Cerrar Ficha\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n","'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useStorage } from '@/context/StorageContext';\r\nimport { useAnimalCalculator } from '@/hooks/useAnimalCalculator';\r\n\r\nimport { FEED_DATABASE, FeedItem } from '../services/feedDatabase';\r\nimport { NutritionEngine } from '../services/nutritionEngine';\r\nimport { LifecycleEngine, ReproductiveState } from '../services/lifecycleEngine';\r\nimport { BreedManager, Breed } from '../services/breedManager';\r\nimport { PriceEngine } from '../services/priceEngine';\r\n\r\n\r\nexport function Calculator() {\r\n    const { read } = useStorage();\r\n    const { calculate, results, loading, error } = useAnimalCalculator();\r\n\r\n    const [animals, setAnimals] = useState<any[]>([]);\r\n    const [selectedAnimalId, setSelectedAnimalId] = useState('');\r\n    const [selectedAnimal, setSelectedAnimal] = useState<any>(null);\r\n    const [objective, setObjective] = useState('Mantenimiento');\r\n    const [baseSystem, setBaseSystem] = useState('Extensivo (Pastoreo)');\r\n    const [isMontanera, setIsMontanera] = useState(false);\r\n    const [isEco, setIsEco] = useState(false);\r\n    const [events, setEvents] = useState<any[]>([]);\r\n\r\n    // Derived System String for Engine Compatibility\r\n    const effectiveSystem = `${baseSystem}${isMontanera ? ' + Montanera' : ''}${isEco ? ' + Ecol√≥gico' : ''}`;\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [isDropdownOpen, setIsDropdownOpen] = useState(false);\r\n\r\n    // Helper from AnimalInventory for consistent look\r\n    const formatCrotal = (crotal: string) => {\r\n        if (!crotal) return null;\r\n        const len = crotal.length;\r\n        if (len < 4) return <span className=\"font-bold text-gray-900\">{crotal}</span>;\r\n        const prefix = crotal.substring(0, len - 4);\r\n        const suffix = crotal.substring(len - 4);\r\n        return (\r\n            <span className=\"font-mono tracking-tight\">\r\n                <span className=\"text-gray-400 font-normal text-xs align-middle mr-0.5\">{prefix}</span>\r\n                <span className=\"font-black text-lg text-gray-900 align-middle\">{suffix}</span>\r\n            </span>\r\n        );\r\n    };\r\n\r\n    // Interactive Diet State\r\n    const [diet, setDiet] = useState<{ item: FeedItem; amount: number }[]>([]);\r\n    const [availableFeeds] = useState(FEED_DATABASE);\r\n\r\n    useEffect(() => {\r\n        const user = read<string>('sessionUser', '');\r\n        if (user) {\r\n            setAnimals(read<any[]>(`animals_${user}`, []));\r\n            setEvents(read<any[]>('events', []));\r\n        }\r\n    }, [read]);\r\n\r\n    // Diet Handlers\r\n    const addToDiet = (feedId: string) => {\r\n        const feed = availableFeeds.find(f => f.id === feedId);\r\n        if (feed && !diet.find(d => d.item.id === feedId)) {\r\n            setDiet([...diet, { item: feed, amount: 1 }]); // Default 1kg\r\n        }\r\n    };\r\n\r\n    const removeFromDiet = (feedId: string) => {\r\n        setDiet(diet.filter(d => d.item.id !== feedId));\r\n    };\r\n\r\n    const updateAmount = (feedId: string, amount: number) => {\r\n        setDiet(diet.map(d => d.item.id === feedId ? { ...d, amount } : d));\r\n    };\r\n\r\n    const handleSmartDiet = () => {\r\n        if (!selectedAnimal || !targets) return;\r\n        const weight = parseFloat(selectedAnimal.weight) || 400;\r\n\r\n        // Call Engine\r\n        const generated = NutritionEngine.generateSmartDiet(\r\n            targets,\r\n            { weight },\r\n            effectiveSystem,\r\n            availableFeeds\r\n        );\r\n\r\n        // Map to UI State (Convert DM to Fresh)\r\n        const uiDiet = generated.map(g => {\r\n            const feed = availableFeeds.find(f => f.id === g.feed_id);\r\n            if (!feed) return null;\r\n            const dmPct = feed.dm_percent || 100;\r\n            const freshAmount = g.dm_kg / (dmPct / 100);\r\n            return { item: feed, amount: parseFloat(freshAmount.toFixed(1)) };\r\n        }).filter(Boolean) as { item: FeedItem; amount: number }[];\r\n\r\n        setDiet(uiDiet);\r\n    };\r\n\r\n    // Auto-calculate effect\r\n    useEffect(() => {\r\n        if (selectedAnimal) {\r\n            calculate({\r\n                animal: selectedAnimal,\r\n                objective,\r\n                system: effectiveSystem,\r\n                feeds: diet.map(d => ({\r\n                    ...d.item,\r\n                    amount: d.amount\r\n                })),\r\n                events: events.filter(e => e.animalId === selectedAnimal.id || e.animalCrotal === selectedAnimal.id)\r\n            });\r\n        }\r\n    }, [diet, selectedAnimal, objective, effectiveSystem, events]);\r\n\r\n    // Helper: Calculate Age in Months\r\n    const calculateAgeInMonths = (birthDateStr: string) => {\r\n        if (!birthDateStr) return 0;\r\n        const birth = new Date(birthDateStr);\r\n        const now = new Date();\r\n        return (now.getFullYear() - birth.getFullYear()) * 12 + (now.getMonth() - birth.getMonth());\r\n    };\r\n\r\n    // Helper: Robust Breed Detection (Duplicated from Hook for UI Sync)\r\n    const getEffectiveBreed = (animal: any) => {\r\n        if (!animal) return null;\r\n\r\n        // 1. Try direct ID/Code lookup\r\n        let breed = BreedManager.getBreedById(animal.breed);\r\n\r\n        // 2. Try parent lookup for F1\r\n        if (!breed) {\r\n            const fatherId = animal.genotype?.fatherBreedId || animal.fatherBreedId;\r\n            const motherId = animal.genotype?.motherBreedId || animal.motherBreedId;\r\n            if (fatherId && motherId) {\r\n                breed = BreedManager.calculateHybrid(fatherId, motherId) || undefined;\r\n            }\r\n        }\r\n\r\n        // 3. Robust Name Search\r\n        if (!breed) {\r\n            const rawBreed = animal.breed || '';\r\n            const normalizedBreed = rawBreed.toLowerCase().normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\");\r\n            const all = BreedManager.getAllBreeds();\r\n            breed = all.find(b =>\r\n                normalizedBreed.includes(b.name.toLowerCase().normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\")) ||\r\n                normalizedBreed.includes(b.code.toLowerCase())\r\n            );\r\n        }\r\n\r\n        return breed || undefined;\r\n    };\r\n\r\n    const [targets, setTargets] = useState<any>(null);\r\n\r\n    // Update Targets when parameters change\r\n    useEffect(() => {\r\n        if (selectedAnimal) {\r\n            const effectiveBreed = getEffectiveBreed(selectedAnimal);\r\n\r\n            const t = NutritionEngine.calculateKPITargets(\r\n                {\r\n                    breed: selectedAnimal.breed || 'Unknown',\r\n                    sex: selectedAnimal.sex || 'Macho',\r\n                    weight: parseFloat(selectedAnimal.currentWeight || selectedAnimal.weight || 400),\r\n                    ageMonths: calculateAgeInMonths(selectedAnimal.birth || selectedAnimal.birthDate),\r\n                    biological_type: effectiveBreed?.biological_type // Pass Bio Type!\r\n                },\r\n                objective,\r\n                effectiveSystem\r\n            );\r\n            setTargets(t);\r\n        }\r\n    }, [selectedAnimal, objective, effectiveSystem]);\r\n\r\n    const filteredAnimals = Array.from(new Map(animals.filter(a => a.crotal || a.id).map(a => [a.crotal || a.id, a])).values())\r\n        .filter(a => {\r\n            const search = searchTerm.toLowerCase();\r\n            return (a.crotal || '').toLowerCase().includes(search) ||\r\n                (a.id || '').toLowerCase().includes(search);\r\n        })\r\n        .sort((a: any, b: any) => (a.crotal || a.id || '').localeCompare(b.crotal || b.id || ''));\r\n\r\n    return (\r\n        <div className=\"h-full bg-gray-50 p-6 overflow-y-auto\">\r\n            <div className=\"max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n                {/* Control Panel */}\r\n                <div className=\"space-y-6\">\r\n                    {/* Animal Selection */}\r\n                    <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100\">\r\n                        <h3 className=\"text-lg font-bold text-gray-800 mb-4\">\r\n                            Seleccionar Animal\r\n                        </h3>\r\n                        <div className=\"space-y-4\">\r\n                            <div className=\"relative\">\r\n                                <label className=\"block text-xs font-bold text-gray-500 uppercase mb-1\">Crotal del Animal</label>\r\n                                <div className=\"relative\">\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        placeholder=\"Buscar Crotal (ej. 8196)\"\r\n                                        className=\"w-full border rounded-lg px-3 py-2 text-sm text-gray-700 focus:ring-2 focus:ring-green-500 outline-none\"\r\n                                        value={searchTerm}\r\n                                        onFocus={() => {\r\n                                            setIsDropdownOpen(true);\r\n                                        }}\r\n                                        onChange={(e) => {\r\n                                            setSearchTerm(e.target.value);\r\n                                            setIsDropdownOpen(true);\r\n                                        }}\r\n                                        onBlur={() => setTimeout(() => setIsDropdownOpen(false), 200)}\r\n                                    />\r\n                                    <div className=\"absolute right-3 top-2.5 pointer-events-none text-gray-400 text-xs\">‚ñº</div>\r\n                                </div>\r\n\r\n                                {isDropdownOpen && filteredAnimals.length > 0 && (\r\n                                    <div className=\"absolute z-50 w-full mt-1 bg-white border rounded-lg shadow-xl max-h-64 overflow-y-auto\">\r\n                                        {filteredAnimals.map((a) => (\r\n                                            <div\r\n                                                key={a.id}\r\n                                                className=\"px-4 py-3 hover:bg-green-50 cursor-pointer border-b last:border-0 flex justify-between items-center\"\r\n                                                onMouseDown={() => {\r\n                                                    // Weight Sync on Selection\r\n                                                    let syncWeight = parseFloat(a.currentWeight || a.weight || 0);\r\n\r\n                                                    // Trace 'Pesaje' events for this specific animal if needed\r\n                                                    const animalEvents = events.filter(e =>\r\n                                                        (e.animalId === a.id || e.animalCrotal === a.crotal) && e.type === 'Pesaje'\r\n                                                    ).sort((e1, e2) => new Date(e2.date).getTime() - new Date(e1.date).getTime());\r\n\r\n                                                    if (animalEvents.length > 0) {\r\n                                                        const latestEventWeight = parseFloat(animalEvents[0].weight);\r\n                                                        if (latestEventWeight > 0) {\r\n                                                            syncWeight = latestEventWeight;\r\n                                                        }\r\n                                                    }\r\n\r\n                                                    const syncedAnimal = { ...a, currentWeight: syncWeight, weight: syncWeight };\r\n                                                    setSelectedAnimal(syncedAnimal);\r\n                                                    setSearchTerm(a.crotal || a.id);\r\n                                                    setIsDropdownOpen(false);\r\n                                                }}\r\n                                            >\r\n                                                <div className=\"flex flex-col\">\r\n                                                    <span className=\"font-bold text-gray-800\">{a.crotal ? formatCrotal(a.crotal) : a.id}</span>\r\n                                                    <span className=\"text-[10px] text-gray-400 font-bold uppercase\">{a.breed} ‚Ä¢ {a.sex}</span>\r\n                                                </div>\r\n                                                <span className=\"bg-gray-100 px-2 py-0.5 rounded text-[10px] font-bold text-gray-500 uppercase\">{a.farm}</span>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n\r\n                            {selectedAnimal && (\r\n                                <div className=\"grid grid-cols-2 gap-4 text-sm bg-gray-50 p-3 rounded-lg border border-gray-100\">\r\n                                    <div><p className=\"text-gray-500\">Raza</p><p className=\"font-bold text-gray-800\">{selectedAnimal.breed}</p></div>\r\n                                    <div><p className=\"text-gray-500\">Peso</p><p className=\"font-bold text-gray-800\">{selectedAnimal.currentWeight || selectedAnimal.weight} kg</p></div>\r\n                                </div>\r\n                            )}\r\n\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Configuration */}\r\n                    <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100\">\r\n                        <h3 className=\"text-lg font-bold text-gray-800 mb-4\">\r\n                            Objetivos\r\n                        </h3>\r\n                        <div className=\"space-y-4\">\r\n                            <div>\r\n                                <label className=\"block text-xs font-bold text-gray-500 uppercase mb-1\">Objetivo</label>\r\n                                <select\r\n                                    className=\"w-full border rounded-lg px-3 py-2\"\r\n                                    value={objective}\r\n                                    onChange={(e) => setObjective(e.target.value)}\r\n                                >\r\n                                    <option value=\"Mantenimiento\">Mantenimiento</option>\r\n                                    <option value=\"Recr√≠a (Crecimiento Moderado)\">Recr√≠a (Crecimiento Moderado)</option>\r\n                                    <option value=\"Cebo (M√°ximo Crecimiento)\">Cebo (M√°ximo Crecimiento)</option>\r\n                                    <option value=\"Engorde\">Engorde (Acabado)</option>\r\n                                    <option value=\"Eficiencia Econ√≥mica\">Eficiencia Econ√≥mica (Min Coste)</option>\r\n                                </select>\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"block text-xs font-bold text-gray-500 uppercase mb-1\">Sistema Base</label>\r\n                                <select\r\n                                    className=\"w-full border rounded-lg px-3 py-2 mb-3\"\r\n                                    value={baseSystem}\r\n                                    onChange={(e) => setBaseSystem(e.target.value)}\r\n                                >\r\n                                    <option value=\"Extensivo (Pastoreo)\">Extensivo (Pastoreo)</option>\r\n                                    <option value=\"Semi-Intensivo\">Semi-Intensivo</option>\r\n                                    <option value=\"Cebo (Feedlot)\">Cebo (Feedlot)</option>\r\n                                </select>\r\n\r\n                                <div className=\"space-y-2\">\r\n                                    <label className=\"block text-xs font-bold text-gray-500 uppercase\">Modificadores</label>\r\n                                    <div className=\"flex flex-col gap-2\">\r\n                                        <label className=\"flex items-center gap-2 cursor-pointer p-2 rounded-lg hover:bg-gray-50 border border-transparent hover:border-gray-200 transition-colors\">\r\n                                            <input\r\n                                                type=\"checkbox\"\r\n                                                checked={isMontanera}\r\n                                                onChange={(e) => setIsMontanera(e.target.checked)}\r\n                                                className=\"w-4 h-4 text-green-600 rounded focus:ring-green-500\"\r\n                                            />\r\n                                            <span className=\"text-sm text-gray-700\">Montanera (Bellota)</span>\r\n                                        </label>\r\n                                        <label className=\"flex items-center gap-2 cursor-pointer p-2 rounded-lg hover:bg-gray-50 border border-transparent hover:border-gray-200 transition-colors\">\r\n                                            <input\r\n                                                type=\"checkbox\"\r\n                                                checked={isEco}\r\n                                                onChange={(e) => setIsEco(e.target.checked)}\r\n                                                className=\"w-4 h-4 text-green-600 rounded focus:ring-green-500\"\r\n                                            />\r\n                                            <span className=\"text-sm text-gray-700\">Ecol√≥gico</span>\r\n                                        </label>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Results Panel */}\r\n                <div className=\"lg:col-span-2 space-y-6\">\r\n                    {results ? (\r\n                        <>\r\n                            {/* KPIs */}\r\n                            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                                <div className={`p-4 rounded-xl shadow-sm border ${results.projectedGain >= (targets?.adg || 0) ? 'bg-green-50 border-green-200' : 'bg-white border-gray-100'}`}>\r\n                                    <p className=\"text-gray-500 text-xs uppercase font-bold\">GMD Estimada</p>\r\n                                    <p className={`text-3xl font-bold ${results.projectedGain >= (targets?.adg || 0) ? 'text-green-700' : 'text-gray-900'} mt-1`}>\r\n                                        {(results.projectedGain || 0).toFixed(2)} <span className=\"text-sm text-gray-400\">kg/d</span>\r\n                                    </p>\r\n                                    <div className=\"mt-2 text-xs font-medium\">\r\n                                        <span className=\"text-gray-500\">Meta: {targets?.adg}</span>\r\n                                        <span className={`block mt-1 ${results.projectedGain >= (targets?.adg || 0) ? 'text-green-600' : 'text-gray-900'}`}>\r\n                                            {results.projectedGain >= (targets?.adg || 0) ? 'Objetivo Cumplido' : 'Bajo Rendimiento'}\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-white p-4 rounded-xl shadow-sm border border-gray-100\">\r\n                                    <p className=\"text-gray-500 text-xs uppercase font-bold\">Ingesta (MS)</p>\r\n                                    <p className=\"text-3xl font-bold text-gray-900 mt-1\">{(results.dmiTarget || 0).toFixed(1)} <span className=\"text-sm text-gray-400\">kg</span></p>\r\n                                    <p className=\"text-xs text-gray-400 mt-2\">Capacidad M√°x. (Est.)</p>\r\n                                </div>\r\n                                <div className={`p-4 rounded-xl shadow-sm border ${Number(results.fcr) <= (targets?.fcr || 10) ? 'bg-green-50 border-green-200' : 'bg-white border-gray-100'}`}>\r\n                                    <p className=\"text-gray-500 text-xs uppercase font-bold\">Eficiencia (FCR)</p>\r\n                                    <p className={`text-3xl font-bold ${Number(results.fcr) <= (targets?.fcr || 10) ? 'text-green-700' : 'text-gray-900'} mt-1`}>\r\n                                        {Number(results.fcr || 0).toFixed(2)}\r\n                                    </p>\r\n                                    <div className=\"mt-2 text-xs font-medium\">\r\n                                        <span className=\"text-gray-500\">Meta: &lt;{targets?.fcr}</span>\r\n                                        <span className={`block mt-1 ${Number(results.fcr) <= (targets?.fcr || 10) ? 'text-green-600' : 'text-gray-900'}`}>\r\n                                            {Number(results.fcr) <= (targets?.fcr || 10) ? 'Excelente Conversi√≥n' : 'Mejorable'}\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"bg-white p-4 rounded-xl shadow-sm border border-gray-100\">\r\n                                    <p className=\"text-gray-500 text-xs uppercase font-bold\">Coste Diario</p>\r\n                                    <p className=\"text-3xl font-bold text-gray-900 mt-1\">{Number(results.totalCost || 0).toFixed(2)} <span className=\"text-sm text-gray-400\">‚Ç¨</span></p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Diet Builder */}\r\n                            <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100\">\r\n                                <div className=\"flex justify-between items-center mb-4\">\r\n                                    <div className=\"flex items-center gap-3\">\r\n                                        <h3 className=\"text-lg font-bold text-gray-800\">Constructor de Dieta</h3>\r\n                                        <button\r\n                                            onClick={handleSmartDiet}\r\n                                            className=\"text-xs bg-green-600 text-white px-3 py-1 rounded-full hover:bg-green-700 shadow-sm transition-colors font-bold flex items-center gap-1\"\r\n                                        >\r\n                                            Generar Dieta\r\n                                        </button>\r\n                                    </div>\r\n                                    <div className=\"flex gap-2\">\r\n                                        <select\r\n                                            className=\"border rounded-lg px-2 py-1 text-sm max-w-xs\"\r\n                                            onChange={(e) => {\r\n                                                if (e.target.value) {\r\n                                                    addToDiet(e.target.value);\r\n                                                    e.target.value = '';\r\n                                                }\r\n                                            }}\r\n                                        >\r\n                                            <option value=\"\">+ A√±adir Alimento</option>\r\n                                            <optgroup label=\"Forrajes\">\r\n                                                {availableFeeds.filter(f => f.category === 'Forraje').map(f => <option key={f.id} value={f.id}>{f.name}</option>)}\r\n                                            </optgroup>\r\n                                            <optgroup label=\"Concentrados\">\r\n                                                {availableFeeds.filter(f => f.category === 'Concentrado').map(f => <option key={f.id} value={f.id}>{f.name}</option>)}\r\n                                            </optgroup>\r\n                                            <optgroup label=\"Suplementos\">\r\n                                                {availableFeeds.filter(f => f.category === 'Suplemento').map(f => <option key={f.id} value={f.id}>{f.name}</option>)}\r\n                                            </optgroup>\r\n                                            <optgroup label=\"Ecol√≥gicos\">\r\n                                                {availableFeeds.filter(f => f.category === 'Ecol√≥gico').map(f => <option key={f.id} value={f.id}>{f.name}</option>)}\r\n                                            </optgroup>\r\n                                        </select>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"overflow-x-auto\">\r\n                                    <table className=\"w-full text-left text-sm\">\r\n                                        <thead className=\"bg-gray-50 text-gray-600\">\r\n                                            <tr>\r\n                                                <th className=\"p-3\">Ingrediente</th>\r\n                                                <th className=\"p-3 w-32\">Kg (Fresco)</th>\r\n                                                <th className=\"p-3 w-24\">Kg (MS)</th>\r\n                                                <th className=\"p-3 text-right\">Costo</th>\r\n                                                <th className=\"p-3 w-10\"></th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody className=\"divide-y divide-gray-100\">\r\n                                            {diet.length === 0 ? (\r\n                                                <tr><td colSpan={5} className=\"p-4 text-center text-gray-400 italic\">No hay ingredientes.</td></tr>\r\n                                            ) : (\r\n                                                diet.map((item, idx) => (\r\n                                                    <tr key={idx} className=\"group hover:bg-gray-50\">\r\n                                                        <td className=\"p-3 font-medium flex items-center gap-2\">\r\n                                                            <span className={`w-2 h-2 rounded-full ${item.item.category === 'Forraje' ? 'bg-green-500' : 'bg-yellow-500'}`}></span>\r\n                                                            <div>\r\n                                                                <p>{item.item.name}</p>\r\n                                                                <p className=\"text-xs text-gray-400\">{item.item.energy_mcal} Mcal/kg ‚Ä¢ {item.item.protein_percent}% PB</p>\r\n                                                            </div>\r\n                                                        </td>\r\n                                                        <td className=\"p-3\">\r\n                                                            <input\r\n                                                                type=\"number\"\r\n                                                                min=\"0\" step=\"0.5\"\r\n                                                                className=\"w-full border rounded px-2 py-1 text-center font-bold focus:ring-1 focus:ring-green-500 outline-none\"\r\n                                                                value={item.amount}\r\n                                                                onChange={(e) => updateAmount(item.item.id, parseFloat(e.target.value) || 0)}\r\n                                                            />\r\n                                                        </td>\r\n                                                        <td className=\"p-3 text-gray-500\">{(item.amount * (item.item.dm_percent / 100)).toFixed(2)}</td>\r\n                                                        <td className=\"p-3 text-right text-gray-600\">{(item.amount * item.item.cost_per_kg).toFixed(2)} ‚Ç¨</td>\r\n                                                        <td className=\"p-3 text-right\">\r\n                                                            <button onClick={() => removeFromDiet(item.item.id)} className=\"text-gray-400 hover:text-red-500 transition-colors\">‚úï</button>\r\n                                                        </td>\r\n                                                    </tr>\r\n                                                ))\r\n                                            )}\r\n                                        </tbody>\r\n                                        <tfoot className=\"border-t font-bold bg-green-50\">\r\n                                            <tr>\r\n                                                <td className=\"p-3 text-green-800\">TOTAL</td>\r\n                                                <td className=\"p-3 text-green-800\">{(results.totalKg || 0).toFixed(2)} kg</td>\r\n                                                <td className=\"p-3 text-green-800\">{(results.dmiActual || 0).toFixed(2)} kg</td>\r\n                                                <td className=\"p-3 text-right text-green-800\">{(results.totalCost || 0).toFixed(2)} ‚Ç¨</td>\r\n                                                <td></td>\r\n                                            </tr>\r\n                                        </tfoot>\r\n                                    </table>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Analysis & Financials - Stacked vertically */}\r\n                            <div className=\"flex flex-col gap-6\">\r\n                                {/* Nutritional Balance */}\r\n                                <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100\">\r\n                                    <h3 className=\"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2\">Balance Nutricional</h3>\r\n                                    <div className=\"space-y-4\">\r\n                                        <div>\r\n                                            <div className=\"flex justify-between text-sm mb-1\">\r\n                                                <span className=\"text-gray-600\">Energ√≠a (Mcal)</span>\r\n                                                <span className=\"font-bold\">{(results.energyTarget || 0).toFixed(1)} / Requerido</span>\r\n                                            </div>\r\n                                            <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n                                                <div className=\"bg-green-600 h-2 rounded-full\" style={{ width: '85%' }}></div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div>\r\n                                            <div className=\"flex justify-between text-sm mb-1\">\r\n                                                <span className=\"text-gray-600\">Prote√≠na (%)</span>\r\n                                                <span className=\"font-bold\">{(results.proteinPercent || 0).toFixed(1)}%</span>\r\n                                            </div>\r\n                                            <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n                                                <div className=\"bg-green-600 h-2 rounded-full\" style={{ width: `${Math.min(results.proteinPercent * 5, 100)}%` }}></div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"mt-4 bg-gray-50 p-3 rounded-lg border border-gray-200\">\r\n                                            <p className=\"text-xs font-bold text-gray-500 uppercase mb-1\">Factor Limitante</p>\r\n                                            <p className=\"text-red-600 font-bold\">{results.carcass?.limitingFactor || 'Energ√≠a'}</p>\r\n                                        </div>\r\n\r\n                                        {/* Risk Alerts */}\r\n                                        {results.alerts && results.alerts.length > 0 && (\r\n                                            <div className=\"space-y-2 mt-4\">\r\n                                                {results.alerts.map((alert: any, idx: number) => {\r\n                                                    const translations: Record<string, string> = {\r\n                                                        'ACIDOSIS': 'RIESGO ACIDOSIS',\r\n                                                        'LOW_FIBER': 'FIBRA BAJA',\r\n                                                        'BLOAT': 'METEORISMO',\r\n                                                        'BELLOTA_FIBER': 'FIBRA (MONTANERA)',\r\n                                                        'BELLOTA_PROTEIN': 'PROTE√çNA (MONTANERA)',\r\n                                                        'BELLOTA_TOXICITY': 'TANINOS (BELLOTA)',\r\n                                                        'LOW_N_EFF': 'D√âFICIT PROTEICO',\r\n                                                        'HIGH_POLLUTION': 'EXCESO NITR√ìGENO'\r\n                                                    };\r\n                                                    return (\r\n                                                        <div key={idx} className={`p-4 rounded-2xl text-xs transition-all hover:shadow-md ${alert.level === 'critical' ? 'bg-red-50 text-red-700' : 'bg-orange-50 text-orange-800'}`}>\r\n                                                            <p className=\"font-black uppercase mb-1 tracking-widest\">{translations[alert.code] || alert.code.replace('_', ' ')}</p>\r\n                                                            <p className=\"font-medium opacity-90\">{alert.message}</p>\r\n                                                            {alert.action && (\r\n                                                                <div className=\"mt-2 pt-2 border-t border-current border-opacity-10 flex items-start gap-1.5\">\r\n                                                                    <span className=\"text-[10px]\">üí°</span>\r\n                                                                    <p className=\"text-[10px] italic font-bold leading-tight\">{alert.action}</p>\r\n                                                                </div>\r\n                                                            )}\r\n                                                        </div>\r\n                                                    );\r\n                                                })}\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Financial & Quality */}\r\n                                <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col gap-4\">\r\n                                    <h3 className=\"text-lg font-bold text-gray-800 flex items-center gap-2\">Finanzas y Calidad</h3>\r\n\r\n                                    <div className=\"mt-4\">\r\n                                        <div className=\"flex flex-col gap-5\">\r\n                                            <div className=\"bg-white border border-gray-100 rounded-[2.5rem] shadow-sm px-4 py-8\">\r\n                                                <div className=\"grid grid-cols-4 gap-0 text-center items-end\">\r\n                                                    <div className=\"border-r border-gray-100 h-10 flex flex-col justify-center px-1\">\r\n                                                        <p className=\"text-gray-400 text-[7px] font-black uppercase tracking-[0.2em] mb-1\">Clasificaci√≥n</p>\r\n                                                        <span className=\"text-4xl font-black text-gray-900 leading-none tracking-tighter\">{results.carcass?.conformation_est || 'R'}</span>\r\n                                                    </div>\r\n                                                    <div className=\"border-r border-gray-100 h-10 flex flex-col justify-center px-1\">\r\n                                                        <p className=\"text-gray-400 text-[7px] font-black uppercase tracking-[0.2em] mb-1\">Infiltraci√≥n</p>\r\n                                                        <span className=\"text-4xl font-black text-gray-900 leading-none tracking-tighter\">{Math.round(results.carcass?.marbling_est || 1)}</span>\r\n                                                    </div>\r\n                                                    <div className=\"border-r border-gray-100 h-10 flex flex-col justify-center px-1\">\r\n                                                        <p className=\"text-gray-400 text-[7px] font-black uppercase tracking-[0.2em] mb-1\">Kg Canal (Est.)</p>\r\n                                                        <div className=\"flex items-baseline justify-center gap-0.5\">\r\n                                                            <span className=\"text-3xl font-black text-gray-900 leading-none tracking-tighter\">\r\n                                                                {results.carcass?.weight_est?.toFixed(0) || results.carcass?.rc_percent\r\n                                                                    ? ((parseFloat(selectedAnimal.currentWeight || selectedAnimal.weight) + results.projectedGain * 30) * (results.carcass.rc_percent / 100)).toFixed(0)\r\n                                                                    : '0'}\r\n                                                            </span>\r\n                                                            <span className=\"text-xs font-black text-gray-400 uppercase\">kg</span>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div className=\"h-10 flex flex-col justify-center px-1\">\r\n                                                        <p className=\"text-gray-400 text-[7px] font-black uppercase tracking-[0.2em] mb-1\">Rendimiento</p>\r\n                                                        <div className=\"flex items-baseline justify-center gap-0.5\">\r\n                                                            <span className=\"text-3xl font-black text-gray-900 leading-none tracking-tighter\">{results.carcass?.rc_percent || 0}</span>\r\n                                                            <span className=\"text-xs font-black text-gray-400 uppercase\">%</span>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"bg-gray-50/50 p-6 rounded-[2rem] border border-gray-100\">\r\n                                                <div className=\"flex items-center gap-2 mb-4\">\r\n                                                    <div className=\"w-1.5 h-1.5 bg-green-500 rounded-full\"></div>\r\n                                                    <p className=\"text-gray-500 text-[9px] font-black uppercase tracking-widest\">Previsi√≥n ROI 30 D√≠as</p>\r\n                                                </div>\r\n\r\n                                                <div className=\"space-y-4\">\r\n                                                    <div className=\"flex justify-between items-center group\">\r\n                                                        <span className=\"text-gray-500 text-xs font-bold transition-colors group-hover:text-gray-900\">Venta Estimada ({results.financials?.category})</span>\r\n                                                        <div className=\"flex flex-col items-end\">\r\n                                                            <span className=\"font-black text-gray-900 text-base\">{results.financials?.projectedSales?.toLocaleString()} ‚Ç¨</span>\r\n                                                            <span className=\"text-[9px] text-green-600 font-bold uppercase tracking-tighter\">+ Ganancia Bruta</span>\r\n                                                        </div>\r\n                                                    </div>\r\n\r\n                                                    <div className=\"flex justify-between items-center group\">\r\n                                                        <span className=\"text-gray-500 text-xs font-bold transition-colors group-hover:text-gray-900\">Costes Acumulados</span>\r\n                                                        <div className=\"flex flex-col items-end\">\r\n                                                            <span className=\"font-black text-gray-900 text-base\">-{results.financials?.totalCost?.toFixed(0)} ‚Ç¨</span>\r\n                                                            <span className=\"text-[9px] text-red-600 font-bold uppercase tracking-tighter\">- Gastos Totales</span>\r\n                                                        </div>\r\n                                                    </div>\r\n\r\n                                                    <div className=\"pt-4 border-t border-gray-200\">\r\n                                                        <div className=\"bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex justify-between items-center\">\r\n                                                            <div>\r\n                                                                <p className=\"text-gray-400 text-[8px] font-black uppercase tracking-widest leading-none\">Margen Neto Proyectado</p>\r\n                                                                <p className=\"text-[9px] text-gray-400 font-medium mt-1\">* Resultados netos a 30 d√≠as</p>\r\n                                                            </div>\r\n                                                            <div className=\"text-right\">\r\n                                                                <span className={`text-3xl font-black tracking-tighter ${results.financials?.margin > 0 ? 'text-green-600' : 'text-red-500'}`}>\r\n                                                                    {results.financials?.margin?.toFixed(0)} <span className=\"text-base font-black ml-px\">‚Ç¨</span>\r\n                                                                </span>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </>\r\n                    ) : (\r\n                        <div className=\"flex flex-col items-center justify-center h-full bg-white rounded-xl border-dashed border-2 border-gray-200 p-12 text-gray-400\">\r\n                            <span className=\"text-6xl mb-4\">üß¨</span>\r\n                            <p className=\"text-lg font-medium text-gray-500\">Simulador de Rendimiento</p>\r\n                            <p className=\"text-center text-sm max-w-xs mt-2\">Selecciona un animal para ver su potencial.</p>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useStorage } from '@/context/StorageContext';\r\nimport { EventManager } from '@/services/eventManager';\r\nimport { LifecycleEngine } from '@/services/lifecycleEngine';\r\n\r\nconst EVENT_TYPES = {\r\n    'Sanitario': ['Saneamiento', 'Tratamiento', 'Vacunaci√≥n', 'Desparasitaci√≥n', 'Consulta Vet'],\r\n    'Reproductivo': ['Celo', 'Inseminaci√≥n', 'Diagn√≥stico Gestaci√≥n', 'Parto', 'Aborto', 'Secado'],\r\n    'Productivo': ['Pesaje', 'Condici√≥n Corporal', 'Orde√±o (Pendiente)'],\r\n    'Movimientos': ['Cambio de Corral', 'Entrada', 'Salida', 'Venta', 'Muerte/Sacrificio']\r\n};\r\n\r\nexport function EventsList() {\r\n    const { read, write } = useStorage();\r\n    const [events, setEvents] = useState<any[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    const [showModal, setShowModal] = useState(false);\r\n    const [newEvent, setNewEvent] = useState({\r\n        category: 'Sanitario',\r\n        type: 'Saneamiento',\r\n        date: new Date().toISOString().split('T')[0],\r\n        formattedDate: new Date().toISOString().split('T')[0], // For input\r\n        notes: '',\r\n        cost: '',\r\n        relatedType: 'none', // none, farm, animal\r\n        relatedId: '',\r\n        corral: '',\r\n        // Commercial Data\r\n        price: '',\r\n        weightLive: '',\r\n        weightCarcass: '',\r\n        yield: '',\r\n        seuropConf: '',\r\n        fatCover: ''\r\n    });\r\n\r\n    // Data for selectors\r\n    const [farms, setFarms] = useState<any[]>([]);\r\n    const [animals, setAnimals] = useState<any[]>([]);\r\n    const [sessionUser, setSessionUser] = useState('');\r\n\r\n    const [alerts, setAlerts] = useState<any[]>([]);\r\n\r\n    useEffect(() => {\r\n        const user = read<string>('sessionUser', '');\r\n        setSessionUser(user);\r\n        if (user) {\r\n            const allEvents = read<any[]>('events', []);\r\n            const allFarms = read<any[]>(`fincas_${user}`, []);\r\n            const allAnimals = read<any[]>(`animals_${user}`, []);\r\n\r\n            setFarms(allFarms);\r\n            setAnimals(allAnimals);\r\n\r\n            // Generate Lifecycle Alerts\r\n            const newAlerts: any[] = [];\r\n            allAnimals.forEach(animal => {\r\n                const animalAlerts = LifecycleEngine.getLifecycleAlerts({\r\n                    ...animal,\r\n                    birthDate: animal.birth // Ensure property mapping\r\n                } as any);\r\n                if (animalAlerts.length > 0) {\r\n                    newAlerts.push(...animalAlerts.map(a => ({ ...a, crotal: animal.crotal, farm: animal.farm })));\r\n                }\r\n            });\r\n            setAlerts(newAlerts);\r\n\r\n            // Sort by date desc\r\n            const sorted = [...allEvents].sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());\r\n            setEvents(sorted);\r\n            setLoading(false);\r\n        }\r\n    }, [read]);\r\n\r\n    const handleCreateEvent = async () => {\r\n        if (!newEvent.notes && !newEvent.type) {\r\n            alert(\"A√±ade al menos una nota o tipo\");\r\n            return;\r\n        }\r\n\r\n        const context = {\r\n            animals: read<any[]>(`animals_${sessionUser}`, []),\r\n            events: read<any[]>('events', []),\r\n            currentUser: sessionUser,\r\n            storage: { read, write }\r\n        };\r\n\r\n        const finalType = newEvent.type || EVENT_TYPES[newEvent.category as keyof typeof EVENT_TYPES][0];\r\n\r\n        const eventData = {\r\n            type: finalType,\r\n            date: newEvent.formattedDate,\r\n            desc: (newEvent.corral ? `[Corral ${newEvent.corral}] ` : '') + newEvent.notes,\r\n            cost: Number(newEvent.cost),\r\n            animal: newEvent.relatedType === 'animal'\r\n                ? context.animals.find(a => a.id === newEvent.relatedId)\r\n                : { id: newEvent.relatedType === 'farm' ? newEvent.relatedId : 'GENERAL', crotal: newEvent.relatedType === 'farm' ? 'FINCA' : 'GENERAL' },\r\n            typeData: {\r\n                price: newEvent.price,\r\n                liveWeight: newEvent.weightLive,\r\n                carcassWeight: newEvent.weightCarcass,\r\n                yield: newEvent.yield,\r\n                seuropConf: newEvent.seuropConf,\r\n                fatCover: newEvent.fatCover\r\n            }\r\n        };\r\n\r\n        // Adaptation for EventManager which expects an 'animal' object usually\r\n        // If it's a farm event, we might need to adjust logic or just pass a dummy animal object with farmId\r\n        if (newEvent.relatedType === 'farm') {\r\n            // For generic/farm events, we can use handleStandardEvent but need to ensure it doesn't break\r\n            // if animal is not a real animal. EventManager.handleStandardEvent uses animal.id/crotal.\r\n            const farmName = farms.find(f => f.id === newEvent.relatedId)?.name || 'Finca';\r\n            eventData.animal = { id: newEvent.relatedId, crotal: farmName, farmId: newEvent.relatedId };\r\n        }\r\n\r\n        await EventManager.handleStandardEvent(eventData, context);\r\n\r\n        // Refresh locally\r\n        const updatedEvents = read<any[]>('events', []);\r\n        const sorted = [...updatedEvents].sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());\r\n        setEvents(sorted);\r\n        setShowModal(false);\r\n\r\n        // Reset form\r\n        setNewEvent({\r\n            category: 'Sanitario',\r\n            type: 'Saneamiento',\r\n            date: new Date().toISOString().split('T')[0],\r\n            formattedDate: new Date().toISOString().split('T')[0],\r\n            notes: '',\r\n            cost: '',\r\n            relatedType: 'none',\r\n            relatedId: '',\r\n            corral: '',\r\n            price: '',\r\n            weightLive: '',\r\n            weightCarcass: '',\r\n            yield: '',\r\n            seuropConf: '',\r\n            fatCover: ''\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {alerts.length > 0 && (\r\n                <div className=\"bg-orange-50 border border-orange-100 rounded-xl p-4 animate-in slide-in-from-top-2\">\r\n                    <h3 className=\"text-orange-800 font-bold flex items-center gap-2 text-sm mb-3\">\r\n                        <span className=\"text-xl\">üîî</span> Alertas del Ciclo de Vida\r\n                    </h3>\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n                        {alerts.map((alert, i) => (\r\n                            <div key={i} className=\"bg-white p-3 rounded-lg border border-orange-100 shadow-sm flex justify-between items-center text-sm\">\r\n                                <div>\r\n                                    <span className=\"font-bold text-gray-800\">{alert.desc}</span>\r\n                                    <p className=\"text-xs text-gray-500\">Animal: {alert.crotal} ({alert.farm})</p>\r\n                                </div>\r\n                                <div className=\"text-right\">\r\n                                    <span className={`text-xs font-bold px-2 py-1 rounded ${alert.isDue ? 'bg-red-100 text-red-700' : 'bg-gray-100 text-gray-600'}`}>\r\n                                        {alert.date}\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"flex justify-between items-center\">\r\n\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-gray-800\">Eventos</h2>\r\n                    <p className=\"text-gray-600\">Registro hist√≥rico de acciones y sucesos</p>\r\n                </div>\r\n                <button\r\n                    onClick={() => setShowModal(true)}\r\n                    className=\"bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg transition-colors flex items-center gap-2\"\r\n                >\r\n                    <span>+</span> Nuevo Evento\r\n                </button>\r\n            </div>\r\n\r\n            {/* Modal */}\r\n            {showModal && (\r\n                <div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4\">\r\n                    <div className=\"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden animate-in fade-in zoom-in-95 duration-200\">\r\n                        <div className=\"bg-green-50 px-6 py-4 border-b border-green-100 flex justify-between items-center\">\r\n                            <h3 className=\"font-bold text-green-900\">Registrar Evento</h3>\r\n                            <button onClick={() => setShowModal(false)} className=\"text-gray-400 hover:text-gray-600\">‚úï</button>\r\n                        </div>\r\n\r\n                        <div className=\"p-6 space-y-4\">\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                <div>\r\n                                    <label className=\"block text-xs font-bold text-gray-500 uppercase mb-1\">Fecha</label>\r\n                                    <input\r\n                                        type=\"date\"\r\n                                        value={newEvent.formattedDate}\r\n                                        onChange={e => setNewEvent({ ...newEvent, formattedDate: e.target.value })}\r\n                                        className=\"w-full border rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-green-500 outline-none\"\r\n                                    />\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"block text-xs font-bold text-gray-500 uppercase mb-1\">Categor√≠a</label>\r\n                                    <select\r\n                                        value={newEvent.category}\r\n                                        onChange={e => {\r\n                                            const cat = e.target.value as keyof typeof EVENT_TYPES;\r\n                                            setNewEvent({ ...newEvent, category: cat, type: EVENT_TYPES[cat][0] });\r\n                                        }}\r\n                                        className=\"w-full border rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-green-500 outline-none font-bold text-gray-700\"\r\n                                    >\r\n                                        {Object.keys(EVENT_TYPES).map(cat => (\r\n                                            <option key={cat} value={cat}>{cat}</option>\r\n                                        ))}\r\n                                    </select>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-xs font-bold text-gray-500 uppercase mb-1\">Evento Espec√≠fico</label>\r\n                                <select\r\n                                    value={newEvent.type}\r\n                                    onChange={e => setNewEvent({ ...newEvent, type: e.target.value })}\r\n                                    className=\"w-full border rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-green-500 outline-none bg-gray-50\"\r\n                                >\r\n                                    {EVENT_TYPES[newEvent.category as keyof typeof EVENT_TYPES].map(type => (\r\n                                        <option key={type} value={type}>{type}</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-xs font-bold text-gray-500 uppercase mb-1\">Vinculaci√≥n (Opcional)</label>\r\n                                <div className=\"flex gap-2 mb-2\">\r\n                                    <button\r\n                                        onClick={() => setNewEvent({ ...newEvent, relatedType: 'none', relatedId: '', corral: '' })}\r\n                                        className={`flex-1 py-1 text-xs rounded border ${newEvent.relatedType === 'none' ? 'bg-gray-800 text-white border-gray-800' : 'bg-white text-gray-600 border-gray-200'}`}\r\n                                    >General</button>\r\n                                    <button\r\n                                        onClick={() => setNewEvent({ ...newEvent, relatedType: 'farm', relatedId: '', corral: '' })}\r\n                                        className={`flex-1 py-1 text-xs rounded border ${newEvent.relatedType === 'farm' ? 'bg-green-600 text-white border-green-600' : 'bg-white text-gray-600 border-gray-200'}`}\r\n                                    >Finca</button>\r\n                                    <button\r\n                                        onClick={() => setNewEvent({ ...newEvent, relatedType: 'animal', relatedId: '', corral: '' })}\r\n                                        className={`flex-1 py-1 text-xs rounded border ${newEvent.relatedType === 'animal' ? 'bg-orange-500 text-white border-orange-500' : 'bg-white text-gray-600 border-gray-200'}`}\r\n                                    >Animal</button>\r\n                                </div>\r\n\r\n                                {newEvent.relatedType === 'farm' && (\r\n                                    <div className=\"flex gap-2\">\r\n                                        <select\r\n                                            value={newEvent.relatedId}\r\n                                            onChange={e => setNewEvent({ ...newEvent, relatedId: e.target.value, corral: '' })}\r\n                                            className=\"w-full border rounded-lg px-3 py-2 text-sm flex-1\"\r\n                                        >\r\n                                            <option value=\"\">Selecciona Finca...</option>\r\n                                            {farms.map(f => <option key={f.id} value={f.id}>{f.name}</option>)}\r\n                                        </select>\r\n                                        {newEvent.relatedId && (\r\n                                            <select\r\n                                                value={newEvent.corral}\r\n                                                onChange={e => setNewEvent({ ...newEvent, corral: e.target.value })}\r\n                                                className=\"w-32 border rounded-lg px-3 py-2 text-sm\"\r\n                                            >\r\n                                                <option value=\"\">Corral...</option>\r\n                                                {Array.from({ length: farms.find(f => f.id === newEvent.relatedId)?.corrals || 0 }, (_, i) => i + 1).map(n => (\r\n                                                    <option key={n} value={n}>Corral {n}</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        )}\r\n                                    </div>\r\n                                )}\r\n\r\n                                {newEvent.relatedType === 'animal' && (\r\n                                    <select\r\n                                        value={newEvent.relatedId}\r\n                                        onChange={e => setNewEvent({ ...newEvent, relatedId: e.target.value })}\r\n                                        className=\"w-full border rounded-lg px-3 py-2 text-sm\"\r\n                                    >\r\n                                        <option value=\"\">Selecciona Animal...</option>\r\n                                        {animals.map(a => <option key={a.id} value={a.id}>{a.crotal} ({a.breed || '?'})</option>)}\r\n                                    </select>\r\n                                )}\r\n                            </div>\r\n\r\n                            {/* Commercial / Slaughter Data Fields */}\r\n                            {['Venta', 'Salida', 'Muerte/Sacrificio'].includes(newEvent.type) && (\r\n                                <div className=\"bg-red-50 border border-red-100 rounded-lg p-3 space-y-3\">\r\n                                    <h4 className=\"font-bold text-red-800 text-xs uppercase flex items-center gap-2\">\r\n                                        ü•© Datos Comerciales / Canal\r\n                                    </h4>\r\n                                    <div className=\"grid grid-cols-2 gap-3\">\r\n                                        <div>\r\n                                            <label className=\"block text-xs font-bold text-gray-500 uppercase mb-1\">Importe Venta (‚Ç¨)</label>\r\n                                            <input type=\"number\" step=\"0.01\" className=\"w-full border rounded px-2 py-1 text-sm field-focus\"\r\n                                                value={newEvent.price} onChange={e => setNewEvent({ ...newEvent, price: e.target.value })}\r\n                                            />\r\n                                        </div>\r\n                                        <div>\r\n                                            <label className=\"block text-xs font-bold text-gray-500 uppercase mb-1\">Peso Vivo (kg)</label>\r\n                                            <input type=\"number\" step=\"0.1\" className=\"w-full border rounded px-2 py-1 text-sm field-focus\"\r\n                                                value={newEvent.weightLive} onChange={e => setNewEvent({ ...newEvent, weightLive: e.target.value })}\r\n                                            />\r\n                                        </div>\r\n                                        <div>\r\n                                            <label className=\"block text-xs font-bold text-gray-500 uppercase mb-1\">Peso Canal (kg)</label>\r\n                                            <input type=\"number\" step=\"0.1\" className=\"w-full border rounded px-2 py-1 text-sm field-focus\"\r\n                                                value={newEvent.weightCarcass} onChange={e => {\r\n                                                    const wc = Number(e.target.value);\r\n                                                    const wl = Number(newEvent.weightLive);\r\n                                                    const y = wl > 0 ? ((wc / wl) * 100).toFixed(1) : '';\r\n                                                    setNewEvent({ ...newEvent, weightCarcass: e.target.value, yield: y });\r\n                                                }}\r\n                                            />\r\n                                        </div>\r\n                                        <div>\r\n                                            <label className=\"block text-xs font-bold text-gray-500 uppercase mb-1\">Rendimiento (%)</label>\r\n                                            <input type=\"number\" step=\"0.1\" className=\"w-full border rounded px-2 py-1 text-sm field-focus bg-gray-100\"\r\n                                                value={newEvent.yield} readOnly\r\n                                            />\r\n                                        </div>\r\n                                        <div>\r\n                                            <label className=\"block text-xs font-bold text-gray-500 uppercase mb-1\">Conf. (SEUROP)</label>\r\n                                            <select className=\"w-full border rounded px-2 py-1 text-sm field-focus\"\r\n                                                value={newEvent.seuropConf} onChange={e => setNewEvent({ ...newEvent, seuropConf: e.target.value })}\r\n                                            >\r\n                                                <option value=\"\">-</option>\r\n                                                {['S', 'E', 'U', 'R', 'O', 'P'].map(o => <option key={o} value={o}>{o}</option>)}\r\n                                            </select>\r\n                                        </div>\r\n                                        <div>\r\n                                            <label className=\"block text-xs font-bold text-gray-500 uppercase mb-1\">Grasa (1-5)</label>\r\n                                            <select className=\"w-full border rounded px-2 py-1 text-sm field-focus\"\r\n                                                value={newEvent.fatCover} onChange={e => setNewEvent({ ...newEvent, fatCover: e.target.value })}\r\n                                            >\r\n                                                <option value=\"\">-</option>\r\n                                                {['1', '2', '3', '4', '5'].map(o => <option key={o} value={o}>{o}</option>)}\r\n                                            </select>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n\r\n                            <div>\r\n                                <label className=\"block text-xs font-bold text-gray-500 uppercase mb-1\">Descripci√≥n / Notas</label>\r\n                                <textarea\r\n                                    value={newEvent.notes}\r\n                                    onChange={e => setNewEvent({ ...newEvent, notes: e.target.value })}\r\n                                    className=\"w-full border rounded-lg px-3 py-2 text-sm h-24 resize-none focus:ring-2 focus:ring-green-500 outline-none\"\r\n                                    placeholder=\"Detalles del evento...\"\r\n                                ></textarea>\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-xs font-bold text-gray-500 uppercase mb-1\">Coste (‚Ç¨) - Opcional</label>\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={newEvent.cost}\r\n                                    onChange={e => setNewEvent({ ...newEvent, cost: e.target.value })}\r\n                                    className=\"w-full border rounded-lg px-3 py-2 text-sm\"\r\n                                    placeholder=\"0.00\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"bg-gray-50 px-6 py-4 flex justify-end gap-3 border-t\">\r\n                            <button onClick={() => setShowModal(false)} className=\"text-gray-600 font-medium text-sm hover:text-gray-800\">Cancelar</button>\r\n                            <button onClick={handleCreateEvent} className=\"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-lg text-sm shadow-sm transition-transform active:scale-95\">\r\n                                Crear Evento\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden\">\r\n                <table className=\"w-full text-left\">\r\n                    <thead className=\"bg-gray-50 text-gray-600 font-medium text-sm\">\r\n                        <tr>\r\n                            <th className=\"p-4\">Fecha</th>\r\n                            <th className=\"p-4\">Tipo</th>\r\n                            <th className=\"p-4\">Animal / Finca</th>\r\n                            <th className=\"p-4\">Notas</th>\r\n                            <th className=\"p-4 text-right\">Costo</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"divide-y divide-gray-100\">\r\n                        {loading ? (\r\n                            <tr><td colSpan={5} className=\"p-8 text-center text-gray-500\">Cargando eventos...</td></tr>\r\n                        ) : events.length === 0 ? (\r\n                            <tr><td colSpan={5} className=\"p-8 text-center text-gray-500\">No hay eventos recientes.</td></tr>\r\n                        ) : (\r\n                            events.map((e, i) => (\r\n                                <tr key={i} className=\"hover:bg-gray-50 transition-colors\">\r\n                                    <td className=\"p-4 text-gray-900 font-medium\">{new Date(e.date).toLocaleDateString()}</td>\r\n                                    <td className=\"p-4 text-gray-600\">\r\n                                        <span className={`inline-block px-2 py-1 rounded text-xs font-bold\r\n                                            ${e.type === 'Sanitario' ? 'bg-red-50 text-red-700' :\r\n                                                e.type === 'Alimentaci√≥n' ? 'bg-yellow-50 text-yellow-700' :\r\n                                                    e.type === 'Mantenimiento' ? 'bg-blue-50 text-blue-700' :\r\n                                                        'bg-green-50 text-green-700'}`}>\r\n                                            {e.type}\r\n                                        </span>\r\n                                    </td>\r\n                                    <td className=\"p-4 text-gray-600 text-sm\">\r\n                                        {e.animalCrotal ? (\r\n                                            <span className=\"font-mono bg-gray-100 px-1 rounded\">{e.animalCrotal}</span>\r\n                                        ) : '-'}\r\n                                    </td>\r\n                                    <td className=\"p-4 text-gray-600 text-sm max-w-xs truncate\">{e.desc || e.notes || '-'}</td>\r\n                                    <td className=\"p-4 text-gray-600 text-right font-medium\">\r\n                                        {e.cost > 0 ? Number(e.cost).toLocaleString('es-ES', { style: 'currency', currency: 'EUR' }) : '-'}\r\n                                    </td>\r\n                                </tr>\r\n                            ))\r\n                        )}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","'use client';\r\n\r\nimport React from 'react';\r\nimport { useStorage } from '@/context/StorageContext';\r\nimport { NutritionEngine } from '@/services/nutritionEngine';\r\nimport { BreedManager } from '@/services/breedManager';\r\n\r\nexport function ReportsManager() {\r\n    const { read } = useStorage();\r\n\r\n    const handleFCRReport = async () => {\r\n        try {\r\n            // No init required for BreedManager\r\n            const user = read<string>('sessionUser', '');\r\n            const animals = read<any[]>(`animals_${user}`, []);\r\n\r\n            if (!animals || animals.length === 0) {\r\n                alert('No hay animales registrados para generar el reporte.');\r\n                return;\r\n            }\r\n\r\n            // CSV Header\r\n            let csvContent = \"ID;Raza;Sexo;Peso (kg);Edad (meses);GMD Estimada (kg/d);Ingesta Objetivo (kg MS);Eficiencia (FCR);Costo Diario Est (‚Ç¨)\\n\";\r\n\r\n            // Process each animal\r\n            for (const animal of animals) {\r\n                // Determine Age\r\n                const ageMonths = (new Date().getTime() - new Date(animal.birth).getTime()) / (1000 * 60 * 60 * 24 * 30.44);\r\n\r\n                // Determine Breed\r\n                const breed = BreedManager.getBreedById(animal.breed) || BreedManager.getBreedByName(animal.breed) || BreedManager.getAllBreeds()[0];\r\n\r\n                // Calculate Targets (New API)\r\n                // Assuming 'Cebo' state for FCR report\r\n                const sexValue = (animal.sex === 'Macho' || animal.sex === 'Hembra' || animal.sex === 'Castrado') ? animal.sex : 'Macho';\r\n                const dietTargets = NutritionEngine.calculateRequirements(animal.weight, 1.2, ageMonths, 'Cebo', sexValue);\r\n\r\n                // Fixed Mock Diet Stats for Estimation (similar to Calculator)\r\n                const mockDietStats = {\r\n                    totalEnergyMcal: dietTargets ? (dietTargets.em_mcal * 10) : 15, // Approx\r\n                    totalProteinG: 1200,\r\n                    dmiKg: 10 // Approx fixed DMI for report baseline\r\n                };\r\n\r\n                // Calculate Density for Prediction\r\n                const dietEnergyDensity = mockDietStats.totalEnergyMcal / mockDietStats.dmiKg;\r\n\r\n                // Calculate Performance (Predict)\r\n                const predictedADG = NutritionEngine.predictPerformance(breed, dietEnergyDensity, mockDietStats.dmiKg, animal.weight);\r\n\r\n                // Estimate Cost (Using mock diet average cost ~0.15 ‚Ç¨/kg DM equivalent for calculation)\r\n                const estimatedDailyCost = (mockDietStats.dmiKg / 0.9) * 0.15; // Rough estimate\r\n\r\n                // Calculate FCR\r\n                const fcr = predictedADG > 0 ? (mockDietStats.dmiKg / predictedADG).toFixed(2) : \"N/A\";\r\n\r\n                // Append Row\r\n                csvContent += `${animal.id};${animal.breed};${animal.sex};${animal.weight};${ageMonths.toFixed(1)};${predictedADG.toFixed(2)};${mockDietStats.dmiKg.toFixed(2)};${fcr};${estimatedDailyCost.toFixed(2)}\\n`;\r\n            }\r\n\r\n            // Create Download Link\r\n            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n            const url = URL.createObjectURL(blob);\r\n            const link = document.createElement(\"a\");\r\n            link.setAttribute(\"href\", url);\r\n            link.setAttribute(\"download\", `reporte_rendimiento_fcr_${new Date().toISOString().slice(0, 10)}.csv`);\r\n            link.style.visibility = 'hidden';\r\n            document.body.appendChild(link);\r\n            link.click();\r\n            document.body.removeChild(link);\r\n\r\n        } catch (error) {\r\n            console.error(\"Error generating report:\", error);\r\n            alert(\"Error al generar el reporte. Ver consola para detalles.\");\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <div>\r\n                <h2 className=\"text-2xl font-bold text-gray-800\">Reportes</h2>\r\n                <p className=\"text-gray-600\">Generaci√≥n de informes y estad√≠sticas</p>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100 hover:border-green-200 transition-colors cursor-pointer group\">\r\n                    <span className=\"text-3xl mb-4 block group-hover:scale-110 transition-transform\">üìä</span>\r\n                    <h3 className=\"font-bold text-lg text-gray-800 mb-2\">Informe Econ√≥mico</h3>\r\n                    <p className=\"text-gray-500 text-sm\">Resumen de gastos, ingresos estimados y valor de inventario.</p>\r\n                </div>\r\n\r\n                <div\r\n                    onClick={handleFCRReport}\r\n                    className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100 hover:border-green-200 transition-colors cursor-pointer group\"\r\n                >\r\n                    <span className=\"text-3xl mb-4 block group-hover:scale-110 transition-transform\">üìà</span>\r\n                    <h3 className=\"font-bold text-lg text-gray-800 mb-2\">Informe de Rendimiento (FCR)</h3>\r\n                    <p className=\"text-gray-500 text-sm\">Descargar CSV con evoluci√≥n de peso, GMD y eficiencia alimentaria.</p>\r\n                </div>\r\n\r\n                <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100 hover:border-green-200 transition-colors cursor-pointer group\">\r\n                    <span className=\"text-3xl mb-4 block group-hover:scale-110 transition-transform\">üß¨</span>\r\n                    <h3 className=\"font-bold text-lg text-gray-800 mb-2\">Informe Reproductivo</h3>\r\n                    <p className=\"text-gray-500 text-sm\">Tasas de fertilidad, partos y saneamiento.</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { useStorage } from '@/context/StorageContext';\r\nimport { User, Shield, Briefcase, Phone, CreditCard, Calendar, Trash2, Edit2, Search, Plus, Save, X } from 'lucide-react';\r\n\r\ninterface FullUser {\r\n    name: string;\r\n    pass: string;\r\n    role: 'admin' | 'vet' | 'worker';\r\n    joined: string;\r\n    // Extended fields\r\n    firstName?: string;\r\n    lastName?: string;\r\n    dni?: string;\r\n    phone?: string;\r\n    dob?: string;\r\n    jobTitle?: string;\r\n}\r\n\r\nexport function UsersManager() {\r\n    const { read, write } = useStorage();\r\n    const users = read<FullUser[]>('users', []);\r\n    const sessionUser = read('sessionUser', '');\r\n\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [editingUser, setEditingUser] = useState<FullUser | null>(null);\r\n    const [isCreating, setIsCreating] = useState(false);\r\n\r\n    // Form State\r\n    const [formData, setFormData] = useState<Partial<FullUser>>({\r\n        role: 'worker',\r\n        jobTitle: 'Pe√≥n Ganadero'\r\n    });\r\n\r\n    const handleSave = () => {\r\n        if (!formData.name || !formData.pass) return alert(\"Usuario y Contrase√±a son obligatorios\");\r\n\r\n        let newUsers = [...users];\r\n\r\n        if (isCreating) {\r\n            if (users.find(u => u.name === formData.name)) return alert(\"El usuario ya existe\");\r\n            newUsers.push({\r\n                ...formData as FullUser,\r\n                joined: new Date().toISOString()\r\n            });\r\n        } else if (editingUser) {\r\n            newUsers = newUsers.map(u => u.name === editingUser.name ? { ...u, ...formData } : u);\r\n        }\r\n\r\n        write('users', newUsers);\r\n        setEditingUser(null);\r\n        setIsCreating(false);\r\n        setFormData({ role: 'worker', jobTitle: 'Pe√≥n Ganadero' });\r\n    };\r\n\r\n    const startEdit = (user: FullUser) => {\r\n        setEditingUser(user);\r\n        setIsCreating(false);\r\n        setFormData({ ...user });\r\n    };\r\n\r\n    const startCreate = () => {\r\n        setEditingUser(null);\r\n        setIsCreating(true);\r\n        setFormData({ role: 'worker', jobTitle: 'Pe√≥n Ganadero', pass: '123456' });\r\n    };\r\n\r\n    const handleDelete = (name: string) => {\r\n        if (name === sessionUser) return alert(\"No puedes eliminar tu propio usuario\");\r\n        if (confirm(`¬øEliminar usuario ${name}?`)) {\r\n            write('users', users.filter(u => u.name !== name));\r\n        }\r\n    };\r\n\r\n    const filteredUsers = users.filter(u =>\r\n        u.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        u.firstName?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        u.lastName?.toLowerCase().includes(searchTerm.toLowerCase())\r\n    );\r\n\r\n    return (\r\n        <div className=\"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500\">\r\n            <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-gray-800 flex items-center gap-2\">\r\n                        <Shield className=\"w-8 h-8 text-green-600\" />\r\n                        Gesti√≥n de Equipo\r\n                    </h2>\r\n                    <p className=\"text-gray-500\">Administra los perfiles y permisos del personal</p>\r\n                </div>\r\n                <button\r\n                    onClick={startCreate}\r\n                    className=\"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium flex items-center gap-2 shadow-sm transition-all hover:shadow-md\"\r\n                >\r\n                    <Plus className=\"w-4 h-4\" />\r\n                    Nuevo Empleado\r\n                </button>\r\n            </div>\r\n\r\n            {/* Search Bar */}\r\n            <div className=\"bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex items-center gap-3\">\r\n                <Search className=\"w-5 h-5 text-gray-400\" />\r\n                <input\r\n                    type=\"text\"\r\n                    placeholder=\"Buscar por nombre, usuario o DNI...\"\r\n                    value={searchTerm}\r\n                    onChange={(e) => setSearchTerm(e.target.value)}\r\n                    className=\"flex-1 outline-none text-gray-700 placeholder-gray-400\"\r\n                />\r\n            </div>\r\n\r\n            {/* Editor Modal/Panel */}\r\n            {(isCreating || editingUser) && (\r\n                <div className=\"bg-white rounded-xl shadow-lg border border-green-100 overflow-hidden\">\r\n                    <div className=\"bg-green-50 px-6 py-4 border-b border-green-100 flex justify-between items-center\">\r\n                        <h3 className=\"font-bold text-green-800 flex items-center gap-2\">\r\n                            {isCreating ? <Plus className=\"w-5 h-5\" /> : <Edit2 className=\"w-5 h-5\" />}\r\n                            {isCreating ? 'Alta de Empleado' : `Editando: ${editingUser?.name}`}\r\n                        </h3>\r\n                        <button onClick={() => { setIsCreating(false); setEditingUser(null); }} className=\"text-gray-400 hover:text-gray-600\">\r\n                            <X className=\"w-5 h-5\" />\r\n                        </button>\r\n                    </div>\r\n\r\n                    <div className=\"p-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                        {/* Account Info */}\r\n                        <div className=\"space-y-4\">\r\n                            <h4 className=\"text-xs font-bold text-gray-400 uppercase tracking-wider border-b pb-1\">Cuenta</h4>\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Usuario (Login)</label>\r\n                                <input\r\n                                    disabled={!isCreating}\r\n                                    value={formData.name || ''}\r\n                                    onChange={e => setFormData({ ...formData, name: e.target.value })}\r\n                                    className=\"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 outline-none disabled:bg-gray-100\"\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Contrase√±a</label>\r\n                                <input\r\n                                    type=\"password\"\r\n                                    value={formData.pass || ''}\r\n                                    onChange={e => setFormData({ ...formData, pass: e.target.value })}\r\n                                    className=\"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 outline-none\"\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Rol de Acceso</label>\r\n                                <select\r\n                                    value={formData.role || 'worker'}\r\n                                    onChange={e => setFormData({ ...formData, role: e.target.value as any })}\r\n                                    className=\"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 outline-none bg-white\"\r\n                                >\r\n                                    <option value=\"worker\">Trabajador (B√°sico)</option>\r\n                                    <option value=\"vet\">Veterinario (Sanitario)</option>\r\n                                    <option value=\"admin\">Administrador (Total)</option>\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Personal Info */}\r\n                        <div className=\"space-y-4\">\r\n                            <h4 className=\"text-xs font-bold text-gray-400 uppercase tracking-wider border-b pb-1\">Datos Personales</h4>\r\n                            <div className=\"grid grid-cols-2 gap-2\">\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Nombre</label>\r\n                                    <input\r\n                                        value={formData.firstName || ''}\r\n                                        onChange={e => setFormData({ ...formData, firstName: e.target.value })}\r\n                                        className=\"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 outline-none\"\r\n                                    />\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">Apellidos</label>\r\n                                    <input\r\n                                        value={formData.lastName || ''}\r\n                                        onChange={e => setFormData({ ...formData, lastName: e.target.value })}\r\n                                        className=\"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 outline-none\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"grid grid-cols-2 gap-2\">\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">DNI / NIE</label>\r\n                                    <input\r\n                                        value={formData.dni || ''}\r\n                                        onChange={e => setFormData({ ...formData, dni: e.target.value })}\r\n                                        className=\"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 outline-none\"\r\n                                    />\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">F. Nacimiento</label>\r\n                                    <input\r\n                                        type=\"date\"\r\n                                        value={formData.dob || ''}\r\n                                        onChange={e => setFormData({ ...formData, dob: e.target.value })}\r\n                                        className=\"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 outline-none\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Job Info */}\r\n                        <div className=\"space-y-4\">\r\n                            <h4 className=\"text-xs font-bold text-gray-400 uppercase tracking-wider border-b pb-1\">Fitcha T√©cnica</h4>\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Puesto / Cargo</label>\r\n                                <input\r\n                                    value={formData.jobTitle || ''}\r\n                                    onChange={e => setFormData({ ...formData, jobTitle: e.target.value })}\r\n                                    className=\"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 outline-none\"\r\n                                    placeholder=\"Ej: Tractorista, Veterinario Jefe...\"\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Tel√©fono Contacto</label>\r\n                                <input\r\n                                    value={formData.phone || ''}\r\n                                    onChange={e => setFormData({ ...formData, phone: e.target.value })}\r\n                                    className=\"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 outline-none\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"px-6 py-4 bg-gray-50 flex justify-end gap-3 border-t border-gray-100\">\r\n                        <button\r\n                            onClick={() => { setIsCreating(false); setEditingUser(null); }}\r\n                            className=\"px-4 py-2 text-gray-600 font-medium hover:text-gray-800\"\r\n                        >\r\n                            Cancelar\r\n                        </button>\r\n                        <button\r\n                            onClick={handleSave}\r\n                            className=\"bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg font-medium flex items-center gap-2 shadow-sm transition-all\"\r\n                        >\r\n                            <Save className=\"w-4 h-4\" />\r\n                            Guardar Ficha\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Users Grid */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6\">\r\n                {filteredUsers.map((user, i) => (\r\n                    <div key={i} className=\"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow group\">\r\n                        <div className=\"p-6\">\r\n                            <div className=\"flex justify-between items-start mb-4\">\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <div className={`w-12 h-12 rounded-full flex items-center justify-center text-white font-bold text-xl shadow-sm\r\n                                        ${user.role === 'admin' ? 'bg-purple-600' : (user.role === 'vet' ? 'bg-blue-500' : 'bg-green-600')}\r\n                                    `}>\r\n                                        {user.firstName ? user.firstName.charAt(0) : user.name.charAt(0)}\r\n                                    </div>\r\n                                    <div>\r\n                                        <h3 className=\"font-bold text-gray-900\">{user.firstName} {user.lastName}</h3>\r\n                                        <p className=\"text-xs text-gray-500\">@{user.name}</p>\r\n                                    </div>\r\n                                </div>\r\n                                <span className={`px-2 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider border\r\n                                    ${user.role === 'admin' ? 'bg-purple-50 text-purple-700 border-purple-100' :\r\n                                        (user.role === 'vet' ? 'bg-blue-50 text-blue-700 border-blue-100' : 'bg-gray-50 text-gray-600 border-gray-200')}\r\n                                `}>\r\n                                    {user.role === 'admin' ? 'ADMIN' : (user.role === 'vet' ? 'VETERINARIO' : 'TRABAJADOR')}\r\n                                </span>\r\n                            </div>\r\n\r\n                            <div className=\"space-y-2 text-sm text-gray-600 mt-4\">\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <Briefcase className=\"w-4 h-4 text-gray-400\" />\r\n                                    <span>{user.jobTitle || 'Sin puesto definido'}</span>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <CreditCard className=\"w-4 h-4 text-gray-400\" />\r\n                                    <span>{user.dni || 'Sin DNI'}</span>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <Phone className=\"w-4 h-4 text-gray-400\" />\r\n                                    <span>{user.phone || 'Sin Tel√©fono'}</span>\r\n                                </div>\r\n                                {user.dob && (\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <Calendar className=\"w-4 h-4 text-gray-400\" />\r\n                                        <span>{new Date(user.dob).toLocaleDateString()} ({new Date().getFullYear() - new Date(user.dob).getFullYear()} a√±os)</span>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"px-6 py-3 bg-gray-50 border-t border-gray-100 flex justify-between items-center opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                            <button\r\n                                onClick={() => startEdit(user)}\r\n                                className=\"text-green-600 font-medium text-xs hover:underline flex items-center gap-1\"\r\n                            >\r\n                                <Edit2 className=\"w-3 h-3\" /> Editar Ficha\r\n                            </button>\r\n                            {user.name !== sessionUser && (\r\n                                <button\r\n                                    onClick={() => handleDelete(user.name)}\r\n                                    className=\"text-red-600 font-medium text-xs hover:underline flex items-center gap-1\"\r\n                                >\r\n                                    <Trash2 className=\"w-3 h-3\" /> Eliminar\r\n                                </button>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","'use client';\r\n\r\nimport React from 'react';\r\nimport { useStorage } from '@/context/StorageContext';\r\n\r\nexport function UserProfile() {\r\n    const { read, write } = useStorage();\r\n    const sessionUser = read<string>('sessionUser', 'Usuario');\r\n    const [avatar, setAvatar] = React.useState<string | null>(null);\r\n\r\n    React.useEffect(() => {\r\n        const storedAvatar = read('userAvatar', null);\r\n        if (storedAvatar) setAvatar(storedAvatar);\r\n    }, [read]);\r\n\r\n    const handleImageUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (file) {\r\n            const reader = new FileReader();\r\n            reader.onloadend = () => {\r\n                const base64String = reader.result as string;\r\n                setAvatar(base64String);\r\n                write('userAvatar', base64String);\r\n            };\r\n            reader.readAsDataURL(file);\r\n        }\r\n    };\r\n\r\n    const users = read<any[]>('users', []);\r\n    const currentUser = users.find((u: any) => u.name === sessionUser);\r\n\r\n    // God Mode Logic for Gerencia\r\n    const isGerencia = sessionUser?.toLowerCase().includes('gerencia') || sessionUser === 'gerencia@sotodelprior.com';\r\n    const isAdmin = currentUser?.role === 'admin' || isGerencia;\r\n    const displayRole = isAdmin ? 'admin' : (currentUser?.role || 'worker');\r\n\r\n    // Team Management State\r\n    const [newUserUser, setNewUserUser] = React.useState('');\r\n    const [newUserPass, setNewUserPass] = React.useState('');\r\n    const [newUserRole, setNewUserRole] = React.useState('worker');\r\n    const [showTeamForm, setShowTeamForm] = React.useState(false);\r\n\r\n    const handleCreateUser = () => {\r\n        if (!newUserUser || !newUserPass) return alert(\"Completa usuario y contrase√±a\");\r\n        if (users.find(u => u.name === newUserUser)) return alert(\"El usuario ya existe\");\r\n\r\n        const newUser = {\r\n            name: newUserUser,\r\n            email: `${newUserUser.toLowerCase()}@soto.com`, // Mock email\r\n            pass: newUserPass,\r\n            role: newUserRole,\r\n            joined: new Date().toISOString()\r\n        };\r\n\r\n        write('users', [...users, newUser]);\r\n        setNewUserUser('');\r\n        setNewUserPass('');\r\n        setShowTeamForm(false);\r\n        alert(`Usuario ${newUserUser} creado correctamente con rol ${newUserRole}`);\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <h1 className=\"text-2xl font-bold text-gray-800\">Mi Perfil</h1>\r\n\r\n            <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 p-6 md:p-8\">\r\n                <div className=\"flex flex-col md:flex-row items-center gap-6\">\r\n                    <div className=\"relative group cursor-pointer\">\r\n                        <input\r\n                            type=\"file\"\r\n                            accept=\"image/*\"\r\n                            className=\"hidden\"\r\n                            id=\"avatar-upload\"\r\n                            onChange={handleImageUpload}\r\n                        />\r\n                        <label htmlFor=\"avatar-upload\" className=\"cursor-pointer block\">\r\n                            {avatar ? (\r\n                                <img\r\n                                    src={avatar}\r\n                                    alt=\"Profile\"\r\n                                    className=\"w-24 h-24 rounded-full object-cover shadow-md group-hover:opacity-75 transition-opacity\"\r\n                                />\r\n                            ) : (\r\n                                <div className=\"w-24 h-24 bg-green-600 rounded-full flex items-center justify-center text-white font-bold text-4xl shadow-md group-hover:bg-green-700 transition-colors\">\r\n                                    {sessionUser.charAt(0).toUpperCase()}\r\n                                </div>\r\n                            )}\r\n                            <div className=\"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity bg-black/30 rounded-full text-white text-xs font-bold pointer-events-none\">\r\n                                CAMBIAR\r\n                            </div>\r\n                        </label>\r\n                    </div>\r\n\r\n                    <div className=\"text-center md:text-left space-y-2\">\r\n                        <h2 className=\"text-xl font-bold text-gray-900\">{sessionUser}</h2>\r\n                        <span className={`inline-block text-xs px-2 py-1 rounded-full font-medium ${isAdmin ? 'bg-purple-100 text-purple-800' : 'bg-gray-100 text-gray-800'}`}>\r\n                            {displayRole === 'admin' ? 'Administrador' : (displayRole === 'vet' ? 'Veterinario' : 'Trabajador')}\r\n                        </span>\r\n                        <p className=\"text-sm text-gray-500 max-w-md\">\r\n                            {isAdmin\r\n                                ? \"Cuenta administrativa con acceso completo a la gesti√≥n de fincas, inventario animal, finanzas y equipo.\"\r\n                                : \"Cuenta de usuario con permisos limitados seg√∫n su rol asignado.\"}\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"mt-8 grid grid-cols-1 md:grid-cols-2 gap-6 border-t pt-6\">\r\n                    <div>\r\n                        <label className=\"block text-xs font-semibold text-gray-500 uppercase mb-1\">Email / Usuario</label>\r\n                        <p className=\"text-gray-900 font-medium\">{sessionUser}</p>\r\n                    </div>\r\n                    <div>\r\n                        <label className=\"block text-xs font-semibold text-gray-500 uppercase mb-1\">Rol</label>\r\n                        <p className=\"text-gray-900 font-medium capitalize\">\r\n                            {displayRole === 'admin' ? 'Administrador' : (displayRole === 'vet' ? 'Veterinario' : 'Trabajador')}\r\n                        </p>\r\n                    </div>\r\n                    <div>\r\n                        <label className=\"block text-xs font-semibold text-gray-500 uppercase mb-1\">Empresa</label>\r\n                        <p className=\"text-gray-900 font-medium\">SOTO DEL PRIOR</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n\r\n\r\n            {/* Team Management now moved to dedicated module 'Equipo' */}\r\n\r\n        </div>\r\n    );\r\n}\r\n","'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { PriceEngine } from '../services/priceEngine';\r\nimport { Database, Download, Upload, AlertCircle } from 'lucide-react';\r\n\r\nexport function DataManager() {\r\n    const [lastUpdate, setLastUpdate] = useState<string>(new Date().toLocaleDateString());\r\n\r\n    const handlePriceImport = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (!file) return;\r\n\r\n        const reader = new FileReader();\r\n        reader.onload = (event) => {\r\n            const text = event.target?.result as string;\r\n            if (text) {\r\n                try {\r\n                    const count = PriceEngine.importPricesFromCSV(text);\r\n                    alert(`√âxito: Se han actualizado ${count} registros de precios SEUROP.`);\r\n                    setLastUpdate(new Date().toLocaleDateString());\r\n                } catch (err) {\r\n                    console.error('Error importing CSV:', err);\r\n                    alert('Error al procesar el archivo CSV. Verifique el formato.');\r\n                }\r\n            }\r\n        };\r\n        reader.readAsText(file);\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-6 bg-gray-50 min-h-full space-y-6\">\r\n            <div className=\"flex items-center gap-3 mb-2\">\r\n                <Database className=\"w-8 h-8 text-green-600\" />\r\n                <h1 className=\"text-2xl font-bold text-gray-800\">Gesti√≥n de Datos</h1>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                {/* SEUROP Price Management */}\r\n                <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100\">\r\n                    <div className=\"flex justify-between items-start mb-4\">\r\n                        <div>\r\n                            <h3 className=\"text-lg font-bold text-gray-800\">Precios de Referencia (SEUROP)</h3>\r\n                            <p className=\"text-sm text-gray-500 mt-1\">\r\n                                Actualice las tablas de precios oficiales para el c√°lculo de rentabilidad.\r\n                            </p>\r\n                        </div>\r\n                        <span className=\"bg-green-100 text-green-700 text-[10px] px-2 py-1 rounded-full font-bold uppercase\">\r\n                            Activo\r\n                        </span>\r\n                    </div>\r\n\r\n                    <div className=\"bg-gray-50 p-4 rounded-lg border border-gray-200 mb-6\">\r\n                        <div className=\"flex justify-between items-center text-sm\">\r\n                            <span className=\"text-gray-600\">√öltima actualizaci√≥n:</span>\r\n                            <span className=\"font-bold text-gray-800\">{lastUpdate}</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex flex-col gap-3\">\r\n                        <label className=\"w-full h-32 border-2 border-dashed border-gray-200 rounded-xl flex flex-col items-center justify-center gap-2 hover:border-green-500 hover:bg-green-50 cursor-pointer transition-all group\">\r\n                            <Upload className=\"w-8 h-8 text-gray-400 group-hover:text-green-600\" />\r\n                            <div className=\"text-center\">\r\n                                <p className=\"text-sm font-bold text-gray-700\">Actualizar Tarifas (CSV)</p>\r\n                                <p className=\"text-xs text-gray-400\">Arrastre o haga clic para subir</p>\r\n                            </div>\r\n                            <input type=\"file\" accept=\".csv\" className=\"hidden\" onChange={handlePriceImport} />\r\n                        </label>\r\n\r\n                        <div className=\"flex items-start gap-2 p-3 bg-amber-50 rounded-lg border border-amber-100 text-xs text-amber-800\">\r\n                            <AlertCircle className=\"w-4 h-4 shrink-0 mt-0.5\" />\r\n                            <p>\r\n                                <strong>Nota:</strong> El CSV debe seguir el formato est√°ndar MAPA para categor√≠as y clasificaciones SEUROP.\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Other Data Tools (Placeholders for future) */}\r\n                <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100 opacity-60\">\r\n                    <h3 className=\"text-lg font-bold text-gray-400 mb-2\">Exportaci√≥n de Datos</h3>\r\n                    <p className=\"text-sm text-gray-400 mb-6\">\r\n                        Pr√≥ximamente: Exporte su inventario y registros en formato Excel o PDF.\r\n                    </p>\r\n                    <button disabled className=\"w-full flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 text-gray-400 rounded-lg cursor-not-allowed font-bold uppercase text-xs\">\r\n                        <Download className=\"w-4 h-4\" />\r\n                        Descargar Backup\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","export const AppConfig = {\r\n    carcass: {\r\n        rc_adjust: {\r\n            w_age: 0.015,\r\n            w_energy: 0.010,\r\n            w_adg: 0.010,\r\n            w_stress: -0.010,\r\n            age_ref_start_months: 12,\r\n            age_ref_end_months: 24,\r\n            EN_min: 1.30,\r\n            EN_max: 2.20,\r\n            THI_threshold: 72,\r\n            THI_max: 84,\r\n            adg_ratio_min: 0.8,\r\n            adg_ratio_max: 1.2\r\n        },\r\n        defaults: {\r\n            rc_feedlot: 0.59,\r\n            rc_grazing: 0.56,\r\n            rc_mixed: 0.575\r\n        }\r\n    },\r\n    quality: {\r\n        weights: {\r\n            w_genetic: 0.40,\r\n            w_energy: 0.25,\r\n            w_finish: 0.15,\r\n            w_adg: 0.20,\r\n            w_stress_penalty: 0.10\r\n        },\r\n        refs: {\r\n            finish_days_ref: 90,\r\n            EN_min: 1.30,\r\n            EN_max: 2.20,\r\n            THI_threshold: 72,\r\n            THI_max: 84,\r\n            ADG_min: 0.6,\r\n            ADG_max: 1.6\r\n        },\r\n        finishing_rule: {\r\n            EN_finish_threshold: 1.85,\r\n            concentrate_share_threshold: 0.40\r\n        }\r\n    }\r\n};\r\n","\r\n// Basic UTM to LatLon conversion (WGS84) for Zone 30 (Spain)\r\n// Simplified implementation for the scope of this project\r\nfunction utmToLatLon(x: number, y: number, zone: number = 30): { lat: number, lon: number } {\r\n    const K0 = 0.9996;\r\n    const E = 0.00669438;\r\n    const E2 = Math.pow(E, 2);\r\n    const E3 = Math.pow(E, 3);\r\n    const E_P2 = E / (1.0 - E);\r\n\r\n    const SQRT_E = Math.sqrt(1 - E);\r\n    const _E = (1 - SQRT_E) / (1 + SQRT_E);\r\n    const _E2 = Math.pow(_E, 2);\r\n    const _E3 = Math.pow(_E, 3);\r\n    const _E4 = Math.pow(_E, 4);\r\n    const _E5 = Math.pow(_E, 5);\r\n\r\n    const M1 = 1 - E / 4 - 3 * E2 / 64 - 5 * E3 / 256;\r\n    const M2 = 3 * E / 8 + 3 * E2 / 32 + 45 * E3 / 1024;\r\n    const M3 = 15 * E2 / 256 + 45 * E3 / 1024;\r\n    const M4 = 35 * E3 / 3072;\r\n\r\n    const P = x - 500000;\r\n    const M = y / K0;\r\n    const MU = M / (6378137 * M1);\r\n\r\n    const PHI1 = MU + (3 * _E / 2 - 27 * _E3 / 32) * Math.sin(2 * MU) + (21 * _E2 / 16 - 55 * _E4 / 32) * Math.sin(4 * MU) + (151 * _E3 / 96) * Math.sin(6 * MU) + (1097 * _E4 / 512) * Math.sin(8 * MU);\r\n\r\n    const C1 = E_P2 * Math.pow(Math.cos(PHI1), 2);\r\n    const T1 = Math.pow(Math.tan(PHI1), 2);\r\n    const N1 = 6378137 / Math.sqrt(1 - E * Math.pow(Math.sin(PHI1), 2));\r\n    const R1 = 6378137 * (1 - E) / Math.pow(1 - E * Math.pow(Math.sin(PHI1), 2), 1.5);\r\n    const D = P / (N1 * K0);\r\n\r\n    const PHI = PHI1 - (N1 * Math.tan(PHI1) / R1) * (Math.pow(D, 2) / 2 - (5 + 3 * T1 + 10 * C1 - 4 * Math.pow(C1, 2) - 9 * E_P2) * Math.pow(D, 4) / 24 + (61 + 90 * T1 + 298 * C1 + 45 * Math.pow(T1, 2) - 252 * E_P2 - 3 * Math.pow(C1, 2)) * Math.pow(D, 6) / 720);\r\n    const LAMBDA = Math.PI / 180 * (6 * zone - 183) + (D - (1 + 2 * T1 + C1) * Math.pow(D, 3) / 6 + (5 - 2 * C1 + 28 * T1 - 3 * Math.pow(C1, 2) + 8 * E_P2 + 24 * Math.pow(T1, 2)) * Math.pow(D, 5) / 120) / Math.cos(PHI1);\r\n\r\n    return {\r\n        lat: PHI * 180 / Math.PI,\r\n        lon: LAMBDA * 180 / Math.PI\r\n    };\r\n}\r\n\r\nexport interface ParcelInfo {\r\n    provincia: number;\r\n    municipio: number;\r\n    poligono: number;\r\n    parcela: number;\r\n    recinto?: number;\r\n    area_ha: number;\r\n    use: string;\r\n    slope_avg: number;\r\n    irrigation_coef: number;\r\n    coordinates?: { lat: number, lon: number };\r\n}\r\n\r\nexport const SigpacService = {\r\n    /**\r\n     * Fetch Parcel Data from ArcGIS/SIGPAC Public Service\r\n     * Simplified URL for demonstration. In prod, this hits the specific FeatureServer.\r\n     */\r\n    async fetchParcelData(prov: number, muni: number, pol: number, parc: number): Promise<ParcelInfo | null> {\r\n        try {\r\n            // Construct Query URL for SPANISH SIGPAC (Example Endpoint)\r\n            // Real endpoint: https://sigpac-hubcloud.mapama.es/server/rest/services/SIGPAC/PARCELAS/MapServer/0/query\r\n            const baseUrl = `https://sigpac-hubcloud.mapama.es/server/rest/services/SIGPAC/PARCELAS/MapServer/0/query`;\r\n\r\n            // Where clause\r\n            const where = `PROVINCIA=${prov} AND MUNICIPIO=${muni} AND AGREGADO=0 AND ZONA=0 AND POLIGONO=${pol} AND PARCELA=${parc}`;\r\n\r\n            const params = new URLSearchParams({\r\n                where: where,\r\n                outFields: '*', // Get all fields\r\n                returnGeometry: 'true',\r\n                f: 'json'\r\n            });\r\n\r\n            const response = await fetch(`${baseUrl}?${params.toString()}`);\r\n            if (!response.ok) throw new Error('SIGPAC API Error');\r\n\r\n            const data = await response.json();\r\n            if (!data.features || data.features.length === 0) return null;\r\n\r\n            const feature = data.features[0];\r\n            const attrs = feature.attributes;\r\n            const geom = feature.geometry; // Rings or Points\r\n\r\n            // Calculate Center for LatLon\r\n            let centerLat = 0, centerLon = 0;\r\n            if (geom && geom.rings && geom.rings.length > 0) {\r\n                // Get centroid of first ring roughly\r\n                const ring = geom.rings[0];\r\n                const x = ring[0][0];\r\n                const y = ring[0][1];\r\n                // Convert UTM to WGS84\r\n                // Assuming Data returns Web Mercator or UTM 30. Usually Web Service is 3857, but SIGPAC query might return UTM.\r\n                // For this example, we assume we receive UTM or we rely on the `app-sigpac.js` logic conversion.\r\n                // The legacy code explicitly handled UTM conversion, so we use it.\r\n                if (y > 1000000) {\r\n                    const coords = utmToLatLon(x, y, 30);\r\n                    centerLat = coords.lat;\r\n                    centerLon = coords.lon;\r\n                } else {\r\n                    // Assume already LatLon (rare)\r\n                    centerLat = y;\r\n                    centerLon = x;\r\n                }\r\n            }\r\n\r\n            return {\r\n                provincia: prov,\r\n                municipio: muni,\r\n                poligono: pol,\r\n                parcela: parc,\r\n                area_ha: (attrs.SUPERFICIE || 0) / 10000, // m2 to ha\r\n                use: attrs.USO_SIGPAC || 'PR', // Default Pasture\r\n                slope_avg: attrs.PENDIENTE_MEDIA || 0,\r\n                irrigation_coef: attrs.COEF_REGADIO || 0,\r\n                coordinates: (centerLat !== 0) ? { lat: centerLat, lon: centerLon } : undefined\r\n            };\r\n\r\n        } catch (error) {\r\n            console.error('SigpacService Error:', error);\r\n            // Return null to indicate failure instead of misleading mock data\r\n            return null;\r\n        }\r\n    }\r\n};\r\n","\r\nimport { BreedManager, Breed } from './breedManager';\r\n\r\n// --- CONSTANTS ---\r\n// Diet Quality Factors (0.0 to 2.0) - Multiplier for the \"Potential Daily Gain\"\r\nconst DIET_QUALITY_MILK = 1.2;\r\nconst DIET_QUALITY_WEANING = 0.5; // Stress period\r\nconst DIET_QUALITY_FEEDLOT = 1.3; // High energy\r\nconst DIET_QUALITY_MONTANERA = 1.5; // Acorns (High Fat/Energy)\r\nconst DIET_QUALITY_SPRING = 1.1; // Good pasture\r\nconst DIET_QUALITY_SUMMER = 0.4; // Dry pasture\r\nconst DIET_QUALITY_AUTUMN = 0.9; // Regrowth\r\nconst DIET_QUALITY_WINTER = 0.6; // Cold/Scarcity\r\n\r\n// Maturation Rates (k) for Von Bertalanffy roughly adapted for daily/monthly steps\r\n// Higher = Faster maturity (Early breeds)\r\nconst K_MATURITY_EARLY = 0.0025; // Daily rate approx\r\nconst K_MATURITY_LATE = 0.0018;\r\n\r\nexport const WeightEngine = {\r\n\r\n    isBuey(animal: any, ageMonths: number): boolean {\r\n        if (animal?.category === 'Buey') return true;\r\n        if (animal?.sex === 'Castrado' && ageMonths > 12) return true;\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Preserved Logic: System Inference\r\n     * Maps farm names or animal properties to the production system.\r\n     */\r\n    inferSystem(animal: any): string {\r\n        const farm = (animal.farm || '').toLowerCase();\r\n\r\n        // 1. Feedlot / Intensive\r\n        if (farm.includes('feedlot') || farm.includes('cebo')) {\r\n            return 'Intensivo (Feedlot)';\r\n        }\r\n\r\n        // 2. Montanera (SOTO del PRIOR specifics)\r\n        // User Logic: \"SOTO del PRIOR\" implies capability for Montanera\r\n        if (animal.farm === 'SOTO del PRIOR' || farm.includes('dehesa') || farm.includes('soto')) {\r\n            return 'Montanera (Bellota)';\r\n        }\r\n\r\n        // 3. Default\r\n        return 'Extensivo (Pastoreo)';\r\n    },\r\n\r\n    /**\r\n     * Get Repro Adjustment (Fetus weight, etc.)\r\n     * Returns absolute KG adjustment to add to base weight.\r\n     */\r\n    getReproStatus(animal: any, events: any[], simulationDate: Date): number {\r\n        if (animal.sex !== 'Hembra') return 0;\r\n        if (!events || events.length === 0) return 0;\r\n\r\n        // Sort events descending\r\n        const sortedEvents = [...events].sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());\r\n\r\n        // Find events relevant relative to simulationDate\r\n        const validEvents = sortedEvents.filter(e => new Date(e.date) <= simulationDate);\r\n\r\n        const lastParto = validEvents.find(e => e.type === 'Parto');\r\n        const lastInsem = validEvents.find(e => e.type === 'Inseminaci√≥n' || e.type === 'Monta');\r\n\r\n        // GESTATION\r\n        if (lastInsem && (!lastParto || new Date(lastInsem.date) > new Date(lastParto.date))) {\r\n            const daysGest = (simulationDate.getTime() - new Date(lastInsem.date).getTime()) / (1000 * 60 * 60 * 24);\r\n            const monthsGest = daysGest / 30.44;\r\n\r\n            // Should verify if diagnosis was negative, but assuming success for simulation if no negative diagnosis\r\n            if (monthsGest > 8.5) return 50;\r\n            if (monthsGest > 7.5) return 30;\r\n            if (monthsGest > 6.0) return 15;\r\n        }\r\n\r\n        // LACTATION (Body Condition Loss)\r\n        if (lastParto) {\r\n            const daysPost = (simulationDate.getTime() - new Date(lastParto.date).getTime()) / (1000 * 60 * 60 * 24);\r\n            if (daysPost < 90) return -35;\r\n            if (daysPost < 150) return -15;\r\n        }\r\n\r\n        return 0;\r\n    },\r\n\r\n    /**\r\n     * MAIN SIMULATION LOGIC (Von Bertalanffy Model)\r\n     * dW/dt = k * (W_inf - W_current)\r\n     */\r\n    calculateRealisticWeight(animal: any, system: string, events: any[] = []): number {\r\n        if (!animal.birth && !animal.birthDate) return 0;\r\n        const birthDate = new Date(animal.birth || animal.birthDate);\r\n        const now = new Date();\r\n\r\n        // 1. DETERMINE GENETIC POTENTIAL (Asymptote W_inf)\r\n        // 1. DETERMINE GENETIC POTENTIAL (Asymptote W_inf)\r\n        let breed = BreedManager.getBreedByName(animal.breed);\r\n\r\n        // --- 1.1 ROBUST DETECTION (Copied from Inventory) ---\r\n        // Normalize: \"Betiz√∫\" -> \"betizu\"\r\n        const rawBreed = animal.breed || '';\r\n        const normalizedBreed = rawBreed.toLowerCase().normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\");\r\n\r\n        if (!breed && normalizedBreed) {\r\n            if (normalizedBreed.includes('betizu')) {\r\n                breed = {\r\n                    id: 'MANUAL_BETIZU', code: 'BET', name: 'Betizu',\r\n                    biological_type: 'Rustic_European', weight_female_adult: 320, weight_male_adult: 450,\r\n                    adg_feedlot: 0.6, slaughter_age_months: 36\r\n                } as any;\r\n            }\r\n            else if (normalizedBreed.includes('limousin') || normalizedBreed.includes('limusin')) {\r\n                breed = {\r\n                    id: 'MANUAL_LIM', code: 'LIM', name: 'Limousin',\r\n                    biological_type: 'Continental', weight_female_adult: 700, weight_male_adult: 1100,\r\n                    adg_feedlot: 1.4, slaughter_age_months: 18\r\n                } as any;\r\n            }\r\n            else if (normalizedBreed.includes('charol')) {\r\n                breed = {\r\n                    id: 'MANUAL_CHA', code: 'CHA', name: 'Charolais',\r\n                    biological_type: 'Continental', weight_female_adult: 800, weight_male_adult: 1200,\r\n                    adg_feedlot: 1.5, slaughter_age_months: 18\r\n                } as any;\r\n            }\r\n            else if (normalizedBreed.includes('avile')) {\r\n                breed = {\r\n                    id: 'MANUAL_AVI', code: 'AVI', name: 'Avile√±a',\r\n                    biological_type: 'Rustic_European', weight_female_adult: 550, weight_male_adult: 900,\r\n                    adg_feedlot: 1.1, slaughter_age_months: 24\r\n                } as any;\r\n            }\r\n            else if (normalizedBreed.includes('retinta')) {\r\n                breed = {\r\n                    id: 'MANUAL_RET', code: 'RET', name: 'Retinta',\r\n                    biological_type: 'Rustic_European', weight_female_adult: 580, weight_male_adult: 950,\r\n                    adg_feedlot: 1.1, slaughter_age_months: 24\r\n                } as any;\r\n            }\r\n            else if (normalizedBreed.includes('morucha')) {\r\n                breed = {\r\n                    id: 'MANUAL_MOR', code: 'MOR', name: 'Morucha',\r\n                    biological_type: 'Rustic_European', weight_female_adult: 550, weight_male_adult: 900,\r\n                    adg_feedlot: 1.1, slaughter_age_months: 24\r\n                } as any;\r\n            }\r\n            else if (normalizedBreed.includes('frison')) {\r\n                breed = {\r\n                    id: 'MANUAL_FRI', code: 'FRI', name: 'Frisona',\r\n                    biological_type: 'Dairy', weight_female_adult: 650, weight_male_adult: 1000,\r\n                    adg_feedlot: 1.2, slaughter_age_months: 22\r\n                } as any;\r\n            }\r\n            else if (normalizedBreed.includes('wagyu')) {\r\n                breed = {\r\n                    id: 'MANUAL_WAG', code: 'WAG', name: 'Wagyu',\r\n                    biological_type: 'British', weight_female_adult: 550, weight_male_adult: 850,\r\n                    adg_feedlot: 0.9, slaughter_age_months: 30\r\n                } as any;\r\n            }\r\n            else if (normalizedBreed.includes('mestiz') || normalizedBreed.includes('cruzad')) {\r\n                breed = {\r\n                    id: 'MANUAL_MIX', code: 'MIX', name: 'Mestiza',\r\n                    biological_type: 'Rustic_European', weight_female_adult: 580, weight_male_adult: 950,\r\n                    adg_feedlot: 1.2, slaughter_age_months: 24\r\n                } as any;\r\n            }\r\n        }\r\n\r\n        let adultWeight = 600; // Default\r\n        let maturationRate = 0.0020; // Default\r\n\r\n        if (breed) {\r\n            adultWeight = animal.sex === 'Hembra' ? breed.weight_female_adult : breed.weight_male_adult;\r\n\r\n            // Adjust Maturation Rate based on breed type / biological type\r\n            if (breed.biological_type === 'Rustic_European') {\r\n                maturationRate = 0.0018; // Slower maturity\r\n            } else if (breed.biological_type === 'Continental') {\r\n                maturationRate = 0.0022; // Fast growth but late maturity? Actually they grow fast.\r\n            } else if (breed.biological_type === 'British' || breed.slaughter_age_months < 20) {\r\n                maturationRate = 0.0025; // Early maturity (Angus)\r\n            }\r\n        }\r\n\r\n        // Adjust Asymptote for Oxen\r\n        const isEventuallyBuey = animal.category === 'Buey' || animal.sex === 'Castrado';\r\n        if (isEventuallyBuey) {\r\n            adultWeight = adultWeight * 1.25; // 25% larger frame potential\r\n            maturationRate = maturationRate * 0.85; // Grows slower/longer\r\n        }\r\n\r\n        // 2. SIMULATION LOOP\r\n        let currentWeight = 40; // Birth\r\n        if (breed) currentWeight = breed.weight_female_adult * 0.07;\r\n\r\n        let simDate = new Date(birthDate);\r\n        const maxMonths = 240;\r\n        let monthsSimulated = 0;\r\n\r\n        while (simDate < now && monthsSimulated < maxMonths) {\r\n            const ageMonths = monthsSimulated;\r\n            const monthOfYear = simDate.getMonth(); // 0-11\r\n\r\n            // A. Determine Diet Factor\r\n            let dietFactor = 1.0;\r\n\r\n            // Phase 1: Lactation (0-6m) - Diet is Milk (High Value)\r\n            if (ageMonths <= 6) {\r\n                dietFactor = DIET_QUALITY_MILK;\r\n                // Feedlot creep feeding?\r\n                if (system.includes('Feedlot')) dietFactor *= 1.1;\r\n            }\r\n            // Phase 2: Weaning (6-7m) - Stress\r\n            else if (ageMonths <= 7) {\r\n                dietFactor = DIET_QUALITY_WEANING;\r\n            }\r\n            // Phase 3: Adult/Growing\r\n            else {\r\n                if (system.includes('Feedlot')) {\r\n                    dietFactor = DIET_QUALITY_FEEDLOT;\r\n                }\r\n                else if (system.includes('Montanera')) {\r\n                    // Check Montanera Season AND Buey eligibility\r\n                    const isMontaneraSeason = [9, 10, 11, 0, 1].includes(monthOfYear); // Oct-Feb\r\n                    const canEatBellota = (isEventuallyBuey && ageMonths > 12);\r\n\r\n                    if (isMontaneraSeason && canEatBellota) dietFactor = DIET_QUALITY_MONTANERA;\r\n                    else {\r\n                        // Extensive fallback\r\n                        if ([6, 7, 8].includes(monthOfYear)) dietFactor = DIET_QUALITY_SUMMER;\r\n                        else if ([2, 3, 4, 5].includes(monthOfYear)) dietFactor = DIET_QUALITY_SPRING;\r\n                        else dietFactor = DIET_QUALITY_WINTER; // Low if not eating Bellota\r\n                    }\r\n                }\r\n                else {\r\n                    // Extensive Standard\r\n                    if ([6, 7, 8].includes(monthOfYear)) dietFactor = DIET_QUALITY_SUMMER;\r\n                    else if ([2, 3, 4, 5].includes(monthOfYear)) dietFactor = DIET_QUALITY_SPRING;\r\n                    else if ([9, 10].includes(monthOfYear)) dietFactor = DIET_QUALITY_AUTUMN;\r\n                    else dietFactor = DIET_QUALITY_WINTER;\r\n                }\r\n            }\r\n\r\n            // B. Calculate Gain using Von Bertalanffy Derivative\r\n            // Gain = k * (Limit - Current) * Diet\r\n            // If animal is above limit (e.g. became skinny?), it loses weight? \r\n            // In this model, if diet is poor (<1.0), we should dampen the gain or even lose.\r\n\r\n            // Refined Logic:\r\n            // Potential Gain = k * (Adult - Current)\r\n            // Actual Gain = Potential * DietFactor\r\n            // BUT: If DietFactor is very low (<0.5), we might lose weight (maintenance cost).\r\n            // Let's simplified: \r\n            // 1. Calculate Potential Anabolic Gain\r\n            let potentialGain = maturationRate * (adultWeight - currentWeight);\r\n\r\n            // 2. Apply Diet Modulo\r\n            // If diet is 1.0, we simulate \"normal\" growth towards asymptote.\r\n            // If diet is > 1.0 (Feedlot), we grow faster (effectively increasing k locally or overshooting).\r\n            // If diet is < 0.5 (Summer), we might plateau or drop.\r\n\r\n            let dailyGain = potentialGain * dietFactor;\r\n\r\n            // 3. Maintenance Cost Penalty?\r\n            // As weight increases, maintenance increases. The formula (A-W) handles \"slowing down\".\r\n            // But real starvation (Summer) should lose weight.\r\n            // If Diet < 0.5 (Summer), treat as negative relative to maintenance?\r\n            if (dietFactor < 0.5 && ageMonths > 6) {\r\n                // Force stagnation or slight loss\r\n                dailyGain = (dietFactor - 0.5) * 0.5; // Negative small amount\r\n            }\r\n\r\n            // Step (roughly 30 days)\r\n            const daysInMonth = 30.44;\r\n            currentWeight += dailyGain * daysInMonth;\r\n\r\n            // Advance\r\n            simDate.setMonth(simDate.getMonth() + 1);\r\n            monthsSimulated++;\r\n        }\r\n\r\n        // 3. APPLY REPRODUCTIVE ADJUSTMENTS (Instantaneous)\r\n        // These are temporary mass (fetus is expelled, fat is burned)\r\n        const reproAdj = this.getReproStatus(animal, events, now);\r\n        currentWeight += reproAdj;\r\n\r\n        // Safety Floor\r\n        if (currentWeight < 40) currentWeight = 40;\r\n\r\n        return parseFloat(currentWeight.toFixed(1));\r\n    }\r\n};\r\n","import React, { useEffect, useRef } from 'react';\r\nimport { useStorage } from '@/context/StorageContext';\r\nimport { EventManager } from '@/services/eventManager';\r\nimport { CarcassQualityEngine } from '@/services/carcassQualityEngine';\r\n\r\nexport function DataSeeder() {\r\n    const { read, write, isLoaded } = useStorage();\r\n    const seededRef = useRef(false);\r\n\r\n    useEffect(() => {\r\n        if (!isLoaded) return;\r\n        // removed seededRef check to ensure sanitation always runs on load\r\n\r\n        const user = read<string>('appSession', '') || read<string>('sessionUser', '');\r\n        if (!user) return;\r\n\r\n        const animalsKey = `animals_${user}`;\r\n        const fincasKey = `fincas_${user}`;\r\n        let animals = read<any[]>(animalsKey, []);\r\n        let events = read<any[]>('events', []);\r\n        let fincas = read<any[]>(fincasKey, []);\r\n\r\n        let changed = false;\r\n\r\n        if (fincas.length === 0) {\r\n            fincas.push({\r\n                id: 'finca-default-001',\r\n                name: 'SOTO del PRIOR',\r\n                municipio: 'Belv√≠s de la Jara',\r\n                municipioCode: '020',\r\n                provinciaCode: '45', // Toledo\r\n                poligono: '1',\r\n                parcela: '1',\r\n                superficie: 153940, // ~15.39 ha\r\n                recintos: [],\r\n                coords: { lat: 39.7589, lng: -4.7634 }, // Belv√≠s de la Jara coords\r\n                license: 'ES450200000001',\r\n                maxHeads: 90,\r\n                soilId: 'franco_arenoso',\r\n                corrals: 4,\r\n                feedingSystem: 'extensivo'\r\n            });\r\n            changed = true;\r\n        }\r\n\r\n        const targetOxenCrotals = ['ES104332181960', 'ES338908386379', 'ES026542351161'];\r\n        const targetCowsCrotals = ['ES000000000001', 'ES000000000002', 'ES000000000003', 'ES000000000004'];\r\n\r\n\r\n\r\n        const generateUUID = () => {\r\n            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n                var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n                return v.toString(16);\r\n            });\r\n        };\r\n\r\n        const addEvent = (evt: any) => {\r\n            if (!events.some(e => e.id === evt.id || (e.type === evt.type && e.date === evt.date && e.animalCrotal === evt.animalCrotal))) {\r\n                events.push(evt);\r\n                changed = true;\r\n            }\r\n        };\r\n\r\n        // --- 1. ENRICHMENT ENGINE (HISTORICAL & GENEALOGICAL SIMULATION) ---\r\n\r\n        // --- 1. ENRICHMENT ENGINE (HISTORICAL & GENEALOGICAL SIMULATION) ---\r\n\r\n        // CHECK FOR REPARATION NEEDED:\r\n        // 1. Fresh Import (animals > 0, events = 0)\r\n        // 2. Wrong Farm Name (needs 'SOTO del PRIOR')\r\n        // 3. Misclassified Bueyes (Name has 'Buey' but category is 'Toro')\r\n        // CHECK FOR REPARATION NEEDED:\r\n        // 1. Fresh Import\r\n        // 2. Wrong Farm Name\r\n        // 3. Misclassified Bueyes\r\n        // 4. WRONG SIRE BREED (Must be Limousin)\r\n        // 5. GENETICS UPDATE (Force update if we find 'Cruzada' ghosts that should be F1)\r\n        // 6. WRONG SIRE NAME (TORO_CHA -> TORO_LIM)\r\n        // CHECK FOR REPARATION NEEDED:\r\n        // 1. Fresh Import\r\n        // 2. Wrong Farm Name\r\n        // 3. Misclassified Bueyes\r\n        // 4. WRONG SIRE BREED (Must be Limousin)\r\n        // 5. GENETICS UPDATE (Force update if we find 'Cruzada' ghosts that should be F1)\r\n        // 6. WRONG SIRE NAME (TORO_CHA -> TORO_LIM)\r\n        // 7. OXEN PATERNITY (Detect if any animal has a father that is a known Ox)\r\n        const oxenSetRaw = new Set(animals.filter(a => a.category === 'Buey' || a.sex === 'Castrado' || (a.name && a.name.toLowerCase().includes('buey'))).map(a => a.id));\r\n        const hasBadData = animals.some(a =>\r\n            a.farm !== 'SOTO del PRIOR' ||\r\n            (a.name && a.name.toLowerCase().includes('buey') && a.category !== 'Buey') ||\r\n            ((a.category === 'Semental' || (a.sex === 'Macho' && a.category === 'Toro' && !a.name.toLowerCase().includes('buey'))) && (a.breed !== 'Limousin' || a.name.includes('TORO_CHA'))) ||\r\n            (a.isGhost && a.breed === 'Cruzada' && a.fatherId) ||\r\n            (a.fatherId && oxenSetRaw.has(a.fatherId)) || // TRIGGER IF invalid father found\r\n            events.some(e => e.desc && (e.desc.includes('TORO_CHA') || e.desc.includes('Charolais'))) // TRIGGER IF old bull name in events\r\n        );\r\n        const isFreshImport = animals.length > 0 && events.length === 0; // Loose check for events\r\n\r\n        const isSeededStorage = read<string>('isSeeded_V10', 'false') === 'true'; // Forced V10 for cleanup\r\n\r\n        // Trigger if not seeded OR if we detect massive duplication (Safety Valve)\r\n        const ghostCount = animals.filter(a => a.isGhost).length;\r\n        const totalCount = animals.length;\r\n        const isDuplicatesDetected = totalCount > 100 && ghostCount > (totalCount * 0.8);\r\n\r\n        const shouldRunEnrichment = !isSeededStorage || isDuplicatesDetected;\r\n\r\n        if (shouldRunEnrichment && !changed) {\r\n            console.log(\"Starting Data Enrichment & Reparation Engine V3 (Weight Recalc)...\");\r\n            // RESET EVENTS for clean regeneration if we are repairing bad data\r\n            if (hasBadData) {\r\n                console.log(\"Bad data detected - Wiping events for fresh regeneration.\");\r\n                events = [];\r\n            }\r\n            let historyEvents: any[] = [...events];\r\n\r\n            // 0. EMERGENCY PURGE (Before any processing to prevent crash)\r\n            if (isDuplicatesDetected) {\r\n                console.warn(\"CRITICAL: Massive duplication detected. Purging ghosts immediately.\");\r\n                const real = animals.filter(a => !a.isGhost);\r\n                // Keep only last 50 ghosts to be safe, or just 0\r\n                const ghosts = animals.filter(a => a.isGhost).slice(-20);\r\n                animals = [...real, ...ghosts];\r\n                console.log(\"Purge Result: Reduced animals to \" + animals.length);\r\n\r\n                // Deep clean events too\r\n                events = events.slice(-500); // Keep last 500\r\n                write('events', events);\r\n                write('isSeeded_V5', 'true');\r\n            }\r\n\r\n            // 1. PRE-CLEANUP: FIX NAMES, CATEGORIES & FARM\r\n\r\n            // 0. PRE-CLEANUP: FIX NAMES, CATEGORIES & FARM\r\n            const oxenIds = new Set<string>(); // Gather known oxen IDs first\r\n            animals.forEach(a => {\r\n                if (a.category === 'Buey' || a.sex === 'Castrado' || (a.name && a.name.toLowerCase().includes('buey'))) {\r\n                    oxenIds.add(a.id);\r\n                }\r\n            });\r\n\r\n            animals.forEach(a => {\r\n                // Fix Farm Name\r\n                a.farm = 'SOTO del PRIOR';\r\n                a.farmId = 'F0SOTO';\r\n\r\n                // Fix Oxen (Bueyes)\r\n                if ((a.name && a.name.toLowerCase().includes('buey')) ||\r\n                    (a.type && a.type.toLowerCase().includes('buey')) ||\r\n                    (a.observation && a.observation.toLowerCase().includes('buey'))) {\r\n                    a.category = 'Buey';\r\n                    a.sex = 'Castrado';\r\n                    oxenIds.add(a.id); // Add to set if found here\r\n                }\r\n\r\n                // Fix Sire Breed -> Limousin AND Name Consistency\r\n                if ((a.category === 'Semental' || (a.sex === 'Macho' && a.category === 'Toro')) &&\r\n                    a.category !== 'Buey' && a.sex !== 'Castrado') {\r\n                    a.breed = 'Limousin';\r\n                    if (a.name && a.name.includes('TORO_CHA')) {\r\n                        a.name = a.name.replace('TORO_CHA', 'TORO_LIM');\r\n                    }\r\n                }\r\n\r\n                // STRICT PARENT CLEANUP: Remove Father if he is a Buey\r\n                if (a.fatherId && oxenIds.has(a.fatherId)) {\r\n                    console.log(`Clearing invalid paternity: ${a.id} had Ox father ${a.fatherId}`);\r\n                    a.fatherId = null;\r\n                    a.father = null;\r\n                }\r\n\r\n                // FIX: Remove double F1 in breed name and apply F2 nomenclature\r\n                if (a.breed && (a.breed.includes('F1 F1') || a.breed.match(/F1.*F1/))) {\r\n                    a.breed = a.breed.replace(/F1 F1/g, 'F2').replace(/F1.*F1/g, 'F2');\r\n                }\r\n            });\r\n\r\n            // A. IDENTIFY SIRE (SEMENTAL)\r\n            // STRICTER FILTER: Must NOT be Buey/Castrado\r\n            // STRICTER FILTER: Must NOT be Buey/Castrado\r\n            let bull = animals.find(a => (a.category === 'Semental' || (a.sex === 'Macho' && a.category === 'Toro'))\r\n                && a.category !== 'Buey' && a.sex !== 'Castrado');\r\n            if (!bull) {\r\n                // Fallback: Find oldest male > 24m that is NOT castrated\r\n                bull = animals.find(a => a.sex === 'Macho' && a.category !== 'Buey' && a.sex !== 'Castrado' &&\r\n                    (new Date().getFullYear() - new Date(a.birthDate || a.birth).getFullYear()) > 2);\r\n            }\r\n            const bullId = bull ? bull.id : 'unknown_bull';\r\n            // User requested CROTAL for genealogy display instead of Name\r\n            const bullName = bull ? (bull.crotal || bull.name) : 'Toro Externo';\r\n            console.log(`Sire identified: ${bullName}`);\r\n\r\n            // A.1 Helper for Realistic IDs\r\n            const generateRealisticCrotal = () => {\r\n                const region = '08'; // Example region\r\n                const numbers = Math.floor(Math.random() * 10000000000).toString().padStart(10, '0');\r\n                return `ES${region}${numbers}`;\r\n            };\r\n\r\n            // --- BIOMIMETIC SIMULATION ENGINE (Reverse-Engineered Metadata) ---\r\n\r\n            // 1. HELPER: Climate Factor (Seasonality)\r\n            const getClimateFactor = (month: number) => {\r\n                // Month 0=Jan, 11=Dec.\r\n                // Spring (Mar-May): Lush Pasture (1.2)\r\n                if (month >= 2 && month <= 4) return 1.2;\r\n                // Summer (Jun-Aug): Dry/Heat (0.8)\r\n                if (month >= 5 && month <= 7) return 0.8;\r\n                // Autumn (Sep-Nov): Recovery (1.0)\r\n                if (month >= 8 && month <= 10) return 1.0;\r\n                // Winter (Dec-Feb): Cold (0.9)\r\n                return 0.9;\r\n            };\r\n\r\n            // 2. HELPER: Diet Factor\r\n            const getDietFactor = (animal: any, month: number, ageMonths: number) => {\r\n                // Montanera (Oxen Only): Oct-Feb (Months 9,10,11, 0,1)\r\n                const isMontaneraSeason = (month >= 9 || month <= 1);\r\n                const isOx = animal.category === 'Buey' || (animal.sex === 'Macho' && animal.status === 'Castrado');\r\n\r\n                if (isOx && isMontaneraSeason && ageMonths > 18) return 1.5; // High gain on acorns\r\n                if (animal.farm && animal.farm.includes('Feedlot')) return 1.3; // Intensive\r\n                return 1.0; // Standard Pasture\r\n            };\r\n\r\n            // 3. CORE: Biomimetic History Generator (Forward Simulation with Asymptotic Limit)\r\n            const generateBiomimeticHistory = (animal: any) => {\r\n                // SAFETY CHECK: If animal already has valid history and realistic weight, DO NOT OVERWRITE.\r\n                // This prevents \"magic changes\" without user request.\r\n                if (animal.monthlyRecords && animal.monthlyRecords.length > 0 && animal.currentWeight > 80 && animal.currentWeight < 1600) {\r\n                    return;\r\n                }\r\n\r\n                const birthDate = new Date(animal.birthDate || animal.birth);\r\n                const now = new Date();\r\n\r\n                // DETERMINE GENETIC LIMITS (Asymptote)\r\n                let adultWeight = 650; // Default Cow\r\n                if (animal.sex === 'Macho') adultWeight = 1100; // Bull\r\n                if (animal.category === 'Buey' || animal.sex === 'Castrado') adultWeight = 1400; // Ox\r\n\r\n                // Adjust for F1/Breed\r\n                if (animal.breed === 'Limousin' || animal.breed === 'Limousina') {\r\n                    adultWeight *= 1.1; // Larger\r\n                } else if (animal.breed === 'Morucha' || animal.breed === 'Avile√±a' || animal.breed === 'Retinta') {\r\n                    adultWeight *= 0.95; // Rustic slightly smaller\r\n                }\r\n\r\n                const birthWeight = 40;\r\n                let simWeight = birthWeight;\r\n                let currentDate = new Date(birthDate);\r\n\r\n                // Initialize records\r\n                if (!animal.monthlyRecords) animal.monthlyRecords = [];\r\n                const newRecords: any[] = [];\r\n\r\n                // Start simulation from birth\r\n                const months: any[] = [];\r\n\r\n                // Growth Rate (k)\r\n                const k = 0.045; // Approx monthly growth rate coefficient\r\n\r\n                while (currentDate < now) {\r\n                    const m = currentDate.getMonth();\r\n                    const ageMonths = (currentDate.getTime() - birthDate.getTime()) / (1000 * 60 * 60 * 24 * 30.44);\r\n\r\n                    // State Factor\r\n                    let stateFactor = 1.0;\r\n\r\n                    // Pregnancy/Lactation Logic\r\n                    if ((animal.category === 'Vaca' || animal.category === 'Nodriza') && ageMonths > 24) {\r\n                        const cyclePos = ageMonths % 14;\r\n                        if (cyclePos < 9) stateFactor = 1.05; // Pregnant\r\n                        else stateFactor = 0.95; // Lactating loss\r\n                    }\r\n\r\n                    const climatic = getClimateFactor(m);\r\n                    const diet = getDietFactor(animal, m, ageMonths); // Diet Factor (1.0 - 1.5)\r\n\r\n                    // Approximate Diet Energy Mcal\r\n                    const dietEnergy = 2.0 + ((diet - 1.0) * 1.8);\r\n\r\n                    // --- VON BERTALANFFY GROWTH ---\r\n                    // Potential Gain based on distance to Adult Weight\r\n                    // Slows down as it approaches limit\r\n                    const remainingGrowth = adultWeight - simWeight;\r\n                    // If negative (overshoot), we lose weight (maintenance cost dominant)\r\n\r\n                    let monthlyGain = 0;\r\n                    if (remainingGrowth > 0) {\r\n                        monthlyGain = remainingGrowth * k * diet * climatic * stateFactor;\r\n                    } else {\r\n                        // Maintenance / Fluctuation mode\r\n                        // Can lose weight in bad climate/diet\r\n                        if (diet < 1.0 || climatic < 1.0) {\r\n                            monthlyGain = -15 + (diet * 10) + (climatic * 5); // Loss\r\n                        } else {\r\n                            monthlyGain = 5; // Slow creep or fat deposit\r\n                        }\r\n                    }\r\n\r\n                    // Cap monthly gain to realistic bio limits (e.g., max 60kg/month = 2kg/day)\r\n                    if (monthlyGain > 60) monthlyGain = 60;\r\n\r\n                    simWeight += monthlyGain;\r\n                    if (simWeight < 40) simWeight = 40; // Floor\r\n\r\n                    // METRICS CALCULATION (Using Fixed Logic)\r\n                    // 1. Estimate Carcass (Yield)\r\n                    const thi = (m >= 5 && m <= 8) ? 78 : 65;\r\n                    const breedData = {\r\n                        rc_base: 0.58,\r\n                        marbling_potential: 4,\r\n                        adg_feedlot: 1.2\r\n                    };\r\n                    const adgObs = monthlyGain / 30.44;\r\n\r\n                    const carcass = CarcassQualityEngine.estimateCarcassResult(\r\n                        { ageMonths, system: 'Extensivo', sex: animal.sex },\r\n                        simWeight, adgObs, dietEnergy, thi, breedData\r\n                    );\r\n\r\n                    // 2. Calculate Quality\r\n                    const quality = CarcassQualityEngine.calculateQualityIndex(\r\n                        { ageMonths, currentWeight: simWeight, sex: animal.sex, rc_percent: carcass.rc_percent },\r\n                        breedData,\r\n                        dietEnergy,\r\n                        adgObs,\r\n                        thi,\r\n                        150,\r\n                        0,\r\n                        1,\r\n                        { isBellota: diet > 1.2, hasLecithin: diet > 1.2 }\r\n                    );\r\n\r\n                    months.push({ date: new Date(currentDate), m, diet, simWeight, adgObs, carcass, quality, dietEnergy, thi });\r\n\r\n                    newRecords.push({\r\n                        date: new Date(currentDate).toISOString().split('T')[0],\r\n                        weightKg: Math.floor(simWeight),\r\n                        adg: parseFloat(adgObs.toFixed(2)),\r\n                        rc_est: carcass.rc_percent,\r\n                        carcass_weight_est: carcass.carcass_weight,\r\n                        meat_quality_index: quality.iq_score,\r\n                        marbling_est: quality.marbling_est,\r\n                        diet_energy: parseFloat(dietEnergy.toFixed(2)),\r\n                        thi: thi\r\n                    });\r\n\r\n                    currentDate.setMonth(currentDate.getMonth() + 1);\r\n                }\r\n\r\n                // Update Animal Records\r\n                animal.monthlyRecords = newRecords;\r\n\r\n                // B. Generate Events from Timeline\r\n                months.forEach((step, idx) => {\r\n                    const isMontaneraStart = step.m === 9 && step.diet === 1.5;\r\n                    const isMontaneraEnd = step.m === 1 && step.diet === 1.5;\r\n                    const isYearlyCheck = step.date.getMonth() === 5;\r\n\r\n                    if (isMontaneraStart) {\r\n                        historyEvents.push({\r\n                            id: generateUUID(),\r\n                            type: 'Alimentaci√≥n',\r\n                            animalId: animal.id,\r\n                            animalCrotal: animal.crotal || animal.id,\r\n                            date: step.date.toISOString().split('T')[0],\r\n                            desc: 'Inicio Montanera (Bellota).',\r\n                            cost: 120,\r\n                            status: 'completed'\r\n                        });\r\n                    }\r\n\r\n                    if (isYearlyCheck || isMontaneraEnd) {\r\n                        historyEvents.push({\r\n                            id: generateUUID(),\r\n                            type: 'Pesaje',\r\n                            animalId: animal.id,\r\n                            animalCrotal: animal.crotal || animal.id,\r\n                            date: step.date.toISOString().split('T')[0],\r\n                            desc: `Pesaje de Control: ${Math.floor(step.simWeight)}kg (Grasa: ${step.quality.marbling_est})`,\r\n                            weight: Math.floor(step.simWeight),\r\n                            status: 'completed'\r\n                        });\r\n                    }\r\n                });\r\n\r\n                // C. UPDATE ANIMAL STATE (Emergent Property)\r\n                const finalWeight = Math.floor(simWeight);\r\n                animal.currentWeight = finalWeight;\r\n                animal.weight = finalWeight;\r\n\r\n                const lastStep = months[months.length - 1];\r\n\r\n                historyEvents.push({\r\n                    id: generateUUID(),\r\n                    type: 'Pesaje',\r\n                    animalId: animal.id,\r\n                    animalCrotal: animal.crotal || animal.id,\r\n                    date: new Date().toISOString().split('T')[0],\r\n                    desc: `Pesaje Actual (Recalculado V6): ${finalWeight}kg. SEUROP: ${lastStep?.carcass.rc_percent}%`,\r\n                    weight: finalWeight,\r\n                    status: 'completed'\r\n                });\r\n            };\r\n\r\n            // B. PROCESS COWS (MATERNA) - REPRODUCTION EVENTS ONLY\r\n            // ... (Rest of code remains similar) ...\r\n\r\n            // ... (Code cut for brevity of replace block, resuming at critical sections if needed, but ReplaceFileContent requires contiguous block. Checking context lines.)\r\n            // The user wanted simple fix. I will replace the function body of generateBiomimeticHistory up to line 375.\r\n\r\n            // Wait, I need to match exact lines to replace correctly.\r\n            // I will use `replace_file_content` but I must be careful with the huge block.\r\n            // Actually, I can just replace the whole logic block which is isolated. \r\n            // The file view shows lines 222 to 375 is `generateBiomimeticHistory`.\r\n\r\n            // I will return the replacement now.\r\n            // Also need to fix the write('isSeeded_V4', 'true') at line 696 to V6.\r\n\r\n\r\n            // B. PROCESS COWS (MATERNA) - REPRODUCTION EVENTS ONLY\r\n            // (We separate Reproduction from Weight to keep logic clean, then run weight for ALL)\r\n            const cows = animals.filter(a => (a.category === 'Vaca' || a.category === 'Vaca Nodriza' || a.sex === 'Hembra') &&\r\n                (new Date().getTime() - new Date(a.birthDate || a.birth).getTime()) > (1000 * 60 * 60 * 24 * 365 * 2));\r\n\r\n            cows.forEach(cow => {\r\n                const cowBirth = new Date(cow.birthDate || cow.birth);\r\n                let cycleDate = new Date(cowBirth);\r\n                cycleDate.setMonth(cycleDate.getMonth() + 24); // First mating at 24m\r\n\r\n                const now = new Date();\r\n                let cycleCount = 1;\r\n\r\n                while (cycleDate < now) {\r\n                    // 1. Mating Event\r\n                    const matingDate = new Date(cycleDate);\r\n                    historyEvents.push({\r\n                        id: generateUUID(),\r\n                        type: 'Monta Natural',\r\n                        animalId: cow.id,\r\n                        animalCrotal: cow.crotal,\r\n                        date: matingDate.toISOString().split('T')[0],\r\n                        desc: `Monta Natural con ${bullName} (Ciclo ${cycleCount})`,\r\n                        typeData: { bullId: bullId },\r\n                        status: 'completed'\r\n                    });\r\n\r\n                    // 2. Calving (283 days later)\r\n                    const calvingDate = new Date(matingDate);\r\n                    calvingDate.setDate(calvingDate.getDate() + 283);\r\n\r\n                    if (calvingDate > now) {\r\n                        // Future Calving - Schedule Event\r\n                        historyEvents.push({\r\n                            id: generateUUID(),\r\n                            type: 'Parto Previsto',\r\n                            animalId: cow.id,\r\n                            animalCrotal: cow.crotal,\r\n                            date: calvingDate.toISOString().split('T')[0],\r\n                            desc: `Parto estimado (Ciclo ${cycleCount})`,\r\n                            status: 'scheduled'\r\n                        });\r\n                        break;\r\n                    }\r\n\r\n                    // 3. Offspring Handling\r\n                    const calfMatch = animals.find(c => {\r\n                        if (c.id === bullId) return false;\r\n                        const cBirth = new Date(c.birthDate || c.birth);\r\n                        const diffTime = Math.abs(cBirth.getTime() - calvingDate.getTime());\r\n                        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\r\n                        return diffDays <= 45 && !c.motherId;\r\n                    });\r\n\r\n                    if (calfMatch) {\r\n                        calfMatch.motherId = cow.id;\r\n                        calfMatch.fatherId = bullId;\r\n                        calfMatch.father = bullName;\r\n\r\n                        historyEvents.push({\r\n                            id: generateUUID(),\r\n                            type: 'Parto',\r\n                            animalId: cow.id,\r\n                            animalCrotal: cow.crotal,\r\n                            date: calvingDate.toISOString().split('T')[0],\r\n                            desc: `Parto ${cycleCount}: ${calfMatch.sex} (${calfMatch.crotal}) - ACTIVO`,\r\n                            typeData: { calfId: calfMatch.id, calfCrotal: calfMatch.crotal },\r\n                            status: 'completed'\r\n                        });\r\n\r\n                        if (!historyEvents.some(e => e.animalId === calfMatch.id && e.type === 'Nacimiento')) {\r\n                            historyEvents.push({\r\n                                id: generateUUID(),\r\n                                type: 'Nacimiento',\r\n                                animalId: calfMatch.id,\r\n                                animalCrotal: calfMatch.crotal,\r\n                                date: calfMatch.birthDate || calvingDate.toISOString().split('T')[0],\r\n                                desc: `Nacimiento en finca. Madre: ${cow.crotal}, Padre: ${bullName}`,\r\n                                status: 'completed'\r\n                            });\r\n                        }\r\n                    } else {\r\n                        // GHOST CALF\r\n                        const isFemale = Math.random() > 0.5;\r\n                        const ghostId = generateRealisticCrotal();\r\n                        const fate = Math.random() > 0.3 ? 'Sacrificado' : 'Vendido';\r\n                        const exitMonths = fate === 'Sacrificado' ? 14 : 6;\r\n                        const exitDate = new Date(calvingDate);\r\n                        exitDate.setMonth(exitDate.getMonth() + exitMonths);\r\n                        if (exitDate > now) exitDate.setTime(now.getTime() - (1000 * 60 * 60 * 24 * 10));\r\n\r\n                        // OPTIMIZATION: STORAGE QUOTA PROTECTION\r\n                        // Only persist Ghost Calves active in the last 12 months (Strict)\r\n                        const isRecent = (now.getTime() - exitDate.getTime()) < (1000 * 60 * 60 * 24 * 30 * 12);\r\n\r\n                        let slaughterData = {};\r\n                        if (fate === 'Sacrificado') {\r\n                            const cw = 280 + (Math.random() * 100);\r\n                            slaughterData = {\r\n                                carcassWeight: cw.toFixed(1),\r\n                                price: (cw * 5.2).toFixed(2),\r\n                                pricePerKg: 5.2,\r\n                                conf: ['U', 'R', 'O'][Math.floor(Math.random() * 3)],\r\n                                fat: ['2', '3', '4'][Math.floor(Math.random() * 3)]\r\n                            };\r\n                        }\r\n\r\n                        if (isRecent) {\r\n                            const ghostCalf = {\r\n                                id: ghostId,\r\n                                crotal: ghostId,\r\n                                name: `(H) ${isFemale ? 'Novilla' : 'Ternero'} ${cycleCount}`,\r\n                                farm: cow.farm || 'SOTO del PRIOR',\r\n                                breed: (cow.breed === 'Limousin' || cow.breed === 'Limousina') ? 'Limousin' :\r\n                                    (cow.breed && cow.breed.includes('F1')) ? `F2 ${cow.breed.replace('F1', '').trim()} x Limousin` :\r\n                                        `F1 ${cow.breed || 'Cruzada'} x Limousin`,\r\n                                sex: isFemale ? 'Hembra' : 'Macho',\r\n                                birthDate: calvingDate.toISOString().split('T')[0],\r\n                                motherId: cow.id,\r\n                                fatherId: bullId,\r\n                                father: bullName,\r\n                                status: fate,\r\n                                exitDate: exitDate.toISOString().split('T')[0],\r\n                                ...slaughterData,\r\n                                isGhost: true\r\n                            };\r\n                            animals.push(ghostCalf);\r\n                            changed = true;\r\n\r\n                            // Only generate full history for persisted ghosts\r\n                            // generateBiomimeticHistory(ghostCalf); // DISABLED BY USER REQUEST\r\n                        }\r\n\r\n                        historyEvents.push({\r\n                            id: generateUUID(),\r\n                            type: 'Parto',\r\n                            animalId: cow.id,\r\n                            animalCrotal: cow.crotal,\r\n                            date: calvingDate.toISOString().split('T')[0],\r\n                            desc: `Parto ${cycleCount}: ${isFemale ? 'Hembra' : 'Macho'} (${ghostId}) - ${fate} ${!isRecent ? '(Hist√≥rico)' : ''}`,\r\n                            typeData: { calfCrotal: ghostId },\r\n                            status: 'completed'\r\n                        });\r\n                    }\r\n\r\n                    cycleDate.setMonth(cycleDate.getMonth() + 13);\r\n                    cycleCount++;\r\n                }\r\n            });\r\n\r\n            // C. RUN BIO-WEIGHT SIMULATION FOR ALL ACTIVE ANIMALS\r\n            /* DISABLED BY USER REQUEST - REAL DATA MODE\r\n            animals.forEach(animal => {\r\n                // Skip if it's the external sire (don't manage his weight history)\r\n                if (animal.id === bullId && animal.name === 'Toro Externo') return;\r\n\r\n                // Only run for those we haven't just generated ghost history for (optimization?)\r\n                // Actually, safer to just run for everyone to ensure consistency.\r\n                if (!animal.isGhost) {\r\n                    generateBiomimeticHistory(animal);\r\n                }\r\n            });\r\n            */\r\n\r\n            console.log(\"Bio-Simulation Complete.\");\r\n            // Clean duplicates just in case\r\n            const uniqueids = new Set();\r\n            const uniqueEvents = [];\r\n            for (const e of events.reverse()) { // keep latest?\r\n                if (!uniqueids.has(e.id)) {\r\n                    uniqueids.add(e.id);\r\n                    uniqueEvents.push(e);\r\n                }\r\n            }\r\n            events.length = 0;\r\n            events.push(...uniqueEvents.reverse());\r\n\r\n            changed = true;\r\n            console.log(\"Enrichment Complete. Generated events:\", events.length);\r\n        }\r\n        animals.forEach(a => {\r\n            if (a.farm === 'Finca Soto del Prior') {\r\n                a.farm = 'SOTO del PRIOR';\r\n                changed = true;\r\n            }\r\n        });\r\n\r\n        if (changed) {\r\n            write(animalsKey, animals);\r\n            write('events', events);\r\n        }\r\n\r\n        // 4. One-time Migration: Rename Farm Entity\r\n        let fincasChanged = false;\r\n        fincas.forEach(f => {\r\n            if (f.name === 'Finca Soto del Prior') {\r\n                f.name = 'SOTO del PRIOR';\r\n                fincasChanged = true;\r\n            }\r\n        });\r\n\r\n        // 5. Sanitation: Dedup by ID AND Name (Merge duplicates)\r\n        const uniqueAnimalsMap = new Map();\r\n        // First pass: unique by ID\r\n        animals.forEach(a => {\r\n            uniqueAnimalsMap.set(a.id, a);\r\n        });\r\n\r\n        // Second pass: unique by Name (keep latest) to fix \"Double Seeding\"\r\n        const uniqueByName = new Map();\r\n        Array.from(uniqueAnimalsMap.values()).forEach((a: any) => {\r\n            const key = (a.name || 'unknown').trim().toUpperCase();\r\n            // If exists, keep the one with more data or latest\r\n            if (uniqueByName.has(key)) {\r\n                const existing = uniqueByName.get(key);\r\n                // Prefer the one with a real Crotal or ID\r\n                if (!existing.crotal && a.crotal) {\r\n                    uniqueByName.set(key, a);\r\n                }\r\n                // Or just overwrite if we assume later is better? \r\n                // Let's stick to keeping the first one encountered if we iterate backwards, or logic:\r\n                // Actually, let's keep the one that looks \"older\" (real seed) vs new gen?\r\n                // Simple logic: Overwrite.\r\n                // uniqueByName.set(key, a); \r\n                // WAIT: If we have multiple \"BUEY_MORU_01\" with different IDs, we want to keep ONE.\r\n            } else {\r\n                uniqueByName.set(key, a);\r\n            }\r\n        });\r\n\r\n        // Rebuild uniqueAnimalsMap from Unique Names (Aggressive Dedup)\r\n        // Only do this for manually named animals (BUEY_, TORO_, VACA_)\r\n        // UUID-named animals are likely distinct.\r\n        const mergedAnimals = Array.from(uniqueAnimalsMap.values()).filter((a: any) => {\r\n            const nameIdx = (a.name || '').toUpperCase();\r\n            // If this animal is the \"chosen one\" in the name map, keep it.\r\n            // But we need to be careful not to merge \"Novilla 1\" and \"Novilla 1\" if they are different cycles?\r\n            // The issue refers to \"BUEY_...\" types likely.\r\n            if (nameIdx.includes('BUEY') || nameIdx.includes('TORO') || nameIdx.includes('VACA')) {\r\n                return uniqueByName.get(nameIdx).id === a.id;\r\n            }\r\n            return true;\r\n        });\r\n\r\n        let statusChanged = false;\r\n        const activeEvents = ['Sacrificio', 'Muerte', 'Venta', 'Salida'];\r\n\r\n        const cleanAnimals = mergedAnimals.map((a: any) => {\r\n            // FIX: Ensure Crotal Exists AND is Valid\r\n            const isFakeCrotal = a.crotal && a.crotal.startsWith('ES099');\r\n            const hasValidId = a.id && a.id.startsWith('ES') && a.id.length > 10;\r\n\r\n            if (!a.crotal || (isFakeCrotal && hasValidId)) {\r\n                // 1. Check if ID is already a valid Crotal (ES...)\r\n                if (hasValidId) {\r\n                    a.crotal = a.id;\r\n                } else if (!a.crotal) {\r\n                    // 2. Generate deterministic fake crotal based on ID hash or random\r\n                    const numericHash = a.id.split('').reduce((acc: number, char: string) => acc + char.charCodeAt(0), 0);\r\n                    const suffix = (numericHash % 10000).toString().padStart(4, '0');\r\n                    // Use a clearly \"Mock\" range if we must\r\n                    const rand = Math.floor(Math.random() * 9000) + 1000;\r\n                    a.crotal = `ES099000${rand}`;\r\n                }\r\n            }\r\n            // Check events for this animal\r\n            const animalEvents = events.filter(e => e.animalId === a.id);\r\n\r\n            // Find any \"Exit\" event\r\n            const exitEvent = animalEvents.find(e => activeEvents.includes(e.type));\r\n\r\n            // If exit event exists and is in the past/today, enforce status\r\n            if (exitEvent) {\r\n                const eventDate = new Date(exitEvent.date);\r\n                const now = new Date();\r\n                if (eventDate <= now) {\r\n                    const oldStatus = a.status;\r\n                    if (exitEvent.type.includes('Sacrificio')) a.status = 'Sacrificado';\r\n                    else if (exitEvent.type === 'Muerte') a.status = 'Muerto';\r\n                    else if (exitEvent.type === 'Venta') a.status = 'Vendido';\r\n\r\n                    if (a.status !== oldStatus) statusChanged = true;\r\n                    if (!a.exitDate) a.exitDate = exitEvent.date;\r\n                }\r\n            }\r\n            return a;\r\n        });\r\n\r\n        // 6. AGGRESSIVE CLEANUP (Storage Protection)\r\n        // Remove Ghost animals older than 12 months (reduced from 18)\r\n        const ONE_YEAR_MS = 1000 * 60 * 60 * 24 * 365;\r\n        const nowMs = new Date().getTime();\r\n        const prunedAnimals = cleanAnimals.filter(a => {\r\n            if (!a.isGhost) return true;\r\n            if (a.status === 'Activo') return true;\r\n            const exitTime = new Date(a.exitDate || a.date || a.createdAt).getTime();\r\n            return (nowMs - exitTime) < ONE_YEAR_MS;\r\n        });\r\n\r\n        // Prune monthlyRecords if excessive\r\n        prunedAnimals.forEach(a => {\r\n            if (a.monthlyRecords && a.monthlyRecords.length > 12) {\r\n                a.monthlyRecords = a.monthlyRecords.slice(-12);\r\n            }\r\n        });\r\n\r\n        if (cleanAnimals.length !== prunedAnimals.length) {\r\n            console.log(`Pruned ${cleanAnimals.length - prunedAnimals.length} old ghost animals to save space.`);\r\n            changed = true;\r\n        }\r\n\r\n        // Detect if we removed duplicates or changed statuses\r\n        if (cleanAnimals.length !== animals.length) {\r\n            console.log(`Removed ${animals.length - cleanAnimals.length} duplicates.`);\r\n            changed = true;\r\n        }\r\n\r\n        // 7. EMERGENCY GHOST PURGE (Duplicate Storm Fix)\r\n        if (cleanAnimals.filter(a => a.isGhost).length > 200) {\r\n            console.warn(\"Detected Ghost Explosion. Purging ALL ghosts for safety reset.\");\r\n            // Keep only non-ghosts\r\n            const onlyReal = cleanAnimals.filter(a => !a.isGhost);\r\n            // Replace array\r\n            cleanAnimals.length = 0;\r\n            cleanAnimals.push(...onlyReal);\r\n            changed = true;\r\n        }\r\n\r\n        if (changed || fincasChanged || statusChanged) {\r\n            // First try to write isSeeded to prevent loop if main write fails\r\n            write('isSeeded_V10', 'true');\r\n\r\n            write(animalsKey, prunedAnimals);\r\n            write(fincasKey, fincas);\r\n            // Limit events to last 1000 if massive\r\n            if (events.length > 1000) {\r\n                events = events.slice(-1000);\r\n                console.warn(\"Truncating events to last 1000 to prevent overflow.\");\r\n            }\r\n            write('events', events);\r\n            console.log('Advanced Data Seeding & Migration Completed');\r\n        }\r\n\r\n        seededRef.current = true;\r\n    }, [isLoaded, read, write]);\r\n\r\n    return null;\r\n}\r\n","import { CamelToPascal } from './utility-types';\n\n/**\n * Converts string to kebab case\n *\n * @param {string} string\n * @returns {string} A kebabized string\n */\nexport const toKebabCase = (string: string) =>\n  string.replace(/([a-z0-9])([A-Z])/g, '$1-$2').toLowerCase();\n\n/**\n * Converts string to camel case\n *\n * @param {string} string\n * @returns {string} A camelized string\n */\nexport const toCamelCase = <T extends string>(string: T) =>\n  string.replace(/^([A-Z])|[\\s-_]+(\\w)/g, (match, p1, p2) =>\n    p2 ? p2.toUpperCase() : p1.toLowerCase(),\n  );\n\n/**\n * Converts string to pascal case\n *\n * @param {string} string\n * @returns {string} A pascalized string\n */\nexport const toPascalCase = <T extends string>(string: T): CamelToPascal<T> => {\n  const camelCase = toCamelCase(string);\n\n  return (camelCase.charAt(0).toUpperCase() + camelCase.slice(1)) as CamelToPascal<T>;\n};\n\n/**\n * Merges classes into a single string\n *\n * @param {array} classes\n * @returns {string} A string of classes\n */\nexport const mergeClasses = <ClassType = string | undefined | null>(...classes: ClassType[]) =>\n  classes\n    .filter((className, index, array) => {\n      return (\n        Boolean(className) &&\n        (className as string).trim() !== '' &&\n        array.indexOf(className) === index\n      );\n    })\n    .join(' ')\n    .trim();\n\n/**\n * Is empty string\n *\n * @param {unknown} value\n * @returns {boolean} Whether the value is an empty string\n */\nexport const isEmptyString = (value: unknown): boolean => value === '';\n\n/**\n * Check if a component has an accessibility prop\n *\n * @param {object} props\n * @returns {boolean} Whether the component has an accessibility prop\n */\nexport const hasA11yProp = (props: Record<string, any>) => {\n  for (const prop in props) {\n    if (prop.startsWith('aria-') || prop === 'role' || prop === 'title') {\n      return true;\n    }\n  }\n};\n","\r\nimport { Breed } from './breedManager';\r\n\r\n/**\r\n * PriceEngine handles SEUROP carcass classification and pricing logic.\r\n * Default prices are in Euro/100kg Canal.\r\n */\r\nexport const PriceEngine = {\r\n    // Default Dec 2025 Reference Prices (Euro/100kg Canal)\r\n    // Based on Lonja de Salamanca / Ternera Charra\r\n    defaultPrices: {\r\n        // A: A√±ojos (Machos 12-24m)\r\n        \"AR3\": 758.0, \"AU2\": 779.0, \"AU3\": 779.0, \"AO3\": 745.0,\r\n        // D: Vacas (Hembras >48m / Paridas)\r\n        \"DR3\": 760.0, \"DO3\": 720.0, \"DP2\": 640.0, \"DU4\": 800.0, \"DR4\": 760.0,\r\n        // E: Novillas (Hembras 12-48m no paridas)\r\n        \"ER3\": 779.0, \"EU3\": 791.0, \"EO3\": 763.0,\r\n        // Z: Terneros (8-12m)\r\n        \"ZR3\": 780.0, \"ZU3\": 795.0,\r\n        // C: Buey (>24m Castrado)\r\n        \"CR3\": 850.0, \"CU3\": 880.0,\r\n        // B: Toro (>24m Macho)\r\n        \"BR3\": 680.0,\r\n        // V: Ternera Blanca (<8m)\r\n        \"VR3\": 800.0,\r\n        // Generic Class Fallbacks (Euro / 100kg)\r\n        \"A\": 750.0, \"B\": 650.0, \"C\": 800.0, \"D\": 680.0, \"E\": 770.0, \"Z\": 780.0, \"V\": 800.0\r\n    } as Record<string, number>,\r\n\r\n    /**\r\n     * Determine MAPA Official Category Code\r\n     */\r\n    determineMAPACode(animalData: { ageMonths: number, sex: string, isCastrated?: boolean, isParida?: boolean }): string {\r\n        const { ageMonths, sex, isCastrated, isParida } = animalData;\r\n        const s = (sex || '').toLowerCase();\r\n\r\n        // 1. V: < 8 months\r\n        if (ageMonths < 8) return 'V';\r\n\r\n        // 2. Z: 8 - 12 months\r\n        if (ageMonths < 12) return 'Z';\r\n\r\n        // 3. Machos\r\n        if (s === 'macho' || s === 'castrado') {\r\n            if (isCastrated || s === 'castrado') {\r\n                return 'C'; // Buey / Ceb√≥n\r\n            }\r\n            if (ageMonths < 24) return 'A'; // A√±ojo\r\n            return 'B'; // Toro\r\n        }\r\n\r\n        // 4. Hembras\r\n        if (s === 'hembra') {\r\n            if (isParida || ageMonths > 48) return 'D'; // Vaca\r\n            return 'E'; // Novilla\r\n        }\r\n\r\n        return 'A'; // Default\r\n    },\r\n\r\n    /**\r\n     * Calculate projected sales price for an animal\r\n     * @returns total projected price in Euro and the code used\r\n     */\r\n    calculateSalesPrice(\r\n        animal: { ageMonths: number, sex: string, isCastrated?: boolean, isParida?: boolean },\r\n        carcassWeightKg: number,\r\n        conformation: string, // S, E, U, R, O, P\r\n        fat: number // 1-5\r\n    ) {\r\n        const letter = this.determineMAPACode(animal);\r\n        const conf = (conformation || 'R').toUpperCase();\r\n        const ft = (fat || 3).toString();\r\n\r\n        // Try exact match (e.g. AR3)\r\n        const exactCode = `${letter}${conf}${ft}`;\r\n        const classCode = `${letter}${conf}`;\r\n\r\n        let pricePer100Kg = this.defaultPrices[exactCode] ||\r\n            this.defaultPrices[classCode] ||\r\n            this.defaultPrices[letter] ||\r\n            500; // Final fallback\r\n\r\n        const totalValue = (carcassWeightKg / 100) * pricePer100Kg;\r\n\r\n        return {\r\n            totalValue: parseFloat(totalValue.toFixed(2)),\r\n            pricePerKg: parseFloat((pricePer100Kg / 100).toFixed(2)),\r\n            categoryCode: exactCode,\r\n            baseCategory: letter\r\n        };\r\n    },\r\n\r\n    /**\r\n     * Update prices from CSV text\r\n     */\r\n    importPricesFromCSV(csvText: string) {\r\n        const lines = csvText.split('\\n');\r\n        const updates: Record<string, number> = {};\r\n\r\n        lines.forEach(line => {\r\n            const parts = line.split(/,|;/);\r\n            if (parts.length >= 2) {\r\n                const code = parts[0].trim().toUpperCase();\r\n                const price = parseFloat(parts[1].trim());\r\n                if (!isNaN(price)) {\r\n                    updates[code] = price;\r\n                }\r\n            }\r\n        });\r\n\r\n        // In a real app we would merge with persistent storage\r\n        Object.assign(this.defaultPrices, updates);\r\n        return Object.keys(updates).length;\r\n    }\r\n};\r\n","export default {\n  xmlns: 'http://www.w3.org/2000/svg',\n  width: 24,\n  height: 24,\n  viewBox: '0 0 24 24',\n  fill: 'none',\n  stroke: 'currentColor',\n  strokeWidth: 2,\n  strokeLinecap: 'round',\n  strokeLinejoin: 'round',\n};\n","import { useState, useEffect } from 'react';\r\nimport { NutritionEngine } from '../services/nutritionEngine';\r\nimport { CarcassEngine } from '../services/carcassEngine';\r\nimport { LifecycleEngine } from '../services/lifecycleEngine';\r\nimport { BreedManager, Breed } from '../services/breedManager';\r\nimport { PriceEngine } from '../services/priceEngine';\r\n\r\n\r\nexport function useAnimalCalculator() {\r\n    const [breeds, setBreeds] = useState<Record<string, Breed>>({});\r\n    const [results, setResults] = useState<any>(null);\r\n    const [loading, setLoading] = useState(false);\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    useEffect(() => {\r\n        // BreedManager is synchronous now\r\n        const breedList = BreedManager.getAllBreeds();\r\n        const breedMap: Record<string, Breed> = {};\r\n        breedList.forEach(b => {\r\n            breedMap[b.id] = b;\r\n        });\r\n        setBreeds(breedMap);\r\n    }, []);\r\n\r\n    const calculate = async (params: {\r\n        animal: any;\r\n        objective: string;\r\n        system: string;\r\n        feeds?: any[];\r\n        events?: any[];\r\n        overrideBreed?: Breed; // Support for simulating different breeds/crosses\r\n    }) => {\r\n        setLoading(true);\r\n        setError(null);\r\n        setResults(null);\r\n\r\n        try {\r\n            const { animal, system } = params;\r\n\r\n            // Age in Months (Robust Check)\r\n            const ageMonths = LifecycleEngine.getAgeInMonths(animal.birth_date || animal.birth || animal.birthDate);\r\n\r\n            // Determine Effective Breed\r\n            let breed = params.overrideBreed || BreedManager.getBreedById(animal.breed);\r\n\r\n            // SPECIAL LOGIC: Automatic F1 Resolution\r\n            // If breed is generic 'Cruzado' or missing, try to resolve via parents\r\n            const isGeneric = !breed || animal.breed === 'Cruzado' || animal.breed === 'Mestizo';\r\n\r\n            if (isGeneric) {\r\n                // Try to find parent genetics in the animal object\r\n                // Adapting to Schema: animal.genotype?.fatherBreedId OR animal.fatherBreedId shortcut\r\n                const fatherId = animal.genotype?.fatherBreedId || (animal as any).fatherBreedId;\r\n                const motherId = animal.genotype?.motherBreedId || (animal as any).motherBreedId;\r\n\r\n                if (fatherId && motherId) {\r\n                    const hybrid = BreedManager.calculateHybrid(fatherId, motherId);\r\n                    if (hybrid) breed = hybrid;\r\n                }\r\n            }\r\n\r\n            // Fallback & Robust Detection\r\n            if (!breed) {\r\n                // Try Exact Match or Robust Normalization\r\n                const rawBreed = animal.breed || '';\r\n                const normalizedBreed = rawBreed.toLowerCase().normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\");\r\n\r\n                // Try to find in database first (robust search)\r\n                const dbBreeds = BreedManager.getAllBreeds();\r\n                breed = dbBreeds.find(b =>\r\n                    normalizedBreed.includes(b.name.toLowerCase().normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\")) ||\r\n                    normalizedBreed.includes(b.code.toLowerCase())\r\n                );\r\n\r\n                // If still not found and it's a generic \"Cruzado\", try parents one last time\r\n                if (!breed && (normalizedBreed.includes('cruzad') || normalizedBreed.includes('mestiz'))) {\r\n                    const fatherId = animal.genotype?.fatherBreedId || animal.fatherBreedId;\r\n                    const motherId = animal.genotype?.motherBreedId || animal.motherBreedId;\r\n                    if (fatherId && motherId) {\r\n                        breed = BreedManager.calculateHybrid(fatherId, motherId) as any;\r\n                    }\r\n                }\r\n\r\n                // Final Fallback: If no breed data, use a balanced \"Synthetic Cross\" (Limousin x Retinta profile)\r\n                if (!breed) {\r\n                    breed = {\r\n                        id: 'GENERIC_CROSS', code: 'CROSS', name: 'Cruzado (Gen√©rico)',\r\n                        subspecies: 'Cruzado', biological_type: 'Composite',\r\n                        weight_female_adult: 600, weight_male_adult: 950,\r\n                        adg_feedlot: 1.2, slaughter_age_months: 20,\r\n                        conformation_potential: 4, // R+/U-\r\n                        marbling_potential: 3, // Average\r\n                        yield_potential: 0.58,\r\n                        heat_tolerance: 6, milk_potential: 3\r\n                    } as any;\r\n                }\r\n            }\r\n\r\n            // TS Safety Guarantee\r\n            if (!breed) throw new Error(\"No se pudo determinar la raza del animal.\");\r\n\r\n            // Ensure weight is numeric and localized to the most accurate property\r\n            const currentWeight = parseFloat(animal.currentWeight || animal.weight || 0);\r\n\r\n            // 1. Calculate Diet Requirements (New API)\r\n            // Map objective to internal state labels if needed\r\n            let state: any = 'Cebo';\r\n            if (params.objective === 'Mantenimiento') state = 'Mantenimiento';\r\n            if (params.objective.includes('Recr√≠a')) state = 'Mantenimiento'; // Use maintenance-like fiber for weaning/recria moderate\r\n            if (params.objective.includes('Cebo') || params.objective.includes('Engorde')) state = 'Cebo';\r\n\r\n            // Assume weight is current weight\r\n            const adgTarget = breed.adg_feedlot || 1.2; // Use breed potential as target baseline\r\n            const reqs = NutritionEngine.calculateRequirements(currentWeight, adgTarget, ageMonths, state, animal.sex || 'Macho');\r\n\r\n            // 2. Real Diet Calculation\r\n            let dietToAnalyze = params.feeds || [];\r\n\r\n            // Default fallback\r\n            if (!dietToAnalyze || dietToAnalyze.length === 0) {\r\n                // Suggest based on reqs\r\n                dietToAnalyze = [\r\n                    { name: 'Raci√≥n Base (Estimada)', amount: 10, dm_percent: 40, energy_mcal: reqs.em_mcal, protein_percent: reqs.pb_percent, cost_per_kg: 0.03 }\r\n                ];\r\n            }\r\n\r\n            const totalKg = dietToAnalyze.reduce((sum, item) => sum + item.amount, 0);\r\n            const totalCost = dietToAnalyze.reduce((sum, item) => sum + (item.amount * (item.cost_per_kg || 0)), 0);\r\n\r\n            let totalEnergyMcal = 0;\r\n            let totalProteinG = 0;\r\n            let totalFDN = 0;\r\n            let totalDMI = 0;\r\n\r\n            dietToAnalyze.forEach(item => {\r\n                const kgMS = item.amount * (item.dm_percent / 100);\r\n                totalDMI += kgMS;\r\n                totalEnergyMcal += kgMS * (item.energy_mcal || 0);\r\n                totalProteinG += kgMS * ((item.protein_percent || 0) * 10);\r\n                totalFDN += kgMS * ((item.fiber_percent || item.ndf_percent || item.fdn_percent || 0) / 100); // Check multiple keys for FDN\r\n            });\r\n\r\n            // 3. Performance Prediction (New API)\r\n            // Avg Energy Density\r\n            const dietEnergyDensity = totalDMI > 0 ? (totalEnergyMcal / totalDMI) : 0;\r\n\r\n            const predictedADG = NutritionEngine.predictPerformance(breed, dietEnergyDensity, totalDMI, currentWeight);\r\n\r\n            // 4. Carcass Estimation (New API)\r\n            const carcass = CarcassEngine.calculateCarcass(\r\n                animal.weight + (predictedADG * 30), // Projected weight (30 days)\r\n                ageMonths + 1,\r\n                breed,\r\n                dietEnergyDensity,\r\n                predictedADG,\r\n                {\r\n                    isBellota: system.toLowerCase().includes('montanera') || system.toLowerCase().includes('bellota'),\r\n                    isOx: (animal.sex === 'Macho' || animal.sex === 'Castrado') && ageMonths > 24,\r\n                    sex: animal.sex || 'Macho'\r\n                }\r\n            );\r\n\r\n            // 5. Environmental & Efficiency (New API)\r\n            const dietPb = totalDMI > 0 ? (totalProteinG / 10 / totalDMI) : 0; // Back to %\r\n            const nitrogenBalance = NutritionEngine.calculateNitrogenBalance(currentWeight, predictedADG, dietPb, totalDMI) as any;\r\n\r\n            // 6. Advanced Financials\r\n            const historicalEventCosts = (params.events || []).reduce((sum, e) => sum + (parseFloat(e.cost) || 0), 0);\r\n\r\n            // Historical Feed Cost: sum from monthlyRecords if they have cost\r\n            // Fallback: estimate based on average cost per kg if not present\r\n            const historicalFeedCosts = (animal.monthlyRecords || []).reduce((sum: number, record: any) => {\r\n                const recordCost = record.totalCost || (record.w || record.weightKg || 0) * 0.02 * 0.25 * 30; // rough estimate if missing\r\n                return sum + recordCost;\r\n            }, 0);\r\n\r\n            const futureFeedCost = totalCost * 30;\r\n            const totalAccumulatedCost = historicalEventCosts + historicalFeedCosts + futureFeedCost;\r\n\r\n            const salesProjection = PriceEngine.calculateSalesPrice(\r\n                {\r\n                    ageMonths: ageMonths + 1,\r\n                    sex: animal.sex,\r\n                    isCastrated: animal.sex === 'Castrado',\r\n                    isParida: animal.status === 'Parto' || animal.category === 'Nodriza'\r\n                },\r\n                carcass.carcass_weight,\r\n                carcass.conformation,\r\n                Math.round(carcass.marbling_score) // Round to nearest integer for SEUROP lookup (e.g. 3 instead of 3.4)\r\n            );\r\n\r\n            setResults({\r\n                diet: dietToAnalyze,\r\n                projectedGain: predictedADG,\r\n                dmiTarget: reqs.dmi_capacity_kg,\r\n                dmiActual: totalDMI,\r\n                totalCost,\r\n                totalKg,\r\n                historicalCosts: {\r\n                    events: historicalEventCosts,\r\n                    feed: historicalFeedCosts,\r\n                    total: historicalEventCosts + historicalFeedCosts\r\n                },\r\n                financials: {\r\n                    projectedSales: salesProjection.totalValue,\r\n                    pricePerKg: salesProjection.pricePerKg,\r\n                    category: salesProjection.categoryCode,\r\n                    totalCost: totalAccumulatedCost,\r\n                    margin: salesProjection.totalValue - totalAccumulatedCost\r\n                },\r\n                fcr: predictedADG > 0 ? (totalCost / predictedADG) : 0,\r\n                energyTarget: reqs.em_mcal * totalDMI, // Reqs logic implies density * intake\r\n                energyActual: totalEnergyMcal,\r\n                proteinPercent: dietPb,\r\n                alerts: NutritionEngine.validateDiet(\r\n                    dietToAnalyze.map(f => ({ item: f, amount: f.amount })),\r\n                    {\r\n                        totalDMI,\r\n                        totalFDN,\r\n                        totalProteinVal: totalProteinG, // grams\r\n                        totalEnergy: totalEnergyMcal,\r\n                        reqs\r\n                    },\r\n                    params.system\r\n                ),\r\n                imbalances: [], // Deprecated\r\n                carcass: {\r\n                    conformation_est: carcass.conformation,\r\n                    marbling_est: carcass.marbling_score,\r\n                    is_premium: carcass.is_premium,\r\n                    rc_percent: carcass.rc_percent,\r\n                    limitingFactor: (() => {\r\n                        // Logic to determine what's holding back growth\r\n                        const reqEnergy = reqs.em_mcal * totalDMI; // approx needed\r\n                        const reqProtein = (reqs.pb_percent / 100) * totalDMI * 1000; // grams needed\r\n\r\n                        const energyRatio = reqEnergy > 0 ? totalEnergyMcal / reqEnergy : 1;\r\n                        const proteinRatio = reqProtein > 0 ? (totalProteinG) / reqProtein : 1;\r\n\r\n                        if (predictedADG >= (breed.adg_feedlot || 1.4)) return 'Gen√©tica (M√°x)';\r\n                        if (totalDMI >= (reqs.dmi_capacity_kg * 0.95) && energyRatio < 1 && proteinRatio < 1) return 'Ingesta (Llenado)';\r\n\r\n                        if (energyRatio < proteinRatio) return 'Energ√≠a';\r\n                        return 'Prote√≠na';\r\n                    })()\r\n                },\r\n                envImpact: nitrogenBalance\r\n            });\r\n\r\n        } catch (e: any) {\r\n            console.error(e);\r\n            setError(e.message || 'Error en c√°lculo');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return {\r\n        breeds,\r\n        calculate,\r\n        results,\r\n        loading,\r\n        error\r\n    };\r\n}\r\n","\r\nexport interface WeatherData {\r\n    temperature: number;\r\n    humidity: number;\r\n    wind_speed: number;\r\n    precipitation_sum?: number;\r\n    weather_code: number;\r\n    weather_desc: string;\r\n}\r\n\r\nexport const WeatherService = {\r\n    getWeatherDescription(code: number): string {\r\n        switch (code) {\r\n            case 0: return 'Despejado';\r\n            case 1:\r\n            case 2:\r\n            case 3: return 'Nublado';\r\n            case 45:\r\n            case 48: return 'Niebla';\r\n            case 51: case 53: case 55: return 'Llovizna';\r\n            case 61: case 63: case 65: return 'Lluvia';\r\n            case 71: case 73: case 75: return 'Nueve';\r\n            case 95: case 96: case 99: return 'Tormenta';\r\n            default: return 'Desconocido';\r\n        }\r\n    },\r\n\r\n    async getCurrentWeather(lat: number, lon: number): Promise<WeatherData | null> {\r\n        try {\r\n            const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,weather_code,wind_speed_10m`;\r\n            const res = await fetch(url);\r\n            if (!res.ok) throw new Error('Weather API Error');\r\n            const data = await res.json();\r\n\r\n            const curr = data.current;\r\n            return {\r\n                temperature: curr.temperature_2m,\r\n                humidity: curr.relative_humidity_2m,\r\n                wind_speed: curr.wind_speed_10m,\r\n                weather_code: curr.weather_code,\r\n                weather_desc: this.getWeatherDescription(curr.weather_code)\r\n            };\r\n        } catch (e) {\r\n            console.error(e);\r\n            return null;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get historical precipitation for grazing growth analysis\r\n     */\r\n    async getWeeklyPrecipitation(lat: number, lon: number): Promise<number> {\r\n        try {\r\n            const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&daily=precipitation_sum&past_days=7`;\r\n            const res = await fetch(url);\r\n            const data = await res.json();\r\n\r\n            if (data.daily && data.daily.precipitation_sum) {\r\n                return data.daily.precipitation_sum.reduce((a: number, b: number) => a + b, 0);\r\n            }\r\n            return 0;\r\n        } catch (e) {\r\n            return 0;\r\n        }\r\n    },\r\n\r\n    async getForecast(lat: number, lon: number): Promise<any[]> {\r\n        try {\r\n            const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&daily=weather_code,temperature_2m_max,temperature_2m_min,precipitation_sum&timezone=auto&forecast_days=4`;\r\n            const res = await fetch(url);\r\n            const data = await res.json();\r\n\r\n            if (!data.daily) return [];\r\n\r\n            const daily = data.daily;\r\n            const forecast = [];\r\n\r\n            // Skip today (index 0) usually, start from tomorrow? Or show next 3 days including today? \r\n            // User asked for \"pron√≥stico de los 3 siguientes d√≠as\". Let's show indices 0, 1, 2 (Today, +1, +2) or 1, 2, 3.\r\n            // Let's show Today + Next 2 days, or Next 3 days. Usually Forecast implies future.\r\n            // Let's take indices 0, 1, 2 for now as strictly \"next 3 days\" to fill the UI slots.\r\n            for (let i = 0; i < 3; i++) {\r\n                forecast.push({\r\n                    date: daily.time[i],\r\n                    icon: this.getWeatherIcon(daily.weather_code[i]), // Need helper\r\n                    max: daily.temperature_2m_max[i],\r\n                    min: daily.temperature_2m_min[i],\r\n                    precip: daily.precipitation_sum[i],\r\n                    code: daily.weather_code[i]\r\n                });\r\n            }\r\n            return forecast;\r\n        } catch (e) {\r\n            console.error(\"Forecast Error\", e);\r\n            return [];\r\n        }\r\n    },\r\n\r\n    getWeatherIcon(code: number): string {\r\n        if (code === 0) return '‚òÄÔ∏è';\r\n        if (code < 3) return '‚õÖ';\r\n        if (code < 48) return '‚òÅÔ∏è';\r\n        if (code < 60) return 'üåßÔ∏è';\r\n        if (code < 80) return '‚õàÔ∏è';\r\n        return 'üå®Ô∏è';\r\n    },\r\n\r\n    async analyzeClimate(lat: number, lon: number): Promise<{ avgTemp: number; classification: string; annualPrecip: number } | null> {\r\n        try {\r\n            const current = await this.getCurrentWeather(lat, lon);\r\n            const precip = await this.getWeeklyPrecipitation(lat, lon);\r\n\r\n            const isSouth = lat < 40;\r\n            const classification = isSouth ? 'Mediterr√°neo Seco' : 'Continental Templado';\r\n\r\n            const estAnnualPrecip = precip * 40 + (isSouth ? 300 : 600);\r\n\r\n            return {\r\n                avgTemp: current ? current.temperature : 15,\r\n                classification,\r\n                annualPrecip: Math.round(estAnnualPrecip)\r\n            };\r\n        } catch (e) {\r\n            console.error(\"Climate Analysis Error\", e);\r\n            return { avgTemp: 15, classification: 'Desconocido', annualPrecip: 500 };\r\n        }\r\n    }\r\n};\r\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M5 12h14', key: '1ays0h' }],\n  ['path', { d: 'M12 5v14', key: 's699le' }],\n];\n\n/**\n * @component @name Plus\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNNSAxMmgxNCIgLz4KICA8cGF0aCBkPSJNMTIgNXYxNCIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/plus\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Plus = createLucideIcon('plus', __iconNode);\n\nexport default Plus;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M3 3v16a2 2 0 0 0 2 2h16', key: 'c24i48' }],\n  ['path', { d: 'M18 17V9', key: '2bz60n' }],\n  ['path', { d: 'M13 17V5', key: '1frdt8' }],\n  ['path', { d: 'M8 17v-3', key: '17ska0' }],\n];\n\n/**\n * @component @name ChartColumn\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMyAzdjE2YTIgMiAwIDAgMCAyIDJoMTYiIC8+CiAgPHBhdGggZD0iTTE4IDE3VjkiIC8+CiAgPHBhdGggZD0iTTEzIDE3VjUiIC8+CiAgPHBhdGggZD0iTTggMTd2LTMiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/chart-column\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ChartColumn = createLucideIcon('chart-column', __iconNode);\n\nexport default ChartColumn;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['rect', { width: '20', height: '14', x: '2', y: '5', rx: '2', key: 'ynyp8z' }],\n  ['line', { x1: '2', x2: '22', y1: '10', y2: '10', key: '1b3vmo' }],\n];\n\n/**\n * @component @name CreditCard\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cmVjdCB3aWR0aD0iMjAiIGhlaWdodD0iMTQiIHg9IjIiIHk9IjUiIHJ4PSIyIiAvPgogIDxsaW5lIHgxPSIyIiB4Mj0iMjIiIHkxPSIxMCIgeTI9IjEwIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/credit-card\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst CreditCard = createLucideIcon('credit-card', __iconNode);\n\nexport default CreditCard;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2', key: '975kel' }],\n  ['circle', { cx: '12', cy: '7', r: '4', key: '17ys0d' }],\n];\n\n/**\n * @component @name User\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTkgMjF2LTJhNCA0IDAgMCAwLTQtNEg5YTQgNCAwIDAgMC00IDR2MiIgLz4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjciIHI9IjQiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/user\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst User = createLucideIcon('user', __iconNode);\n\nexport default User;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8', key: '5wwlr5' }],\n  [\n    'path',\n    {\n      d: 'M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z',\n      key: 'r6nss1',\n    },\n  ],\n];\n\n/**\n * @component @name House\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTUgMjF2LThhMSAxIDAgMCAwLTEtMWgtNGExIDEgMCAwIDAtMSAxdjgiIC8+CiAgPHBhdGggZD0iTTMgMTBhMiAyIDAgMCAxIC43MDktMS41MjhsNy02YTIgMiAwIDAgMSAyLjU4MiAwbDcgNkEyIDIgMCAwIDEgMjEgMTB2OWEyIDIgMCAwIDEtMiAySDVhMiAyIDAgMCAxLTItMnoiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/house\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst House = createLucideIcon('house', __iconNode);\n\nexport default House;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['circle', { cx: '12', cy: '12', r: '10', key: '1mglay' }],\n  ['line', { x1: '12', x2: '12', y1: '8', y2: '12', key: '1pkeuh' }],\n  ['line', { x1: '12', x2: '12.01', y1: '16', y2: '16', key: '4dfq90' }],\n];\n\n/**\n * @component @name CircleAlert\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgLz4KICA8bGluZSB4MT0iMTIiIHgyPSIxMiIgeTE9IjgiIHkyPSIxMiIgLz4KICA8bGluZSB4MT0iMTIiIHgyPSIxMi4wMSIgeTE9IjE2IiB5Mj0iMTYiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/circle-alert\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst CircleAlert = createLucideIcon('circle-alert', __iconNode);\n\nexport default CircleAlert;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2', key: '1yyitq' }],\n  ['path', { d: 'M16 3.128a4 4 0 0 1 0 7.744', key: '16gr8j' }],\n  ['path', { d: 'M22 21v-2a4 4 0 0 0-3-3.87', key: 'kshegd' }],\n  ['circle', { cx: '9', cy: '7', r: '4', key: 'nufk8' }],\n];\n\n/**\n * @component @name Users\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTYgMjF2LTJhNCA0IDAgMCAwLTQtNEg2YTQgNCAwIDAgMC00IDR2MiIgLz4KICA8cGF0aCBkPSJNMTYgMy4xMjhhNCA0IDAgMCAxIDAgNy43NDQiIC8+CiAgPHBhdGggZD0iTTIyIDIxdi0yYTQgNCAwIDAgMC0zLTMuODciIC8+CiAgPGNpcmNsZSBjeD0iOSIgY3k9IjciIHI9IjQiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/users\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Users = createLucideIcon('users', __iconNode);\n\nexport default Users;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M12 3v12', key: '1x0j5s' }],\n  ['path', { d: 'm17 8-5-5-5 5', key: '7q97r8' }],\n  ['path', { d: 'M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4', key: 'ih7n3h' }],\n];\n\n/**\n * @component @name Upload\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTIgM3YxMiIgLz4KICA8cGF0aCBkPSJtMTcgOC01LTUtNSA1IiAvPgogIDxwYXRoIGQ9Ik0yMSAxNXY0YTIgMiAwIDAgMS0yIDJINWEyIDIgMCAwIDEtMi0ydi00IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/upload\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Upload = createLucideIcon('upload', __iconNode);\n\nexport default Upload;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['ellipse', { cx: '12', cy: '5', rx: '9', ry: '3', key: 'msslwz' }],\n  ['path', { d: 'M3 5V19A9 3 0 0 0 21 19V5', key: '1wlel7' }],\n  ['path', { d: 'M3 12A9 3 0 0 0 21 12', key: 'mv7ke4' }],\n];\n\n/**\n * @component @name Database\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8ZWxsaXBzZSBjeD0iMTIiIGN5PSI1IiByeD0iOSIgcnk9IjMiIC8+CiAgPHBhdGggZD0iTTMgNVYxOUE5IDMgMCAwIDAgMjEgMTlWNSIgLz4KICA8cGF0aCBkPSJNMyAxMkE5IDMgMCAwIDAgMjEgMTIiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/database\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Database = createLucideIcon('database', __iconNode);\n\nexport default Database;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M10 11v6', key: 'nco0om' }],\n  ['path', { d: 'M14 11v6', key: 'outv1u' }],\n  ['path', { d: 'M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6', key: 'miytrc' }],\n  ['path', { d: 'M3 6h18', key: 'd0wm0j' }],\n  ['path', { d: 'M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2', key: 'e791ji' }],\n];\n\n/**\n * @component @name Trash2\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTAgMTF2NiIgLz4KICA8cGF0aCBkPSJNMTQgMTF2NiIgLz4KICA8cGF0aCBkPSJNMTkgNnYxNGEyIDIgMCAwIDEtMiAySDdhMiAyIDAgMCAxLTItMlY2IiAvPgogIDxwYXRoIGQ9Ik0zIDZoMTgiIC8+CiAgPHBhdGggZD0iTTggNlY0YTIgMiAwIDAgMSAyLTJoNGEyIDIgMCAwIDEgMiAydjIiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/trash-2\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Trash2 = createLucideIcon('trash-2', __iconNode);\n\nexport default Trash2;\n","import { createElement, forwardRef } from 'react';\nimport { mergeClasses, toKebabCase, toPascalCase } from '@lucide/shared';\nimport { IconNode, LucideProps } from './types';\nimport Icon from './Icon';\n\n/**\n * Create a Lucide icon component\n * @param {string} iconName\n * @param {array} iconNode\n * @returns {ForwardRefExoticComponent} LucideIcon\n */\nconst createLucideIcon = (iconName: string, iconNode: IconNode) => {\n  const Component = forwardRef<SVGSVGElement, LucideProps>(({ className, ...props }, ref) =>\n    createElement(Icon, {\n      ref,\n      iconNode,\n      className: mergeClasses(\n        `lucide-${toKebabCase(toPascalCase(iconName))}`,\n        `lucide-${iconName}`,\n        className,\n      ),\n      ...props,\n    }),\n  );\n\n  Component.displayName = toPascalCase(iconName);\n\n  return Component;\n};\n\nexport default createLucideIcon;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'm21 21-4.34-4.34', key: '14j7rj' }],\n  ['circle', { cx: '11', cy: '11', r: '8', key: '4ej97u' }],\n];\n\n/**\n * @component @name Search\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMjEgMjEtNC4zNC00LjM0IiAvPgogIDxjaXJjbGUgY3g9IjExIiBjeT0iMTEiIHI9IjgiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/search\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Search = createLucideIcon('search', __iconNode);\n\nexport default Search;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M8 2v4', key: '1cmpym' }],\n  ['path', { d: 'M16 2v4', key: '4m81vk' }],\n  ['rect', { width: '18', height: '18', x: '3', y: '4', rx: '2', key: '1hopcy' }],\n  ['path', { d: 'M3 10h18', key: '8toen8' }],\n];\n\n/**\n * @component @name Calendar\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNOCAydjQiIC8+CiAgPHBhdGggZD0iTTE2IDJ2NCIgLz4KICA8cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIHg9IjMiIHk9IjQiIHJ4PSIyIiAvPgogIDxwYXRoIGQ9Ik0zIDEwaDE4IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/calendar\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Calendar = createLucideIcon('calendar', __iconNode);\n\nexport default Calendar;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M18 6 6 18', key: '1bl5f8' }],\n  ['path', { d: 'm6 6 12 12', key: 'd8bk6v' }],\n];\n\n/**\n * @component @name X\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTggNiA2IDE4IiAvPgogIDxwYXRoIGQ9Im02IDYgMTIgMTIiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/x\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst X = createLucideIcon('x', __iconNode);\n\nexport default X;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M16 7h6v6', key: 'box55l' }],\n  ['path', { d: 'm22 7-8.5 8.5-5-5L2 17', key: '1t1m79' }],\n];\n\n/**\n * @component @name TrendingUp\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTYgN2g2djYiIC8+CiAgPHBhdGggZD0ibTIyIDctOC41IDguNS01LTVMMiAxNyIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/trending-up\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst TrendingUp = createLucideIcon('trending-up', __iconNode);\n\nexport default TrendingUp;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'm16 17 5-5-5-5', key: '1bji2h' }],\n  ['path', { d: 'M21 12H9', key: 'dn1m92' }],\n  ['path', { d: 'M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4', key: '1uf3rs' }],\n];\n\n/**\n * @component @name LogOut\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTYgMTcgNS01LTUtNSIgLz4KICA8cGF0aCBkPSJNMjEgMTJIOSIgLz4KICA8cGF0aCBkPSJNOSAyMUg1YTIgMiAwIDAgMS0yLTJWNWEyIDIgMCAwIDEgMi0yaDQiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/log-out\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst LogOut = createLucideIcon('log-out', __iconNode);\n\nexport default LogOut;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M12 15V3', key: 'm9g1x1' }],\n  ['path', { d: 'M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4', key: 'ih7n3h' }],\n  ['path', { d: 'm7 10 5 5 5-5', key: 'brsn70' }],\n];\n\n/**\n * @component @name Download\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTIgMTVWMyIgLz4KICA8cGF0aCBkPSJNMjEgMTV2NGEyIDIgMCAwIDEtMiAySDVhMiAyIDAgMCAxLTItMnYtNCIgLz4KICA8cGF0aCBkPSJtNyAxMCA1IDUgNS01IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/download\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Download = createLucideIcon('download', __iconNode);\n\nexport default Download;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16', key: 'jecpp' }],\n  ['rect', { width: '20', height: '14', x: '2', y: '6', rx: '2', key: 'i6l2r4' }],\n];\n\n/**\n * @component @name Briefcase\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTYgMjBWNGEyIDIgMCAwIDAtMi0yaC00YTIgMiAwIDAgMC0yIDJ2MTYiIC8+CiAgPHJlY3Qgd2lkdGg9IjIwIiBoZWlnaHQ9IjE0IiB4PSIyIiB5PSI2IiByeD0iMiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/briefcase\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Briefcase = createLucideIcon('briefcase', __iconNode);\n\nexport default Briefcase;\n","export interface FeedItem {\r\n    id: string;\r\n    name: string;\r\n    category: 'Forraje' | 'Concentrado' | 'Suplemento' | 'Ecol√≥gico';\r\n    dm_percent: number; // Materia Seca %\r\n    energy_mcal: number; // Mcal NEg/kg MS\r\n    protein_percent: number; // PB %\r\n    fiber_percent: number; // FDN %\r\n    cost_per_kg: number; // ‚Ç¨/kg Fresco\r\n    is_ecological?: boolean;\r\n    description?: string;\r\n}\r\n\r\nexport const FEED_DATABASE: FeedItem[] = [\r\n    // Forrajes Standard\r\n    { id: 'F01', name: 'Pasto Natural', category: 'Forraje', dm_percent: 22, energy_mcal: 1.28, protein_percent: 13, fiber_percent: 45, cost_per_kg: 0.12, description: 'Mantenimiento y recr√≠a' },\r\n    { id: 'F02', name: 'Pasto Mejorado (Ryegrass)', category: 'Forraje', dm_percent: 23, energy_mcal: 1.35, protein_percent: 15, fiber_percent: 45, cost_per_kg: 0.12, description: 'Recr√≠a y crecimiento' },\r\n    { id: 'F03', name: 'Heno de Pradera', category: 'Forraje', dm_percent: 88, energy_mcal: 1.1, protein_percent: 10, fiber_percent: 60, cost_per_kg: 0.12, description: 'Mantenimiento' },\r\n    { id: 'F04', name: 'Heno de Alfalfa', category: 'Forraje', dm_percent: 89, energy_mcal: 1.25, protein_percent: 18, fiber_percent: 45, cost_per_kg: 0.12, description: 'Recr√≠a y lactaci√≥n. Alto calcio' },\r\n    { id: 'F05', name: 'Ensilado de Ma√≠z', category: 'Forraje', dm_percent: 35, energy_mcal: 1.6, protein_percent: 8, fiber_percent: 49, cost_per_kg: 0.12, description: 'Engorde. Alto aporte energ√©tico' },\r\n    { id: 'paja', name: 'Paja de Cereal', category: 'Forraje', dm_percent: 90, energy_mcal: 0.6, protein_percent: 3, fiber_percent: 75, cost_per_kg: 0.05, description: 'Fibra efectiva' },\r\n\r\n    // Especial Dehesa\r\n    { id: 'BELLHO_01', name: 'Bellota (Dehesa)', category: 'Forraje', dm_percent: 62, energy_mcal: 2.2, protein_percent: 6, fiber_percent: 22, cost_per_kg: 0.10, description: 'Acabado extensivo estacional. Alta en √°cido oleico' },\r\n\r\n    // Concentrados Energ√©ticos\r\n    { id: 'C01', name: 'Ma√≠z Grano', category: 'Concentrado', dm_percent: 89, energy_mcal: 2.05, protein_percent: 9, fiber_percent: 12, cost_per_kg: 0.25, description: 'ADG y marmoleo' },\r\n    { id: 'C02', name: 'Cebada', category: 'Concentrado', dm_percent: 88, energy_mcal: 1.95, protein_percent: 11, fiber_percent: 18, cost_per_kg: 0.25, description: 'Engorde seguro' },\r\n    { id: 'C03', name: 'Trigo', category: 'Concentrado', dm_percent: 88, energy_mcal: 2.0, protein_percent: 12, fiber_percent: 10, cost_per_kg: 0.25, description: 'Engorde r√°pido. Peligro de acidosis' },\r\n    { id: 'C04', name: 'DDGS (Ma√≠z)', category: 'Concentrado', dm_percent: 90, energy_mcal: 2.05, protein_percent: 28, fiber_percent: 32, cost_per_kg: 0.25, description: 'Sustituto de cereal' },\r\n    { id: 'C05', name: 'Pulpa de Remolacha', category: 'Concentrado', dm_percent: 90, energy_mcal: 1.7, protein_percent: 10, fiber_percent: 40, cost_per_kg: 0.25, description: 'Mejora digestibilidad' },\r\n    { id: 'C06', name: 'Cascarilla de Soja', category: 'Concentrado', dm_percent: 90, energy_mcal: 1.4, protein_percent: 14, fiber_percent: 60, cost_per_kg: 0.25, description: 'Fuente de fibra' },\r\n    { id: 'triticale', name: 'Triticale', category: 'Concentrado', dm_percent: 88, energy_mcal: 1.85, protein_percent: 12, fiber_percent: 14, cost_per_kg: 0.24 },\r\n    { id: 'avena', name: 'Avena', category: 'Concentrado', dm_percent: 89, energy_mcal: 1.7, protein_percent: 11, fiber_percent: 28, cost_per_kg: 0.22 },\r\n\r\n    // Proteicos\r\n    { id: 'P01', name: 'Harina de Soja 47%', category: 'Concentrado', dm_percent: 88, energy_mcal: 1.9, protein_percent: 47, fiber_percent: 15, cost_per_kg: 0.42, description: 'Construcci√≥n muscular' },\r\n    { id: 'P02', name: 'Colza', category: 'Concentrado', dm_percent: 90, energy_mcal: 1.7, protein_percent: 38, fiber_percent: 13, cost_per_kg: 0.42, description: 'Sustituto de soja eficiente' },\r\n    { id: 'P03', name: 'Guisante Proteico', category: 'Concentrado', dm_percent: 88, energy_mcal: 1.6, protein_percent: 24, fiber_percent: 20, cost_per_kg: 0.42, description: 'Recr√≠a joven. Producci√≥n KM0' },\r\n    { id: 'P04', name: 'Urea (NNP)', category: 'Suplemento', dm_percent: 100, energy_mcal: 0, protein_percent: 281, fiber_percent: 0, cost_per_kg: 0.42, description: 'Solo animales >8 meses' },\r\n\r\n    // Suplementos\r\n    { id: 'S01', name: 'N√∫cleo Mineral', category: 'Suplemento', dm_percent: 100, energy_mcal: 0, protein_percent: 0, fiber_percent: 0, cost_per_kg: 0.80, description: 'Salud general' },\r\n    { id: 'S02', name: 'Premezcla de Engorde', category: 'Suplemento', dm_percent: 95, energy_mcal: 0, protein_percent: 12, fiber_percent: 0, cost_per_kg: 0.80, description: 'Mejorar FCR' },\r\n    { id: 'S03', name: 'Vitaminas ADE', category: 'Suplemento', dm_percent: 100, energy_mcal: 0, protein_percent: 0, fiber_percent: 0, cost_per_kg: 0.80, description: 'Salud inmunitaria' },\r\n    { id: 'S04', name: 'Corrector de Acidosis', category: 'Suplemento', dm_percent: 100, energy_mcal: 0, protein_percent: 0, fiber_percent: 0, cost_per_kg: 0.80, description: 'Estabilidad ruminal' },\r\n\r\n    // Ecol√≥gicos\r\n    { id: 'pienso_eco', name: 'Pienso Eco Certificado', category: 'Ecol√≥gico', dm_percent: 90, energy_mcal: 1.9, protein_percent: 13, fiber_percent: 14, cost_per_kg: 0.58, is_ecological: true },\r\n    { id: 'guisante_eco', name: 'Guisante Eco', category: 'Ecol√≥gico', dm_percent: 90, energy_mcal: 1.8, protein_percent: 22, fiber_percent: 6, cost_per_kg: 0.45, is_ecological: true }\r\n];\r\n","\r\nimport { Breed } from './breedManager';\r\n\r\nexport interface CarcassResult {\r\n    rc_est: number; // 0.60 etc\r\n    rc_percent: number; // 60%\r\n    carcass_weight: number;\r\n    marbling_score: number; // 1-5 (Genetic + Diet)\r\n    bms: number; // 1-12 (Standard Scale)\r\n    conformation: string; // S, E, U, R, O, P\r\n    synergy_bonus_applied: number;\r\n    is_premium: boolean;\r\n}\r\n\r\nexport const CarcassEngine = {\r\n    /**\r\n     * Clamp helper\r\n     */\r\n    clamp(num: number, min: number, max: number) {\r\n        return Math.min(Math.max(num, min), max);\r\n    },\r\n\r\n    /**\r\n     * Normalize helper\r\n     */\r\n    norm(val: number, min: number, max: number) {\r\n        return this.clamp((val - min) / (max - min), 0, 1);\r\n    },\r\n\r\n    /**\r\n     * Calculate Realistic Carcass Metrics (Bio-Physical Model)\r\n     */\r\n    calculateCarcass(\r\n        currentWeight: number,\r\n        ageMonths: number,\r\n        breed: Breed,\r\n        dietEnergyMcal: number,\r\n        adg: number,\r\n        options: {\r\n            isBellota?: boolean,\r\n            hasLecithin?: boolean,\r\n            isOx?: boolean,\r\n            sex?: 'Macho' | 'Hembra' | 'Castrado',\r\n            synergyBonuses?: { marbling: number, yield_percent: number },\r\n            currentMonth?: number, // 0-11\r\n            fatherBreed?: Breed, // New: Specific genetics\r\n            motherBreed?: Breed  // New: Specific genetics\r\n        } = {}\r\n    ): CarcassResult {\r\n        // 1. Determine Effective Genetics (Hybrid Logic)\r\n        let effectiveBreed = { ...breed };\r\n\r\n        // If strict parents provided, calculate hybrid values\r\n        if (options.fatherBreed && options.motherBreed && options.fatherBreed.name !== options.motherBreed.name) {\r\n            // Simple Dominance/Average Logic\r\n            effectiveBreed.conformation_potential = (options.fatherBreed.conformation_potential! + options.motherBreed.conformation_potential!) / 2;\r\n            effectiveBreed.marbling_potential = (options.fatherBreed.marbling_potential + options.motherBreed.marbling_potential) / 2;\r\n            effectiveBreed.yield_potential = ((options.fatherBreed.yield_potential || 0.58) + (options.motherBreed.yield_potential || 0.58)) / 2;\r\n\r\n            // MATERNAL EFFECT (Epigenetics & Metabolic Programming)\r\n            // 1. Marbling: High fat mothers program offspring for better fat deposition\r\n            if (options.motherBreed.marbling_potential >= 4) {\r\n                effectiveBreed.marbling_potential += 0.5;\r\n            }\r\n\r\n            // 2. Milk: High milk mothers ensure better structural development (weaning weight)\r\n            // Bonus to conformation potential if mother is good milker\r\n            if (options.motherBreed.milk_potential >= 4) {\r\n                effectiveBreed.conformation_potential = (effectiveBreed.conformation_potential || 3) + 0.3;\r\n            }\r\n            // Penalty if mother is poor milker (stunted growth start)\r\n            if (options.motherBreed.milk_potential <= 1) {\r\n                effectiveBreed.conformation_potential = (effectiveBreed.conformation_potential || 3) - 0.2;\r\n            }\r\n\r\n            // HETEROSIS (Hybrid Vigor) - Boosts Yield/Resilience slightly\r\n            effectiveBreed.yield_potential = (effectiveBreed.yield_potential || 0.58) + 0.01; // +1% yield for hybrids\r\n        }\r\n\r\n        // --- 1. YIELD CALCULATION (Rendimiento Canal) ---\r\n        // Base Yield comes strictly from Genetics (e.g. Limousin 62%, Angus 58%)\r\n        // If data missing, fallback to Type-based Assumption\r\n        let baseYield = effectiveBreed.yield_potential || 0.53;\r\n        if (!effectiveBreed.yield_potential) {\r\n            if (breed.code === 'AZB') baseYield = 0.63; // Hyper-muscular\r\n            else if (breed.code === 'LIM' || breed.code === 'BDA') baseYield = 0.59;\r\n            else if (breed.code === 'CHA') baseYield = 0.58;\r\n            else if (breed.code === 'ANG' || breed.code === 'HER') baseYield = 0.55;\r\n        }\r\n\r\n        // Sex Adjustment (Biology)\r\n        if (options.sex === 'Macho') baseYield += 0.01; // Bulls slightly denser\r\n        if (options.sex === 'Hembra') baseYield -= 0.02; // Females have more visceral waste\r\n        if (options.sex === 'Castrado' || options.isOx) baseYield -= 0.01;\r\n\r\n        // Physiological Checks\r\n        // Energy Diet pushes \"Finish\"\r\n        const energyFactor = this.norm(dietEnergyMcal, 1.5, 3.0) * 0.012; // Max +1.2% (Reduced from 2%)\r\n\r\n        // Age Factor: Maturity fills the frame\r\n        const ageFactor = this.norm(ageMonths, 12, 36) * 0.010; // Max +1.0% (Reduced from 1.5%)\r\n\r\n        // Synergy (Metabolic Efficiency Bonus)\r\n        const synergyYield = options.synergyBonuses ? (options.synergyBonuses.yield_percent / 100) : 0;\r\n\r\n        let rc = baseYield + energyFactor + ageFactor + synergyYield;\r\n        console.log('[CarcassEngine] Yield Calc:', { baseYield, energyFactor, ageFactor, synergyYield, rc, breedCode: breed.code });\r\n        rc = this.clamp(rc, 0.45, 0.70); // Realistic Biological Extremes\r\n\r\n        // --- 2. MARBLING (Intramuscular Fat) ---\r\n        // Dynamics: Genetics (Base) + Diet (Fuel) + Climate (Condition)\r\n\r\n        // A. Genetics (Modified by Hybrid Logic)\r\n        let marblingScoreInternal = effectiveBreed.marbling_potential || 1;\r\n\r\n        // B. Diet Energy (The \"Finisher\" Factor)\r\n        // Exponential curve: High energy allows expression of genetic potential\r\n        const energyFactorMarbling = this.norm(dietEnergyMcal, 1.6, 3.0); // Starts at 1.6 instead of 2.0\r\n        const dietBonus = energyFactorMarbling * 2.0; // Max +2.0 points from diet alone\r\n        marblingScoreInternal += dietBonus;\r\n\r\n        // C. Age/Weight (Maturity)\r\n        // Marbling happens LATE. Penalize if young/light.\r\n        const maturity = this.norm(currentWeight, 300, 600);\r\n        marblingScoreInternal *= (0.5 + (maturity * 0.5)); // 50% penalty if very young, 100% potential if mature\r\n\r\n        // D. Synergies (e.g. Bellota)\r\n        if (options.isBellota) {\r\n            marblingScoreInternal += 0.8; // Significant boost for acorn-fed finishers\r\n        }\r\n\r\n        if (options.synergyBonuses?.marbling) {\r\n            marblingScoreInternal += options.synergyBonuses.marbling;\r\n        }\r\n\r\n        // E. Climate Stress (Cortisol reduces intramuscular fat deposition)\r\n        if (options.currentMonth !== undefined) {\r\n            const m = options.currentMonth;\r\n            const isSummer = m >= 5 && m <= 8;\r\n            if (isSummer) {\r\n                const tolerance = effectiveBreed.heat_tolerance || 5;\r\n                if (tolerance < 5) marblingScoreInternal -= 0.5; // Stress penalty\r\n            }\r\n\r\n        }\r\n\r\n        // F. Castration/Ox Bonus (Marbling)\r\n        // Castrates deposit fat much better than Bulls\r\n        if (options.sex === 'Castrado' || options.isOx) {\r\n            marblingScoreInternal += 0.5; // Significant bonus for steer/ox\r\n            if (ageMonths > 36) marblingScoreInternal += 0.3; // Old ox bonus\r\n        }\r\n\r\n        // Cap Logic for Internal Score (approx 1-6 range internally before BMS map)\r\n        marblingScoreInternal = Math.max(1, marblingScoreInternal);\r\n\r\n        // BMS Scale (1-12 standard)\r\n        // Map 1-6 internal score to 1-12 BMS\r\n        // 1->1, 3->4, 5->8, 6->10+\r\n        let bms = Math.round(1 + ((marblingScoreInternal - 1) * 2.2));\r\n        bms = this.clamp(bms, 1, 12);\r\n\r\n        // Convert BMS back to 1-5 scale output if needed, or just allow the internal score to be the \"marbling_score\"\r\n        const finalMarblingScore = this.clamp(marblingScoreInternal, 1, 5);\r\n\r\n        // --- 3. CONFORMATION (SEUROP) ---\r\n        // Dynamic Logic: Genetics + Diet + Adaptation\r\n\r\n        // A. Genetic Potential (Modified by Hybrid Logic)\r\n        const pot = effectiveBreed.conformation_potential || 3; // 1=P ... 6=S\r\n        let score = pot;\r\n\r\n        // B. Diet Impact (The \"Angus to S\" Factor)\r\n        const dietBonusConformation = this.norm(dietEnergyMcal, 1.8, 2.8) * 1.5; // More responsive range 1.8-2.8\r\n        score += dietBonusConformation;\r\n\r\n        // C. Climate Adaptation (Genetics vs Environment)\r\n        // If heat tolerant breed in summer -> Bonus (Thrives)\r\n        if (options.currentMonth !== undefined) {\r\n            const m = options.currentMonth;\r\n            const isSummer = m >= 5 && m <= 8; // Jun-Sep\r\n            const tolerance = effectiveBreed.heat_tolerance || 5; // 1-10\r\n\r\n            if (isSummer) {\r\n                if (tolerance >= 8) score += 0.3; // Thrives in heat (Brahman)\r\n                if (tolerance <= 3) score -= 0.5; // Suffers in heat (Angus/Hereford)\r\n            }\r\n        }\r\n\r\n        // D. Synergy Bonus\r\n        // Not implemented specifically for conformation yet, but reserved\r\n\r\n        // E. Structural Adjustments\r\n        // Bulls are blockier (+0.5), Cows angular (-0.5)\r\n        if (options.sex === 'Macho') score += 0.5;\r\n        if (options.sex === 'Hembra' && breed.code !== 'AZB') score -= 0.5;\r\n        if (options.sex === 'Castrado' || options.isOx) score += 0.0; // Neutral (Better than cow, less than bull)\r\n\r\n        // Weight Check (RELATIVE MATURITY) - Fix for small breeds\r\n        const targetAdultWeight = options.sex === 'Hembra' ? effectiveBreed.weight_female_adult : effectiveBreed.weight_male_adult;\r\n        const maturityRatio = currentWeight / (targetAdultWeight || 600); // Guard against missing data\r\n\r\n        if (maturityRatio < 0.75) {\r\n            // Penalize only if immature relative to THEIR potential\r\n            // e.g. Betizu at 320kg is 1.0 maturity -> No penalty.\r\n            // Limousin at 320kg is 0.4 maturity -> Heavy penalty.\r\n            const immaturity = 0.75 - maturityRatio;\r\n        } else if (maturityRatio > 1.15) {\r\n            // \"Analytic\" Overweight Check: Fat vs Muscle?\r\n            // User Feedback: If animal is heavy but NOT on intensive feedlot diet, it's superior growth (Muscle).\r\n            // If animal is heavy AND on intensive diet, it's likely Over-Finished (Fat).\r\n\r\n            if (dietEnergyMcal > 2.75) {\r\n                // High Energy Density (>2.75 Mcal usually means hefty concentrates)\r\n                // Case: Cebo / Feedlot Over-Finished -> Penalty (Patchy Fat)\r\n                const overweight = maturityRatio - 1.15;\r\n                score -= Math.min(overweight * 2, 1.0);\r\n            } else {\r\n                // Moderate/Low Energy Density (Pasture/Forage based)\r\n                // Case: Superior Genetic Development (Growing faster than breed avg on natural diet)\r\n                // Reward: Bonus for superior frame/muscularity\r\n                score += 0.5;\r\n            }\r\n        }\r\n\r\n        // Final Score Calculation\r\n        score = Math.round(score);\r\n        score = Math.min(Math.max(score, 1), 6); // Clamp P to S\r\n\r\n        const maps = ['P', 'O', 'R', 'U', 'E', 'S'];\r\n        const conf = maps[score - 1] || 'R';\r\n\r\n        return {\r\n            rc_est: parseFloat(rc.toFixed(4)),\r\n            rc_percent: parseFloat((rc * 100).toFixed(2)),\r\n            carcass_weight: parseFloat((currentWeight * rc).toFixed(1)),\r\n            marbling_score: parseFloat(finalMarblingScore.toFixed(1)),\r\n            bms: this.clamp(bms, 1, 12),\r\n            conformation: conf,\r\n            synergy_bonus_applied: options.synergyBonuses?.marbling || 0,\r\n            // Premium Logic: Conformation U/E/S AND Marbling (BMS) >= 5\r\n            is_premium: score >= 4 && bms >= 5\r\n        };\r\n    }\r\n};\r\n","\r\nexport interface Municipality {\r\n    municipio_id: string; // \"01051\"\r\n    provincia_id: string; // \"01\"\r\n    cmun: string;         // \"051\"\r\n    dc: string;           // \"3\"\r\n    nombre: string;       // \"Agurain/Salvatierra\"\r\n}\r\n\r\nexport interface Province {\r\n    code: string;\r\n    name: string;\r\n    community: string; // Autonomous Community\r\n}\r\n\r\nexport const SPANISH_PROVINCES: Province[] = [\r\n    { code: '01', name: 'Araba/√Ålava', community: 'Pa√≠s Vasco' },\r\n    { code: '02', name: 'Albacete', community: 'Castilla-La Mancha' },\r\n    { code: '03', name: 'Alicante/Alacant', community: 'Comunidad Valenciana' },\r\n    { code: '04', name: 'Almer√≠a', community: 'Andaluc√≠a' },\r\n    { code: '05', name: '√Åvila', community: 'Castilla y Le√≥n' },\r\n    { code: '06', name: 'Badajoz', community: 'Extremadura' },\r\n    { code: '07', name: 'Illes Balears', community: 'Illes Balears' },\r\n    { code: '08', name: 'Barcelona', community: 'Catalu√±a' },\r\n    { code: '09', name: 'Burgos', community: 'Castilla y Le√≥n' },\r\n    { code: '10', name: 'C√°ceres', community: 'Extremadura' },\r\n    { code: '11', name: 'C√°diz', community: 'Andaluc√≠a' },\r\n    { code: '12', name: 'Castell√≥n/Castell√≥', community: 'Comunidad Valenciana' },\r\n    { code: '13', name: 'Ciudad Real', community: 'Castilla-La Mancha' },\r\n    { code: '14', name: 'C√≥rdoba', community: 'Andaluc√≠a' },\r\n    { code: '15', name: 'A Coru√±a', community: 'Galicia' },\r\n    { code: '16', name: 'Cuenca', community: 'Castilla-La Mancha' },\r\n    { code: '17', name: 'Girona', community: 'Catalu√±a' },\r\n    { code: '18', name: 'Granada', community: 'Andaluc√≠a' },\r\n    { code: '19', name: 'Guadalajara', community: 'Castilla-La Mancha' },\r\n    { code: '20', name: 'Gipuzkoa', community: 'Pa√≠s Vasco' },\r\n    { code: '21', name: 'Huelva', community: 'Andaluc√≠a' },\r\n    { code: '22', name: 'Huesca', community: 'Arag√≥n' },\r\n    { code: '23', name: 'Ja√©n', community: 'Andaluc√≠a' },\r\n    { code: '24', name: 'Le√≥n', community: 'Castilla y Le√≥n' },\r\n    { code: '25', name: 'Lleida', community: 'Catalu√±a' },\r\n    { code: '26', name: 'La Rioja', community: 'La Rioja' },\r\n    { code: '27', name: 'Lugo', community: 'Galicia' },\r\n    { code: '28', name: 'Madrid', community: 'Comunidad de Madrid' },\r\n    { code: '29', name: 'M√°laga', community: 'Andaluc√≠a' },\r\n    { code: '30', name: 'Murcia', community: 'Regi√≥n de Murcia' },\r\n    { code: '31', name: 'Navarra', community: 'Comunidad Foral de Navarra' },\r\n    { code: '32', name: 'Ourense', community: 'Galicia' },\r\n    { code: '33', name: 'Asturias', community: 'Principado de Asturias' },\r\n    { code: '34', name: 'Palencia', community: 'Castilla y Le√≥n' },\r\n    { code: '35', name: 'Las Palmas', community: 'Canarias' },\r\n    { code: '36', name: 'Pontevedra', community: 'Galicia' },\r\n    { code: '37', name: 'Salamanca', community: 'Castilla y Le√≥n' },\r\n    { code: '38', name: 'Santa Cruz de Tenerife', community: 'Canarias' },\r\n    { code: '39', name: 'Cantabria', community: 'Cantabria' },\r\n    { code: '40', name: 'Segovia', community: 'Castilla y Le√≥n' },\r\n    { code: '41', name: 'Sevilla', community: 'Andaluc√≠a' },\r\n    { code: '42', name: 'Soria', community: 'Castilla y Le√≥n' },\r\n    { code: '43', name: 'Tarragona', community: 'Catalu√±a' },\r\n    { code: '44', name: 'Teruel', community: 'Arag√≥n' },\r\n    { code: '45', name: 'Toledo', community: 'Castilla-La Mancha' },\r\n    { code: '46', name: 'Valencia/Val√®ncia', community: 'Comunidad Valenciana' },\r\n    { code: '47', name: 'Valladolid', community: 'Castilla y Le√≥n' },\r\n    { code: '48', name: 'Bizkaia', community: 'Pa√≠s Vasco' },\r\n    { code: '49', name: 'Zamora', community: 'Castilla y Le√≥n' },\r\n    { code: '50', name: 'Zaragoza', community: 'Arag√≥n' },\r\n    { code: '51', name: 'Ceuta', community: 'Ceuta' },\r\n    { code: '52', name: 'Melilla', community: 'Melilla' }\r\n];\r\n\r\nexport const getProvinceName = (code: string) => SPANISH_PROVINCES.find(p => p.code === code)?.name || code;\r\n","import { createElement, forwardRef } from 'react';\nimport defaultAttributes from './defaultAttributes';\nimport { IconNode, LucideProps } from './types';\nimport { mergeClasses, hasA11yProp } from '@lucide/shared';\n\ninterface IconComponentProps extends LucideProps {\n  iconNode: IconNode;\n}\n\n/**\n * Lucide icon component\n *\n * @component Icon\n * @param {object} props\n * @param {string} props.color - The color of the icon\n * @param {number} props.size - The size of the icon\n * @param {number} props.strokeWidth - The stroke width of the icon\n * @param {boolean} props.absoluteStrokeWidth - Whether to use absolute stroke width\n * @param {string} props.className - The class name of the icon\n * @param {IconNode} props.children - The children of the icon\n * @param {IconNode} props.iconNode - The icon node of the icon\n *\n * @returns {ForwardRefExoticComponent} LucideIcon\n */\nconst Icon = forwardRef<SVGSVGElement, IconComponentProps>(\n  (\n    {\n      color = 'currentColor',\n      size = 24,\n      strokeWidth = 2,\n      absoluteStrokeWidth,\n      className = '',\n      children,\n      iconNode,\n      ...rest\n    },\n    ref,\n  ) =>\n    createElement(\n      'svg',\n      {\n        ref,\n        ...defaultAttributes,\n        width: size,\n        height: size,\n        stroke: color,\n        strokeWidth: absoluteStrokeWidth ? (Number(strokeWidth) * 24) / Number(size) : strokeWidth,\n        className: mergeClasses('lucide', className),\n        ...(!children && !hasA11yProp(rest) && { 'aria-hidden': 'true' }),\n        ...rest,\n      },\n      [\n        ...iconNode.map(([tag, attrs]) => createElement(tag, attrs)),\n        ...(Array.isArray(children) ? children : [children]),\n      ],\n    ),\n);\n\nexport default Icon;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0',\n      key: '1r0f0z',\n    },\n  ],\n  ['circle', { cx: '12', cy: '10', r: '3', key: 'ilqhr7' }],\n];\n\n/**\n * @component @name MapPin\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjAgMTBjMCA0Ljk5My01LjUzOSAxMC4xOTMtNy4zOTkgMTEuNzk5YTEgMSAwIDAgMS0xLjIwMiAwQzkuNTM5IDIwLjE5MyA0IDE0Ljk5MyA0IDEwYTggOCAwIDAgMSAxNiAwIiAvPgogIDxjaXJjbGUgY3g9IjEyIiBjeT0iMTAiIHI9IjMiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/map-pin\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst MapPin = createLucideIcon('map-pin', __iconNode);\n\nexport default MapPin;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z',\n      key: '1c8476',\n    },\n  ],\n  ['path', { d: 'M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7', key: '1ydtos' }],\n  ['path', { d: 'M7 3v4a1 1 0 0 0 1 1h7', key: 't51u73' }],\n];\n\n/**\n * @component @name Save\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTUuMiAzYTIgMiAwIDAgMSAxLjQuNmwzLjggMy44YTIgMiAwIDAgMSAuNiAxLjRWMTlhMiAyIDAgMCAxLTIgMkg1YTIgMiAwIDAgMS0yLTJWNWEyIDIgMCAwIDEgMi0yeiIgLz4KICA8cGF0aCBkPSJNMTcgMjF2LTdhMSAxIDAgMCAwLTEtMUg4YTEgMSAwIDAgMC0xIDF2NyIgLz4KICA8cGF0aCBkPSJNNyAzdjRhMSAxIDAgMCAwIDEgMWg3IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/save\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Save = createLucideIcon('save', __iconNode);\n\nexport default Save;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z',\n      key: '1a8usu',\n    },\n  ],\n];\n\n/**\n * @component @name Pen\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEuMTc0IDYuODEyYTEgMSAwIDAgMC0zLjk4Ni0zLjk4N0wzLjg0MiAxNi4xNzRhMiAyIDAgMCAwLS41LjgzbC0xLjMyMSA0LjM1MmEuNS41IDAgMCAwIC42MjMuNjIybDQuMzUzLTEuMzJhMiAyIDAgMCAwIC44My0uNDk3eiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/pen\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Pen = createLucideIcon('pen', __iconNode);\n\nexport default Pen;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384',\n      key: '9njp5v',\n    },\n  ],\n];\n\n/**\n * @component @name Phone\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTMuODMyIDE2LjU2OGExIDEgMCAwIDAgMS4yMTMtLjMwM2wuMzU1LS40NjVBMiAyIDAgMCAxIDE3IDE1aDNhMiAyIDAgMCAxIDIgMnYzYTIgMiAwIDAgMS0yIDJBMTggMTggMCAwIDEgMiA0YTIgMiAwIDAgMSAyLTJoM2EyIDIgMCAwIDEgMiAydjNhMiAyIDAgMCAxLS44IDEuNmwtLjQ2OC4zNTFhMSAxIDAgMCAwLS4yOTIgMS4yMzMgMTQgMTQgMCAwIDAgNi4zOTIgNi4zODQiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/phone\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Phone = createLucideIcon('phone', __iconNode);\n\nexport default Phone;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z',\n      key: 'oel41y',\n    },\n  ],\n];\n\n/**\n * @component @name Shield\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjAgMTNjMCA1LTMuNSA3LjUtNy42NiA4Ljk1YTEgMSAwIDAgMS0uNjctLjAxQzcuNSAyMC41IDQgMTggNCAxM1Y2YTEgMSAwIDAgMSAxLTFjMiAwIDQuNS0xLjIgNi4yNC0yLjcyYTEuMTcgMS4xNyAwIDAgMSAxLjUyIDBDMTQuNTEgMy44MSAxNyA1IDE5IDVhMSAxIDAgMCAxIDEgMXoiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/shield\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Shield = createLucideIcon('shield', __iconNode);\n\nexport default Shield;\n","\r\nexport interface Animal {\r\n    id: string;\r\n    crotal: string;\r\n    sex: string;\r\n    birthDate?: string; // or birth\r\n    birth?: string;\r\n    [key: string]: any;\r\n}\r\n\r\nexport type ReproductiveState = 'Vac√≠a' | 'Cubierta' | 'Gestante' | 'Postparto' | 'Inmadura';\r\n\r\nexport interface LifecycleAlert {\r\n    type: 'Destete' | 'Castraci√≥n' | 'Secado' | 'Parto Imminente';\r\n    date: string;\r\n    desc: string;\r\n    animalId: string;\r\n    isDue: boolean; // If today >= alert date\r\n}\r\n\r\nexport const LifecycleEngine = {\r\n    /**\r\n     * Helper: Calculate Age in Months from Birth Date string\r\n     */\r\n    getAgeInMonths(birthDateStr: string): number {\r\n        if (!birthDateStr) return 0; // or default?\r\n        const birth = new Date(birthDateStr);\r\n        const today = new Date();\r\n        const diffTime = Math.abs(today.getTime() - birth.getTime());\r\n        const diffMonths = diffTime / (1000 * 60 * 60 * 24 * 30.44);\r\n        return parseFloat(diffMonths.toFixed(1));\r\n    },\r\n\r\n    /**\r\n     * Determine Reproductive Status based on Event History\r\n     * State Machine: Inseminaci√≥n -> Cubierta -> Diagn√≥stico(+) -> Gestante -> Parto -> Postparto -> Vac√≠a\r\n     */\r\n    getReproductiveStatus(animal: Animal, events: any[]): { status: ReproductiveState, daysInState: number } {\r\n        if (animal.sex !== 'Hembra') return { status: 'Inmadura', daysInState: 0 };\r\n\r\n        // Sort events descending\r\n        const sortedEvents = [...events]\r\n            .filter(e => e.animalId === animal.id || e.animalCrotal === animal.crotal)\r\n            .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());\r\n\r\n        const lastParto = sortedEvents.find(e => e.type === 'Parto');\r\n        const lastInsem = sortedEvents.find(e => e.type === 'Inseminaci√≥n' || e.type === 'Monta');\r\n        const lastDiag = sortedEvents.find(e => e.type === 'Diagn√≥stico' || (e.type === 'Revisi√≥n' && e.desc.includes('Diagn√≥stico')));\r\n\r\n        const today = new Date();\r\n\r\n        // 1. Check PARTIALLY (Postparto)\r\n        if (lastParto) {\r\n            const partoDate = new Date(lastParto.date);\r\n            // Ignore older events pre-parto\r\n            if (lastInsem && new Date(lastInsem.date) < partoDate) {\r\n                // If Insem is older than Parto, it's from previous cycle. reset.\r\n                // unless there is a NEW insem.\r\n            }\r\n\r\n            // Time since parto\r\n            const daysPost = Math.floor((today.getTime() - partoDate.getTime()) / (1000 * 60 * 60 * 24));\r\n\r\n            // If no subsequent events, she is Postparto (active nulliparous logic excluded for simplicity)\r\n            const eventsSinceParto = sortedEvents.filter(e => new Date(e.date) > partoDate);\r\n            const newInsem = eventsSinceParto.find(e => e.type === 'Inseminaci√≥n');\r\n            const newDiag = eventsSinceParto.find(e => e.type === 'Diagn√≥stico');\r\n\r\n            if (!newInsem) {\r\n                if (daysPost < 45) return { status: 'Postparto', daysInState: daysPost }; // Voluntary Waiting Period\r\n                return { status: 'Vac√≠a', daysInState: daysPost };\r\n            }\r\n\r\n            // If Inseminated\r\n            if (newInsem) {\r\n                const daysInsem = Math.floor((today.getTime() - new Date(newInsem.date).getTime()) / (1000 * 60 * 60 * 24));\r\n\r\n                if (newDiag) {\r\n                    const isPos = newDiag.result === 'Positivo' || newDiag.desc.includes('Gesta') || newDiag.desc.includes('Pre√±a');\r\n                    if (isPos) return { status: 'Gestante', daysInState: daysInsem }; // Days since Insem = Gestation Days\r\n                    else return { status: 'Vac√≠a', daysInState: 0 }; // Failed\r\n                }\r\n\r\n                return { status: 'Cubierta', daysInState: daysInsem };\r\n            }\r\n        }\r\n\r\n        // Fallback for Heifers (Novillas) without Parto history\r\n        if (lastInsem) {\r\n            const daysInsem = Math.floor((today.getTime() - new Date(lastInsem.date).getTime()) / (1000 * 60 * 60 * 24));\r\n            if (lastDiag) {\r\n                const isPos = lastDiag.result === 'Positivo' || lastDiag.desc.includes('Gesta');\r\n                if (isPos) return { status: 'Gestante', daysInState: daysInsem };\r\n                return { status: 'Vac√≠a', daysInState: 0 };\r\n            }\r\n            return { status: 'Cubierta', daysInState: daysInsem };\r\n        }\r\n\r\n        return { status: 'Vac√≠a', daysInState: 0 };\r\n    },\r\n\r\n    /**\r\n     * Generate Alerts based on Age and Sex (Weaning, Castration)\r\n     */\r\n    getLifecycleAlerts(animal: Animal): LifecycleAlert[] {\r\n        const alerts: LifecycleAlert[] = [];\r\n        if (!animal.birthDate) return alerts;\r\n\r\n        const birth = new Date(animal.birthDate);\r\n        const today = new Date();\r\n        const ageMonths = (today.getTime() - birth.getTime()) / (1000 * 60 * 60 * 24 * 30.44);\r\n\r\n        // 1. WEANING (Destete) at 7 Months\r\n        const weaningDate = new Date(birth);\r\n        weaningDate.setDate(weaningDate.getDate() + (7 * 30));\r\n\r\n        // Alert window: 6.5 months to 7.5 months? Or just permanent if not weaned?\r\n        // Let's say if age is 6.5 - 8.0 and status is not \"Destetado\" (we don't check status yet, just advice)\r\n        if (ageMonths >= 6.5 && ageMonths <= 8) {\r\n            alerts.push({\r\n                type: 'Destete',\r\n                date: weaningDate.toISOString().split('T')[0],\r\n                desc: `Animal cumple 7 meses. Planificar destete.`,\r\n                animalId: animal.id,\r\n                isDue: today >= weaningDate\r\n            });\r\n        }\r\n\r\n        // 2. CASTRATION DECISION (Males) at 6 Months\r\n        if (animal.sex === 'Macho' && ageMonths >= 5.5 && ageMonths <= 7) {\r\n            const castDate = new Date(birth);\r\n            castDate.setDate(castDate.getDate() + (6 * 30));\r\n            alerts.push({\r\n                type: 'Castraci√≥n',\r\n                date: castDate.toISOString().split('T')[0],\r\n                desc: `Decisi√≥n Macho (6 meses): ¬øSemental o Buey?`,\r\n                animalId: animal.id,\r\n                isDue: today >= castDate\r\n            });\r\n        }\r\n\r\n        return alerts;\r\n    }\r\n};\r\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M16.4 13.7A6.5 6.5 0 1 0 6.28 6.6c-1.1 3.13-.78 3.9-3.18 6.08A3 3 0 0 0 5 18c4 0 8.4-1.8 11.4-4.3',\n      key: 'cisjcv',\n    },\n  ],\n  [\n    'path',\n    {\n      d: 'm18.5 6 2.19 4.5a6.48 6.48 0 0 1-2.29 7.2C15.4 20.2 11 22 7 22a3 3 0 0 1-2.68-1.66L2.4 16.5',\n      key: '5byaag',\n    },\n  ],\n  ['circle', { cx: '12.5', cy: '8.5', r: '2.5', key: '9738u8' }],\n];\n\n/**\n * @component @name Beef\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTYuNCAxMy43QTYuNSA2LjUgMCAxIDAgNi4yOCA2LjZjLTEuMSAzLjEzLS43OCAzLjktMy4xOCA2LjA4QTMgMyAwIDAgMCA1IDE4YzQgMCA4LjQtMS44IDExLjQtNC4zIiAvPgogIDxwYXRoIGQ9Im0xOC41IDYgMi4xOSA0LjVhNi40OCA2LjQ4IDAgMCAxLTIuMjkgNy4yQzE1LjQgMjAuMiAxMSAyMiA3IDIyYTMgMyAwIDAgMS0yLjY4LTEuNjZMMi40IDE2LjUiIC8+CiAgPGNpcmNsZSBjeD0iMTIuNSIgY3k9IjguNSIgcj0iMi41IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/beef\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Beef = createLucideIcon('beef', __iconNode);\n\nexport default Beef;\n","\r\nexport interface SoilType {\r\n    id: string;\r\n    name: string;\r\n    texture: string;\r\n    ph_typical: number;\r\n    water_retention: 'Baja' | 'Media' | 'Alta' | 'Media-Baja' | 'Media-Alta';\r\n    drainage: 'Lento' | 'Medio' | 'R√°pido' | 'Medio-Lento' | 'Medio-R√°pido';\r\n    risks: string[];\r\n    recommended_uses: string[];\r\n    productive_objectives: string[];\r\n    indices: {\r\n        retention: number;\r\n        drainage: number;\r\n        fertility: number;\r\n        risk_waterlogging: number;\r\n        risk_drought: number;\r\n        risk_erosion: number;\r\n    };\r\n}\r\n\r\nexport const SOIL_DATABASE: SoilType[] = [\r\n    {\r\n        id: '1',\r\n        name: 'Arcilloso',\r\n        texture: 'Arcillosa',\r\n        ph_typical: 6.0,\r\n        water_retention: 'Alta',\r\n        drainage: 'Lento',\r\n        risks: ['Encharcamiento', 'Agrietamiento en sequ√≠a'],\r\n        recommended_uses: ['Pradera permanente', 'Pastoreo controlado'],\r\n        productive_objectives: ['Cr√≠a extensiva', 'Doble prop√≥sito'],\r\n        indices: { retention: 0.90, drainage: 0.20, fertility: 0.80, risk_waterlogging: 0.90, risk_drought: 0.20, risk_erosion: 0.40 }\r\n    },\r\n    {\r\n        id: '2',\r\n        name: 'Arenoso',\r\n        texture: 'Arenosa',\r\n        ph_typical: 5.5,\r\n        water_retention: 'Baja',\r\n        drainage: 'R√°pido',\r\n        risks: ['Sequ√≠a', 'Lixiviaci√≥n de nutrientes', 'Erosi√≥n e√≥lica'],\r\n        recommended_uses: ['Cultivos de invierno', 'Pastoreo invernal'],\r\n        productive_objectives: ['Recr√≠a', 'Cebo ligero'],\r\n        indices: { retention: 0.30, drainage: 0.90, fertility: 0.40, risk_waterlogging: 0.10, risk_drought: 0.90, risk_erosion: 0.70 }\r\n    },\r\n    {\r\n        id: '3',\r\n        name: 'Franco (Loam)',\r\n        texture: 'Franca',\r\n        ph_typical: 6.5,\r\n        water_retention: 'Media',\r\n        drainage: 'Medio',\r\n        risks: ['Ninguno grave'],\r\n        recommended_uses: ['Policultivo', 'Ma√≠z forrajero', 'Alfalfa'],\r\n        productive_objectives: ['Engorde intensivo', 'Alto rendimiento'],\r\n        indices: { retention: 0.60, drainage: 0.60, fertility: 0.85, risk_waterlogging: 0.30, risk_drought: 0.30, risk_erosion: 0.30 }\r\n    },\r\n    {\r\n        id: '4',\r\n        name: 'Franco-Arcilloso',\r\n        texture: 'Franco-Arcillosa',\r\n        ph_typical: 6.8,\r\n        water_retention: 'Alta',\r\n        drainage: 'Medio-Lento',\r\n        risks: ['Compactaci√≥n'],\r\n        recommended_uses: ['Praderas de alto rendimiento', 'Cereales'],\r\n        productive_objectives: ['Leche', 'Cr√≠a intensiva'],\r\n        indices: { retention: 0.75, drainage: 0.45, fertility: 0.90, risk_waterlogging: 0.50, risk_drought: 0.20, risk_erosion: 0.40 }\r\n    },\r\n    {\r\n        id: '5',\r\n        name: 'Franco-Arenoso',\r\n        texture: 'Franco-Arenosa',\r\n        ph_typical: 6.2,\r\n        water_retention: 'Media-Baja',\r\n        drainage: 'R√°pido',\r\n        risks: ['Erosi√≥n', 'Lavado nutrientes'],\r\n        recommended_uses: ['Hort√≠colas', 'Leguminosas anuales'],\r\n        productive_objectives: ['Rotaci√≥n r√°pida', 'Pastoreo estacional'],\r\n        indices: { retention: 0.45, drainage: 0.80, fertility: 0.60, risk_waterlogging: 0.20, risk_drought: 0.70, risk_erosion: 0.50 }\r\n    }\r\n];\r\n\r\nexport const SoilEngine = {\r\n    getAllSoils(): SoilType[] {\r\n        return SOIL_DATABASE;\r\n    },\r\n\r\n    getSoilById(id: string): SoilType | undefined {\r\n        return SOIL_DATABASE.find(s => s.id === id);\r\n    },\r\n\r\n    /**\r\n     * Advanced Crop Recommendation Engine\r\n     */\r\n    getRecommendedCrops(soilId: string, climate?: { avgTemp: number; annualPrecip: number }, slope: number = 0): { crop: string; reason: string; type: string }[] {\r\n        const soil = this.getSoilById(soilId);\r\n        if (!soil) return [];\r\n\r\n        const recs: { crop: string; reason: string; type: string }[] = [];\r\n\r\n        // Database of Crops with requirements\r\n        const CROPS = [\r\n            // CEREALES (Invierno)\r\n            { name: 'Trigo Blando', type: 'Cereal Invierno', min_precip: 450, max_slope: 12, ph_min: 6.0, ph_max: 8.0, drainage: ['Medio', 'R√°pido', 'Medio-Lento'], season: 'Oto√±o' },\r\n            { name: 'Cebada', type: 'Cereal Invierno', min_precip: 350, max_slope: 12, ph_min: 6.0, ph_max: 8.5, drainage: ['Medio', 'R√°pido'], season: 'Oto√±o' },\r\n            { name: 'Avena', type: 'Cereal Invierno', min_precip: 400, max_slope: 15, ph_min: 5.0, ph_max: 7.5, drainage: ['Medio', 'Lento', 'Medio-Lento'], season: 'Oto√±o' },\r\n            { name: 'Triticale', type: 'Cereal Invierno', min_precip: 350, max_slope: 15, ph_min: 5.5, ph_max: 8.0, drainage: ['Medio', 'Medio-Lento'], season: 'Oto√±o' },\r\n            { name: 'Centeno', type: 'Cereal Invierno', min_precip: 300, max_slope: 15, ph_min: 5.0, ph_max: 8.0, drainage: ['R√°pido', 'Medio'], season: 'Oto√±o' },\r\n\r\n            // FORRAJES\r\n            { name: 'Ray-grass Italiano', type: 'Pradera', min_precip: 600, max_slope: 15, ph_min: 5.5, ph_max: 7.5, drainage: ['Medio', 'Lento', 'Medio-Lento'], season: 'Oto√±o' },\r\n            { name: 'Festuca Alta', type: 'Pradera', min_precip: 450, max_slope: 15, ph_min: 5.0, ph_max: 8.0, drainage: ['Lento', 'Medio-Lento', 'Medio'], season: 'Oto√±o' },\r\n            { name: 'Alfalfa', type: 'Leguminosa', min_precip: 500, max_slope: 10, ph_min: 6.2, ph_max: 8.2, drainage: ['R√°pido', 'Medio'], season: 'Primavera' }, // Muy sensible a encharcamiento\r\n            { name: 'Vezas', type: 'Leguminosa', min_precip: 350, max_slope: 15, ph_min: 5.5, ph_max: 8.0, drainage: ['R√°pido', 'Medio', 'Medio-Lento'], season: 'Oto√±o' },\r\n            { name: 'Tr√©bol Subterr√°neo', type: 'Leguminosa', min_precip: 400, max_slope: 20, ph_min: 5.0, ph_max: 6.5, drainage: ['Medio', 'R√°pido', 'Medio-Lento'], season: 'Oto√±o' },\r\n\r\n            // ESTIVALES\r\n            { name: 'Ma√≠z Forrajero', type: 'Cereal Verano', min_precip: 300, max_slope: 8, ph_min: 5.8, ph_max: 8.0, drainage: ['Medio', 'Medio-Lento'], season: 'Primavera' }, // Requires irrigation usually, low slope\r\n            { name: 'Sorgo', type: 'Cereal Verano', min_precip: 250, max_slope: 10, ph_min: 5.5, ph_max: 8.5, drainage: ['Medio', 'R√°pido'], season: 'Primavera' },\r\n        ];\r\n\r\n        for (const crop of CROPS) {\r\n            const reasons: string[] = [];\r\n            let valid = true;\r\n\r\n            // 1. Slope Check (Strict)\r\n            if (slope > crop.max_slope) {\r\n                // If slope is high, reject most crops.\r\n                // Strict check: User said 20% is huge. Keep machinery crops < 12-15%.\r\n                valid = false;\r\n            }\r\n\r\n            // 2. pH Check\r\n            if (soil.ph_typical < crop.ph_min || soil.ph_typical > crop.ph_max) {\r\n                valid = false;\r\n            }\r\n\r\n            // 3. Drainage Check\r\n            // We map strict \"Arcilloso\" -> Lento. \"Arenoso\" -> R√°pido.\r\n            // Check if soil drainage is in accepted list\r\n            if (!crop.drainage.includes(soil.drainage)) {\r\n                valid = false;\r\n            }\r\n\r\n            // 4. Climate Check\r\n            if (climate) {\r\n                // Precip check (Assuming rainfed logic primarily, but Ma√≠z/Sorgo might be irrigated)\r\n                // If precipitation is way too low (< min_precip - 200), hard fail.\r\n                // If it's close, maybe warn. Here we do simple check.\r\n                if (climate.annualPrecip < crop.min_precip && crop.name !== 'Ma√≠z Forrajero') {\r\n                    // Allow Ma√≠z assuming irrigation potential if not strict rainfed mode\r\n                    // But for this logic, let's be strict on rainfed for now unless specified.\r\n                    // Actually let's assume if it is \"Cereal Verano\", user might irrigate, but let's stick to rainfed min logic.\r\n                    if (climate.annualPrecip < crop.min_precip * 0.7) valid = false; // Tolerance\r\n                }\r\n            }\r\n\r\n            if (valid) {\r\n                // Generate friendly reason\r\n                if (slope > 8 && slope <= crop.max_slope) reasons.push(\"Pendiente l√≠mite\");\r\n                if (climate && climate.annualPrecip > crop.min_precip + 200) reasons.push(\"Clima favorable\");\r\n\r\n                // Add specific soil reasons\r\n                if (crop.name === 'Alfalfa' && soil.drainage === 'R√°pido') reasons.push(\"Excelente drenaje\");\r\n                if (crop.name === 'Festuca Alta' && (soil.drainage === 'Lento' || soil.drainage === 'Medio-Lento')) reasons.push(\"Tolera suelo pesado\");\r\n\r\n                recs.push({\r\n                    crop: crop.name,\r\n                    type: `${crop.type} (${crop.season})`,\r\n                    reason: reasons.length ? reasons.join('. ') : 'Condiciones aptas.'\r\n                });\r\n            }\r\n        }\r\n\r\n        // Special Case: High Slope (> 15%)\r\n        if (slope > 15) {\r\n            // Only hardy pastures or trees (not implemented yet).\r\n            // Explicitly recommend \"Pastos Permanentes\" or \"Reforestaci√≥n\" if not already covered.\r\n            recs.push({ crop: 'Prado Natural', type: 'Pradera', reason: 'Pendiente alta: evitar laboreo.' });\r\n        }\r\n\r\n        return recs;\r\n    },\r\n\r\n    /**\r\n     * Calculate Suitability Score (0-100) for a given Objective\r\n     */\r\n    calculateSuitability(soilId: string, objective: 'Pastoreo' | 'Cultivo' | 'Engorde'): number {\r\n        const soil = this.getSoilById(soilId);\r\n        if (!soil) return 0;\r\n        const i = soil.indices;\r\n\r\n        if (objective === 'Pastoreo') {\r\n            // Needs resilience (trampling) -> Good drainage prevents mud, but need retention for grass\r\n            // Balanced: Retention * 0.4 + Drainage * 0.4 + Fertility * 0.2\r\n            let score = (i.retention * 40) + (i.drainage * 40) + (i.fertility * 20);\r\n            if (i.risk_waterlogging > 0.7) score -= 20; // Mud risk\r\n            return Math.min(100, Math.max(0, score));\r\n        }\r\n\r\n        if (objective === 'Cultivo') {\r\n            // Needs Fertility and Structure\r\n            return Math.min(100, (i.fertility * 60) + (i.drainage * 20) + (i.retention * 20));\r\n        }\r\n\r\n        if (objective === 'Engorde') {\r\n            // Indirect: How good is it for producing high quality feed? Similar to Cultivo\r\n            return Math.min(100, (i.fertility * 70) + (i.drainage * 30));\r\n        }\r\n\r\n        return 50;\r\n    }\r\n};\r\n","import { CarcassQualityEngine } from './carcassQualityEngine';\r\nimport { BreedManager } from './breedManager';\r\nimport { WeightEngine } from './weightEngine';\r\nimport { NutritionEngine } from './nutritionEngine';\r\n\r\nexport interface EventData {\r\n    type: string;\r\n    date: string;\r\n    [key: string]: any;\r\n}\r\n\r\nexport interface EventContext {\r\n    animals: any[];\r\n    events: any[];\r\n    currentUser: string;\r\n    storage: {\r\n        read: <T>(key: string, fallback: T) => T;\r\n        write: <T>(key: string, value: T) => void;\r\n    };\r\n    getFincas?: () => any[];\r\n}\r\n\r\nexport const EventManager = {\r\n    generateUUID() {\r\n        if (typeof crypto !== 'undefined' && crypto.randomUUID) {\r\n            try { return crypto.randomUUID(); } catch (e) { }\r\n        }\r\n        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n            var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n            return v.toString(16);\r\n        });\r\n    },\r\n\r\n    async handleSaneamiento(data: any, context: EventContext) {\r\n        const { result, infectedCrotalsText, date, farmId } = data;\r\n        const { animals, events, currentUser, storage, getFincas } = context;\r\n\r\n        const fincas = getFincas ? getFincas() : [];\r\n        const farm = fincas.find((f: any) => f.id === farmId);\r\n        const farmName = farm ? farm.name : 'Finca Desconocida';\r\n\r\n        // Filter herd\r\n        const herdAnimals = animals.filter((a: any) =>\r\n            (a.farmId === farmId || a.farm === farmName) &&\r\n            a.status !== 'Muerto' && a.status !== 'Vendido' && a.status !== 'Sacrificado'\r\n        );\r\n\r\n        if (herdAnimals.length === 0) throw new Error('No hay animales activos en esta finca.');\r\n\r\n        let desc = '';\r\n        let infectedCount = 0;\r\n\r\n        if (result === 'Negativo') {\r\n            herdAnimals.forEach((a: any) => {\r\n                a.healthStatus = 'Sano';\r\n                if (!a.status) a.status = 'Activo';\r\n            });\r\n            desc = 'Saneamiento NEGATIVO. Todo el reba√±o declarado SANO.';\r\n        } else if (result === 'Positivo') {\r\n            const infectedCrotals = (infectedCrotalsText || '').split(',').map((s: string) => s.trim().toUpperCase()).filter((s: string) => s);\r\n            if (infectedCrotals.length === 0) throw new Error('Has indicado POSITIVO. Introduce los crotales infectados.');\r\n\r\n            herdAnimals.forEach((a: any) => {\r\n                const isPositive = infectedCrotals.some((ic: string) => (a.crotal || '').toUpperCase().endsWith(ic));\r\n\r\n                if (isPositive) {\r\n                    a.healthStatus = 'Tuberculosis+';\r\n                    a.status = 'Sacrificado';\r\n                    a.exitDate = date;\r\n                    a.actualPrice = 0;\r\n                    a.actualCarcassWeight = 0;\r\n                    a.deathReason = 'Saneamiento Positivo';\r\n                    infectedCount++;\r\n\r\n                    events.push({\r\n                        id: this.generateUUID(),\r\n                        type: 'Sacrificio',\r\n                        date: date,\r\n                        animalId: a.id,\r\n                        animalCrotal: a.crotal,\r\n                        desc: 'Sacrificio Obligatorio (Saneamiento+)',\r\n                        cost: 0,\r\n                        createdAt: new Date().toISOString()\r\n                    });\r\n\r\n                } else {\r\n                    a.healthStatus = 'Cuarentena';\r\n                }\r\n            });\r\n\r\n            desc = `Saneamiento POSITIVO en ${farmName}. ${infectedCount} sacrificados. Resto (${herdAnimals.length - infectedCount}) en CUARENTENA.`;\r\n\r\n            const checkDate = new Date(date);\r\n            checkDate.setDate(checkDate.getDate() + 15);\r\n\r\n            events.push({\r\n                id: this.generateUUID(),\r\n                type: 'Revisi√≥n Cuarentena',\r\n                date: checkDate.toISOString().split('T')[0],\r\n                animalId: herdAnimals[0].id,\r\n                animalCrotal: `${farmName} (REBA√ëO)`,\r\n                desc: `‚ö†Ô∏è Revisi√≥n Cuarentena: ${farmName} (15 d√≠as post-positivo)`,\r\n                actionRequired: 'Saneamiento',\r\n                status: 'scheduled',\r\n                createdAt: new Date().toISOString()\r\n            });\r\n        }\r\n\r\n        events.push({\r\n            id: this.generateUUID(),\r\n            type: 'Saneamiento',\r\n            date: date,\r\n            animalId: herdAnimals[0] ? herdAnimals[0].id : 'FARM_EVENT',\r\n            animalCrotal: `${farmName} (General)`,\r\n            desc: desc,\r\n            completed: true,\r\n            status: 'completed',\r\n            createdAt: new Date().toISOString()\r\n        });\r\n\r\n        storage.write(`animals_${currentUser}`, animals);\r\n        storage.write('events', events);\r\n        return { message: 'Saneamiento procesado correctamente.', events, animals };\r\n    },\r\n\r\n    async handleInsemination(data: any, context: EventContext) {\r\n        const { animal, date, bullBreed, desc } = data;\r\n        const { events, storage } = context;\r\n\r\n        let breedInfo = bullBreed ? ` Toro: ${bullBreed}.` : '';\r\n\r\n        const mainId = this.generateUUID();\r\n        const mainEvent = {\r\n            id: mainId,\r\n            type: 'Inseminaci√≥n',\r\n            animalId: animal.id,\r\n            animalCrotal: animal.crotal,\r\n            date: date,\r\n            desc: `Inicio Protocolo IA (D√≠a 0): Evaluaci√≥n + GnRH 1.${breedInfo} ${desc || ''}`,\r\n            cost: 0,\r\n            status: 'completed',\r\n            createdAt: new Date().toISOString()\r\n        };\r\n        events.push(mainEvent);\r\n\r\n        const protocolSteps = [\r\n            { day: 7, type: 'Tratamiento', desc: 'Protocolo IA (D√≠a 7): Prostaglandina (PGF2a)' },\r\n            { day: 9, type: 'Tratamiento', desc: 'Protocolo IA (D√≠a 9): GnRH 2¬™ dosis' },\r\n            { day: 10, type: 'Inseminaci√≥n', desc: `Protocolo IA (D√≠a 10): IA a Tiempo Fijo (16-20h tras GnRH).${breedInfo}` },\r\n            { day: 35, type: 'Revisi√≥n', desc: 'Protocolo IA (D√≠a 35): Ecograf√≠a (Diagn√≥stico Gestaci√≥n)' },\r\n            { day: 60, type: 'Revisi√≥n', desc: 'Protocolo IA (D√≠a 60): Confirmaci√≥n Viabilidad' }\r\n        ];\r\n\r\n        protocolSteps.forEach(step => {\r\n            const stepDate = new Date(date);\r\n            stepDate.setDate(stepDate.getDate() + step.day);\r\n\r\n            events.push({\r\n                id: this.generateUUID(),\r\n                type: step.type,\r\n                animalId: animal.id,\r\n                animalCrotal: animal.crotal,\r\n                date: stepDate.toISOString().split('T')[0],\r\n                desc: step.desc,\r\n                cost: 0,\r\n                status: 'scheduled',\r\n                createdAt: new Date().toISOString()\r\n            });\r\n        });\r\n\r\n        storage.write('events', events);\r\n        return { message: 'Protocolo de Inseminaci√≥n iniciado (5 eventos programados).', events };\r\n    },\r\n\r\n    async handleWeighing(data: any, context: EventContext) {\r\n        const { animal, weight, date, notes } = data;\r\n        const { events, animals, currentUser, storage } = context;\r\n\r\n        const prevWeight = animal.currentWeight || 0;\r\n        animal.currentWeight = weight;\r\n\r\n        // Calculate Estimates\r\n        const animalEvents = events.filter((e: any) => e.animalId === animal.id && e.type === 'Pesaje');\r\n        animalEvents.sort((a: any, b: any) => new Date(b.date).getTime() - new Date(a.date).getTime());\r\n        const lastEvent = animalEvents[0];\r\n\r\n        let lastDate = lastEvent ? new Date(lastEvent.date) : new Date(animal.birthDate);\r\n        let lastW = lastEvent ? (lastEvent.weight || prevWeight) : (animal.birthWeight || 0);\r\n\r\n        if (!lastEvent && prevWeight > 0) lastW = prevWeight;\r\n\r\n        const curDate = new Date(date);\r\n        const daysDiff = (curDate.getTime() - lastDate.getTime()) / (1000 * 60 * 60 * 24);\r\n\r\n        let adgObs = 1.0;\r\n        if (daysDiff > 0 && weight > lastW) {\r\n            adgObs = (weight - lastW) / daysDiff;\r\n        }\r\n\r\n        // Recuperar Raza y Sistema Real\r\n        const weatherTemp = 20;\r\n        const thi = CarcassQualityEngine.calculateTHI(weatherTemp, 50);\r\n        const breed = BreedManager.getBreedByName(animal.breed);\r\n        const system = WeightEngine.inferSystem(animal);\r\n\r\n        // Calcular par√°metros nutricionales reales (Targets)\r\n        const ageInMonthsForTargets = (curDate.getTime() - new Date(animal.birthDate).getTime()) / (1000 * 60 * 60 * 24 * 30.44);\r\n\r\n        const bioTypeMap: Record<string, string> = {\r\n            'British': 'infiltracion',\r\n            'Continental': 'crecimiento_magro',\r\n            'Rustic_European': 'rustica_adaptada',\r\n            'Dairy': 'aptitud_lechera',\r\n            'Indicus': 'rustica_adaptada',\r\n            'Composite': 'composito'\r\n        };\r\n        const fType = (breed && bioTypeMap[breed.biological_type]) || 'rustica_adaptada';\r\n\r\n        const kpiTargets = NutritionEngine.calculateKPITargets({\r\n            breed: animal.breed,\r\n            sex: animal.sex,\r\n            weight: weight,\r\n            ageMonths: ageInMonthsForTargets,\r\n            functionalType: fType\r\n        }, 'Engorde', system);\r\n\r\n        const dietE = kpiTargets.energyDensity;\r\n\r\n        // Opciones de Calidad (Bellota, etc)\r\n        const monthOfYear = curDate.getMonth();\r\n        const isBellotaSeason = [9, 10, 11, 0, 1].includes(monthOfYear);\r\n        const isMontanera = system.includes('Montanera');\r\n\r\n        const qualityOptions = {\r\n            isBellota: isMontanera && isBellotaSeason,\r\n            highOleic: isMontanera && isBellotaSeason && (animal.farm || '').includes('SOTO'),\r\n            hasLecithin: isMontanera // Asumimos protocolo Montanera (Bellota + Soja)\r\n        };\r\n\r\n        const ageMonths = ageInMonthsForTargets;\r\n\r\n        // Estimaciones\r\n        const carcass = CarcassQualityEngine.estimateCarcassResult({ ageMonths /*, system */ }, weight, adgObs, dietE, thi, breed || {});\r\n        const quality = CarcassQualityEngine.calculateQualityIndex(\r\n            { ageMonths, currentWeight: weight, sex: animal.sex, rc_percent: carcass.rc_percent },\r\n            breed || {},\r\n            dietE,\r\n            adgObs,\r\n            thi,\r\n            150, // D√≠as en cebo estandar (estimado)\r\n            0,\r\n            1,\r\n            qualityOptions\r\n        );\r\n\r\n        if (!animal.monthlyRecords) animal.monthlyRecords = [];\r\n        animal.monthlyRecords.push({\r\n            date: date,\r\n            weightKg: weight,\r\n            adg: adgObs,\r\n            rc_est: carcass.rc_percent,\r\n            carcass_weight_est: carcass.carcass_weight,\r\n            meat_quality_index: quality.iq_score,\r\n            marbling_est: quality.marbling_est,\r\n            diet_energy: dietE,\r\n            thi: thi\r\n        });\r\n\r\n        // LIMIT HISTORY SIZE: Keep last 12 months only to prevent Storage Quota Errors\r\n        if (animal.monthlyRecords.length > 12) {\r\n            animal.monthlyRecords = animal.monthlyRecords.slice(-12);\r\n        }\r\n\r\n        // Schedule Next\r\n        const nextWeighDate = new Date(date);\r\n        nextWeighDate.setDate(nextWeighDate.getDate() + 30);\r\n\r\n        events.push({\r\n            id: this.generateUUID(),\r\n            type: 'Pesaje',\r\n            animalId: animal.id,\r\n            animalCrotal: animal.crotal,\r\n            date: nextWeighDate.toISOString().split('T')[0],\r\n            desc: 'CONTROL MENSUAL AUTOM√ÅTICO',\r\n            cost: 0,\r\n            status: 'pending',\r\n            createdAt: new Date().toISOString()\r\n        });\r\n\r\n        // Main Event\r\n        events.push({\r\n            id: this.generateUUID(),\r\n            type: 'Pesaje',\r\n            animalId: animal.id,\r\n            animalCrotal: animal.crotal,\r\n            date: date,\r\n            desc: `Pesaje: ${weight.toFixed(2)}kg. ${notes || ''}`,\r\n            weight: weight, // Important to store weight in event\r\n            cost: 0,\r\n            status: 'completed',\r\n            createdAt: new Date().toISOString()\r\n        });\r\n\r\n        storage.write(`animals_${currentUser}`, animals);\r\n        storage.write('events', events);\r\n        return { message: 'Pesaje registrado y pr√≥xima revisi√≥n programada.', events, animals };\r\n    },\r\n\r\n    async handleStandardEvent(data: any, context: EventContext) {\r\n        const { type, animal, date, desc, cost, nextDate, typeData } = data;\r\n        const { events, animals, storage, currentUser } = context;\r\n\r\n        if (['Sacrificio', 'Venta', 'Muerte/Sacrificio', 'Salida'].includes(type) || type.startsWith('Sacrificio')) {\r\n            const {\r\n                category, carcassWeight, price, conf, fat,\r\n                pricePerKg, liveWeight, yield: yieldVal, seuropConf, fatCover\r\n            } = typeData || {};\r\n\r\n            // Determine Status\r\n            if (type.includes('Sacrificio')) animal.status = 'Sacrificado';\r\n            else if (type === 'Venta') animal.status = 'Vendido';\r\n            else if (type === 'Muerte') animal.status = 'Muerto';\r\n            else animal.status = 'Baja'; // Generic fallback\r\n\r\n            animal.exitDate = date;\r\n\r\n            // Map Commercial Data\r\n            if (category) animal.actualCategory = category;\r\n\r\n            // Weights & Yield\r\n            if (carcassWeight) animal.actualCarcassWeight = parseFloat(carcassWeight);\r\n            if (liveWeight) animal.actualLiveWeight = parseFloat(liveWeight);\r\n            if (yieldVal) animal.actualYield = parseFloat(yieldVal);\r\n\r\n            // Pricing\r\n            if (price) animal.actualPrice = parseFloat(price);\r\n            if (pricePerKg) animal.actualPricePerKg = parseFloat(pricePerKg);\r\n            else if (price && carcassWeight) animal.actualPricePerKg = parseFloat((parseFloat(price) / parseFloat(carcassWeight)).toFixed(2));\r\n\r\n            // Quality\r\n            if (conf || seuropConf) animal.actualSeuropConf = conf || seuropConf;\r\n            if (fat || fatCover) animal.actualSeuropFat = fat || fatCover;\r\n\r\n            storage.write(`animals_${currentUser}`, animals);\r\n        }\r\n        else if (type === 'Cambio de corral') {\r\n            const { newCorralId } = typeData || {};\r\n            animal.corral = parseInt(newCorralId);\r\n            storage.write(`animals_${currentUser}`, animals);\r\n        }\r\n        else if (type === 'Decisi√≥n Macho') {\r\n            const { decision } = typeData || {};\r\n            if (decision === 'Castrado') {\r\n                animal.sex = 'Castrado';\r\n\r\n                // Logic: Castration must be between 6 and 9 months to be 'Buey'\r\n                const birth = new Date(animal.birth || animal.birthDate);\r\n                const eventDate = new Date(date);\r\n                const ageMonths = (eventDate.getTime() - birth.getTime()) / (1000 * 60 * 60 * 24 * 30.44);\r\n\r\n                if (ageMonths >= 6 && ageMonths <= 9) {\r\n                    animal.category = 'Buey';\r\n                } else if (ageMonths > 9) {\r\n                    animal.category = 'Toro'; // Late castration -> Toro\r\n                } else {\r\n                    animal.category = 'Ternero Castrado'; // Early castration\r\n                }\r\n\r\n                // Store castration date reference if possible, or just rely on event history\r\n                animal.castrationDate = date;\r\n\r\n            } else if (decision === 'Semental') {\r\n                animal.sex = 'Macho';\r\n                animal.category = 'Semental';\r\n                animal.isBreeder = true;\r\n            }\r\n            storage.write(`animals_${currentUser}`, animals);\r\n        }\r\n        else if (type === 'Parto') {\r\n            const { calfCrotal, calfSex, fatherCrotal, birthWeight } = typeData || {};\r\n            const newCalf = {\r\n                id: this.generateUUID(),\r\n                crotal: calfCrotal,\r\n                farmId: animal.farmId,\r\n                farm: animal.farm,\r\n                breed: animal.breed || 'Desconocida',\r\n                sex: calfSex,\r\n                father: fatherCrotal,\r\n                mother: animal.crotal,\r\n                birthDate: date.split('T')[0],\r\n                birthWeight: birthWeight,\r\n                currentWeight: birthWeight,\r\n                notes: `Nacido de ${animal.crotal}`,\r\n                createdAt: new Date().toISOString()\r\n            };\r\n            animals.push(newCalf);\r\n            storage.write(`animals_${currentUser}`, animals);\r\n\r\n            const weighDate = new Date();\r\n            weighDate.setDate(weighDate.getDate() + 30);\r\n            events.push({\r\n                id: this.generateUUID(),\r\n                type: 'Pesaje',\r\n                animalId: newCalf.id,\r\n                animalCrotal: newCalf.crotal,\r\n                date: weighDate.toISOString().split('T')[0],\r\n                desc: 'CONTROL MENSUAL (1er Mes)',\r\n                cost: 0,\r\n                status: 'pending',\r\n                createdAt: new Date().toISOString()\r\n            });\r\n        }\r\n\r\n        events.push({\r\n            id: this.generateUUID(),\r\n            type,\r\n            animalId: animal.id,\r\n            animalCrotal: animal.crotal,\r\n            date,\r\n            desc,\r\n            cost,\r\n            nextDate,\r\n            completed: type !== 'Parto' && type !== 'Pesaje',\r\n            status: 'completed',\r\n            createdAt: new Date().toISOString()\r\n        });\r\n\r\n        storage.write('events', events);\r\n        return { message: 'Evento registrado correctamente.', events, animals };\r\n    },\r\n\r\n    getUpcomingEvents(events: any[], days: number = 30) {\r\n        if (!events || !Array.isArray(events)) return [];\r\n\r\n        const now = new Date();\r\n        const future = new Date();\r\n        future.setDate(future.getDate() + days);\r\n\r\n        return events.filter(e => {\r\n            if (e.status === 'completed' || e.completed) return false;\r\n            const d = new Date(e.date);\r\n            return d >= now && d <= future;\r\n        }).sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime());\r\n    }\r\n};\r\n","import { AppConfig } from './appConfig';\r\nimport { Breed } from './breedManager';\r\n\r\ninterface AnimalInput {\r\n    ageMonths?: number;\r\n    weight?: number;\r\n    currentWeight?: number;\r\n    system?: string;\r\n    breed_name?: string;\r\n    rc_percent?: number;\r\n    sex?: string;\r\n}\r\n\r\ninterface QualityOptions {\r\n    isBellota?: boolean;\r\n    highOleic?: boolean;\r\n    hasLecithin?: boolean;\r\n}\r\n\r\ninterface CarcassEstResult {\r\n    rc_est: number;\r\n    rc_percent: number;\r\n    carcass_weight: number;\r\n}\r\n\r\nexport const CarcassQualityEngine = {\r\n    // Helper: Clamp\r\n    clamp(x: number, min: number, max: number) {\r\n        return Math.max(min, Math.min(max, x));\r\n    },\r\n\r\n    // Helper: Normalize 0-1\r\n    normalize(x: number, min: number, max: number) {\r\n        if (max === min) return 0;\r\n        return this.clamp((x - min) / (max - min), 0, 1);\r\n    },\r\n\r\n    calculateTHI(tempC: number, rhPercent: number) {\r\n        if (tempC === null || tempC === undefined) return 0;\r\n        const rh = (rhPercent === null || rhPercent === undefined) ? 50 : rhPercent;\r\n        const tf = (1.8 * tempC) + 32;\r\n        const thi = tf - (0.55 - 0.0055 * rh) * (tf - 58);\r\n        return thi;\r\n    },\r\n\r\n    estimateCarcassResult(animal: AnimalInput, currentWeight: number, adgObs: number, dietEnergy: number, thi: number, breedData: any): CarcassEstResult {\r\n        const C = AppConfig.carcass.rc_adjust;\r\n\r\n        // Base RC\r\n        let rcBase = parseFloat(breedData.yield_potential || breedData.rc_base);\r\n        if (isNaN(rcBase)) {\r\n            const sys = (animal.system || 'Intensivo').toLowerCase();\r\n            if (sys.includes('pastoreo')) rcBase = AppConfig.carcass.defaults.rc_grazing;\r\n            else if (sys.includes('mixto')) rcBase = AppConfig.carcass.defaults.rc_mixed;\r\n            else rcBase = AppConfig.carcass.defaults.rc_feedlot;\r\n        }\r\n\r\n        // Indices\r\n        const ageMonths = animal.ageMonths || 12;\r\n        const idxAge = this.normalize(ageMonths, C.age_ref_start_months, C.age_ref_end_months);\r\n        const idxEnergy = this.normalize(dietEnergy, C.EN_min, C.EN_max);\r\n\r\n        // ADG Ratio\r\n        let adgPred = parseFloat(breedData.adg_feedlot || '1.2');\r\n        if (adgPred === 0) adgPred = 1.2;\r\n        const ratioAdg = adgObs / adgPred;\r\n        const idxAdg = this.normalize(ratioAdg, C.adg_ratio_min, C.adg_ratio_max);\r\n\r\n        // Stress\r\n        const idxStress = this.normalize(thi, C.THI_threshold, C.THI_max);\r\n\r\n        // Delta\r\n        const deltaRc = (C.w_age * idxAge) +\r\n            (C.w_energy * idxEnergy) +\r\n            (C.w_adg * idxAdg) +\r\n            (C.w_stress * idxStress);\r\n\r\n        // Limits\r\n        const minRc = parseFloat(breedData.rc_min) || 0.54;\r\n        const maxRc = parseFloat(breedData.rc_max) || 0.66;\r\n\r\n        const rcEst = this.clamp(rcBase + deltaRc, minRc, maxRc);\r\n        const cwEst = currentWeight * rcEst;\r\n\r\n        return {\r\n            rc_est: parseFloat(rcEst.toFixed(4)),\r\n            rc_percent: parseFloat((rcEst * 100).toFixed(2)),\r\n            carcass_weight: parseFloat(cwEst.toFixed(1))\r\n        };\r\n    },\r\n\r\n    calculateQualityIndex(animal: AnimalInput, breedData: any, dietEnergy: number, adgObs: number, thi: number, daysOnFinishing: number, dietStability: number, healthStatus: number, options: QualityOptions = {}) {\r\n        const params = {\r\n            nei_min: breedData.nei_min || 12,\r\n            nei_max: breedData.nei_max || 18,\r\n            dof_min: breedData.dof_min || 90,\r\n            dof_max: breedData.dof_max || 200,\r\n            adg_min: breedData.adg_min_quality || 0.6,\r\n            adg_max: breedData.adg_max_quality || 1.4,\r\n            thi_comfort: breedData.thi_comfort || 72,\r\n            thi_max: breedData.thi_max || 84,\r\n            changes_limit: breedData.changes_30d_limit || 4,\r\n            weights: breedData.weights || {\r\n                w_dof: 1.0, w_nei: 1.0, w_conc: 0.6, w_adg: 0.8,\r\n                w_heat: 1.0, w_stab: 0.8, w_health: 0.7, z0: 1.0, k: 3.0\r\n            }\r\n        };\r\n\r\n        const W = params.weights;\r\n\r\n        // Normalization\r\n        const currentWeight = animal.weight || animal.currentWeight || 500;\r\n        const dmiPct = breedData.dmi_pct_pv || 0.021;\r\n        const estimatedNEI = dietEnergy * (currentWeight * dmiPct);\r\n\r\n        const NEI_n = this.normalize(estimatedNEI, params.nei_min, params.nei_max);\r\n        const DOF_n = this.normalize(daysOnFinishing, params.dof_min, params.dof_max);\r\n        const ADG_n = this.normalize(adgObs, params.adg_min, params.adg_max);\r\n        const Conc_n = NEI_n; // Proxy\r\n\r\n        // Penalties\r\n        const HeatPenalty = this.clamp((thi - params.thi_comfort) / (params.thi_max - params.thi_comfort), 0, 1);\r\n        const StabilityPenalty = this.clamp(dietStability / params.changes_limit, 0, 1);\r\n        const HealthPenalty = this.clamp(healthStatus, 0, 1);\r\n\r\n        // Z-Score\r\n        const Z = (W.w_dof * DOF_n) +\r\n            (W.w_nei * NEI_n) +\r\n            (W.w_conc * Conc_n) +\r\n            (W.w_adg * ADG_n) -\r\n            (W.w_heat * HeatPenalty) -\r\n            (W.w_stab * StabilityPenalty) -\r\n            (W.w_health * HealthPenalty) -\r\n            W.z0;\r\n\r\n        // Sigmoid Score\r\n        const MarblingScore_100 = 100 / (1 + Math.exp(-W.k * Z));\r\n\r\n        // Outputs\r\n        const MaxPotential = parseFloat(breedData.marbling_potential) || 3;\r\n        let Marbling_1_5 = this.clamp(1 + (MarblingScore_100 / 100) * (MaxPotential - 1), 1, MaxPotential);\r\n\r\n        // Synergy\r\n        const isBellota = options && (options.isBellota || options.highOleic);\r\n        const hasLecithin = options && options.hasLecithin;\r\n\r\n        if (isBellota && hasLecithin) {\r\n            let synergyBonus = 0.25;\r\n            // Is Ox check approximation\r\n            // Is Ox check (Castrado or Old Bull)\r\n            if ((animal.sex === 'Macho' || animal.sex === 'Castrado') && (animal.ageMonths || 0) > 30) synergyBonus = 0.6;\r\n            Marbling_1_5 += synergyBonus;\r\n        }\r\n\r\n        Marbling_1_5 = this.clamp(Marbling_1_5, 1, 5);\r\n\r\n        // BMS\r\n        const BMS_1_12 = this.clamp(1 + (Marbling_1_5 - 1) * 2.75, 1, 12);\r\n        const isPremium = Marbling_1_5 >= 4.2;\r\n\r\n        return {\r\n            iq_score: parseFloat(MarblingScore_100.toFixed(1)),\r\n            marbling_est: parseFloat(Marbling_1_5.toFixed(1)),\r\n            bms_est: parseFloat(BMS_1_12.toFixed(1)),\r\n            conformation_est: this.estimateConformation(animal.rc_percent || 55),\r\n            is_premium: isPremium\r\n        };\r\n    },\r\n\r\n    isFinishingDiet(dietEnergy: number, concentrateRatio: number) {\r\n        const R = AppConfig.quality.finishing_rule;\r\n        return (dietEnergy >= R.EN_finish_threshold) || (concentrateRatio >= R.concentrate_share_threshold);\r\n    },\r\n\r\n    estimateConformation(yieldPct: number) {\r\n        if (!yieldPct) return 'R';\r\n        if (yieldPct >= 64) return 'S';\r\n        if (yieldPct >= 62) return 'E';\r\n        if (yieldPct >= 60) return 'U';\r\n        if (yieldPct >= 57) return 'R';\r\n        if (yieldPct >= 54) return 'O';\r\n        return 'P';\r\n    }\r\n};\r\n","\r\nexport interface Breed {\r\n    id: string;\r\n    code: string;\r\n    name: string;\r\n    // Taxonomy & Type\r\n    subspecies: 'Bos taurus' | 'Bos indicus' | 'Cruzado';\r\n    biological_type: 'British' | 'Continental' | 'Rustic_European' | 'Dairy' | 'Indicus' | 'Composite';\r\n\r\n    weight_male_adult: number;\r\n    weight_female_adult: number;\r\n    slaughter_age_months: number;\r\n    adg_feedlot: number;\r\n    adg_grazing: number;\r\n    fcr_feedlot: number;\r\n    heat_tolerance: number; // 1-10\r\n    marbling_potential: number; // 1-5\r\n    calving_ease: number; // 1-10 (10=Easy)\r\n\r\n    // New Sapiens Params\r\n    milk_potential: number; // 1-5\r\n    conformation_potential: number; // 1-6 (P-S)\r\n    yield_potential: number; // Realistic CARCASS yield (0.45 - 0.65)\r\n\r\n    is_hybrid?: boolean;\r\n    sire_name?: string;\r\n    dam_name?: string;\r\n}\r\n\r\nexport const BASE_BREEDS: Breed[] = [\r\n    // 1. Infiltraci√≥n Alta (British)\r\n    { id: 'WAG', code: 'WAG', name: 'Wagyu', subspecies: 'Bos taurus', biological_type: 'British', weight_male_adult: 850, weight_female_adult: 550, slaughter_age_months: 29, adg_feedlot: 0.90, adg_grazing: 0.60, fcr_feedlot: 8.5, heat_tolerance: 5, marbling_potential: 5, calving_ease: 9, milk_potential: 2, conformation_potential: 3, yield_potential: 0.52 },\r\n    { id: 'ANG', code: 'ANG', name: 'Angus', subspecies: 'Bos taurus', biological_type: 'British', weight_male_adult: 900, weight_female_adult: 500, slaughter_age_months: 18, adg_feedlot: 1.40, adg_grazing: 0.90, fcr_feedlot: 7.9, heat_tolerance: 4, marbling_potential: 4, calving_ease: 8, milk_potential: 3, conformation_potential: 4, yield_potential: 0.54 },\r\n    { id: 'HER', code: 'HER', name: 'Hereford', subspecies: 'Bos taurus', biological_type: 'British', weight_male_adult: 1000, weight_female_adult: 580, slaughter_age_months: 20, adg_feedlot: 1.40, adg_grazing: 0.80, fcr_feedlot: 7.8, heat_tolerance: 3, marbling_potential: 3, calving_ease: 7, milk_potential: 2, conformation_potential: 4, yield_potential: 0.53 },\r\n\r\n    // 2. Crecimiento Magro / Conformaci√≥n (Continental)\r\n    { id: 'CHA', code: 'CHA', name: 'Charolais', subspecies: 'Bos taurus', biological_type: 'Continental', weight_male_adult: 1100, weight_female_adult: 800, slaughter_age_months: 24, adg_feedlot: 1.50, adg_grazing: 1.00, fcr_feedlot: 7.2, heat_tolerance: 3, marbling_potential: 2, calving_ease: 4, milk_potential: 2, conformation_potential: 5, yield_potential: 0.58 },\r\n    { id: 'LIM', code: 'LIM', name: 'Limousin', subspecies: 'Bos taurus', biological_type: 'Continental', weight_male_adult: 950, weight_female_adult: 650, slaughter_age_months: 16, adg_feedlot: 1.40, adg_grazing: 0.90, fcr_feedlot: 7.4, heat_tolerance: 4, marbling_potential: 3, calving_ease: 6, milk_potential: 2, conformation_potential: 5, yield_potential: 0.58 },\r\n    { id: 'BDA', code: 'BDA', name: 'Blonde d\\'Aquitaine', subspecies: 'Bos taurus', biological_type: 'Continental', weight_male_adult: 1200, weight_female_adult: 700, slaughter_age_months: 18, adg_feedlot: 1.60, adg_grazing: 1.10, fcr_feedlot: 7.1, heat_tolerance: 3, marbling_potential: 2, calving_ease: 5, milk_potential: 2, conformation_potential: 5, yield_potential: 0.61 },\r\n    { id: 'AZB', code: 'AZB', name: 'Azul Belga', subspecies: 'Bos taurus', biological_type: 'Continental', weight_male_adult: 1175, weight_female_adult: 775, slaughter_age_months: 16, adg_feedlot: 1.70, adg_grazing: 1.00, fcr_feedlot: 6.8, heat_tolerance: 1, marbling_potential: 1, calving_ease: 2, milk_potential: 2, conformation_potential: 6, yield_potential: 0.64 },\r\n    { id: 'PIR', code: 'PIR', name: 'Pirenaica', subspecies: 'Bos taurus', biological_type: 'Rustic_European', weight_male_adult: 900, weight_female_adult: 600, slaughter_age_months: 18, adg_feedlot: 1.30, adg_grazing: 0.85, fcr_feedlot: 7.8, heat_tolerance: 5, marbling_potential: 3, calving_ease: 7, milk_potential: 2, conformation_potential: 4, yield_potential: 0.56 },\r\n\r\n    // 3. R√∫sticas Adaptadas\r\n    { id: 'MOR', code: 'MOR', name: 'Morucha', subspecies: 'Bos taurus', biological_type: 'Rustic_European', weight_male_adult: 900, weight_female_adult: 500, slaughter_age_months: 30, adg_feedlot: 1.10, adg_grazing: 0.70, fcr_feedlot: 8.4, heat_tolerance: 8, marbling_potential: 3, calving_ease: 8, milk_potential: 2, conformation_potential: 2, yield_potential: 0.52 },\r\n    { id: 'RET', code: 'RET', name: 'Retinta', subspecies: 'Bos taurus', biological_type: 'Rustic_European', weight_male_adult: 1000, weight_female_adult: 580, slaughter_age_months: 30, adg_feedlot: 1.10, adg_grazing: 0.75, fcr_feedlot: 8.3, heat_tolerance: 8, marbling_potential: 3, calving_ease: 8, milk_potential: 2, conformation_potential: 3, yield_potential: 0.53 },\r\n    { id: 'BER', code: 'BER', name: 'Berrenda', subspecies: 'Bos taurus', biological_type: 'Rustic_European', weight_male_adult: 800, weight_female_adult: 500, slaughter_age_months: 23, adg_feedlot: 1.10, adg_grazing: 0.70, fcr_feedlot: 8.3, heat_tolerance: 8, marbling_potential: 3, calving_ease: 8, milk_potential: 2, conformation_potential: 3, yield_potential: 0.53 },\r\n    { id: 'BET', code: 'BET', name: 'Betizu', subspecies: 'Bos taurus', biological_type: 'Rustic_European', weight_male_adult: 450, weight_female_adult: 325, slaughter_age_months: 36, adg_feedlot: 0.90, adg_grazing: 0.55, fcr_feedlot: 9.2, heat_tolerance: 7, marbling_potential: 2, calving_ease: 10, milk_potential: 1, conformation_potential: 2, yield_potential: 0.48 },\r\n\r\n    // 4. Doble Prop√≥sito / Lecheras (Dairy)\r\n    { id: 'SIM', code: 'SIM', name: 'Simmental', subspecies: 'Bos taurus', biological_type: 'Dairy', weight_male_adult: 1100, weight_female_adult: 750, slaughter_age_months: 18, adg_feedlot: 1.50, adg_grazing: 0.85, fcr_feedlot: 7.0, heat_tolerance: 4, marbling_potential: 3, calving_ease: 6, milk_potential: 3, conformation_potential: 5, yield_potential: 0.56 },\r\n    { id: 'HOL', code: 'HOL', name: 'Holstein', subspecies: 'Bos taurus', biological_type: 'Dairy', weight_male_adult: 1000, weight_female_adult: 650, slaughter_age_months: 20, adg_feedlot: 1.20, adg_grazing: 0.60, fcr_feedlot: 8.5, heat_tolerance: 2, marbling_potential: 2, calving_ease: 5, milk_potential: 5, conformation_potential: 2, yield_potential: 0.49 },\r\n    { id: 'FRI', code: 'FRI', name: 'Frisona', subspecies: 'Bos taurus', biological_type: 'Dairy', weight_male_adult: 950, weight_female_adult: 600, slaughter_age_months: 20, adg_feedlot: 1.15, adg_grazing: 0.60, fcr_feedlot: 8.6, heat_tolerance: 2, marbling_potential: 2, calving_ease: 5, milk_potential: 5, conformation_potential: 2, yield_potential: 0.48 },\r\n\r\n    // 5. Indicus\r\n    { id: 'BRA', code: 'BRA', name: 'Brahman', subspecies: 'Bos indicus', biological_type: 'Indicus', weight_male_adult: 900, weight_female_adult: 550, slaughter_age_months: 24, adg_feedlot: 1.10, adg_grazing: 0.80, fcr_feedlot: 8.0, heat_tolerance: 10, marbling_potential: 2, calving_ease: 9, milk_potential: 3, conformation_potential: 3, yield_potential: 0.51 },\r\n    { id: 'NEL', code: 'NEL', name: 'Nelore', subspecies: 'Bos indicus', biological_type: 'Indicus', weight_male_adult: 900, weight_female_adult: 550, slaughter_age_months: 26, adg_feedlot: 1.05, adg_grazing: 0.75, fcr_feedlot: 8.2, heat_tolerance: 10, marbling_potential: 2, calving_ease: 9, milk_potential: 2, conformation_potential: 3, yield_potential: 0.52 },\r\n    { id: 'DRM', code: 'DRM', name: 'Droughtmaster', subspecies: 'Cruzado', biological_type: 'Composite', weight_male_adult: 900, weight_female_adult: 550, slaughter_age_months: 24, adg_feedlot: 1.20, adg_grazing: 0.90, fcr_feedlot: 7.9, heat_tolerance: 9, marbling_potential: 3, calving_ease: 9, milk_potential: 2, conformation_potential: 3, yield_potential: 0.53 },\r\n];\r\n\r\nexport const BreedManager = {\r\n    getAllBreeds(): Breed[] {\r\n        return BASE_BREEDS;\r\n    },\r\n\r\n    getBreedById(id: string): Breed | undefined {\r\n        return BASE_BREEDS.find(b => b.id === id || b.code === id);\r\n    },\r\n\r\n    getBreedByName(name: string): Breed | undefined {\r\n        return BASE_BREEDS.find(b => b.name.toLowerCase() === name.toLowerCase());\r\n    },\r\n\r\n    /**\r\n     * ASYMMETRIC HYBRID INHERITANCE MODEL\r\n     * Differentiates between Sire (Padre) and Dam (Madre).\r\n     * 1. Maternal Effect: Marbling and Milk are Madre-dominant (60%).\r\n     * 2. Paternal Effect: Conformation and Size are Padre-dominant (60%).\r\n     * 3. Size Mismatch: Large Sire on Small Dam leads to gradual Dystocia Risk.\r\n     */\r\n    calculateHybrid(sireId: string, damId: string): Breed | null {\r\n        const sire = this.getBreedById(sireId);\r\n        const dam = this.getBreedById(damId);\r\n\r\n        if (!sire || !dam) return null;\r\n\r\n        // --- 1. GENETIC DISTANCE HETEROSIS ---\r\n        const typeGroups = { 'British': 1, 'Continental': 2, 'Rustic_European': 3, 'Dairy': 4, 'Indicus': 5, 'Composite': 3 };\r\n        const sireG = typeGroups[sire.biological_type] || 3;\r\n        const damG = typeGroups[dam.biological_type] || 3;\r\n\r\n        let heterosisFactor = (sireG === damG) ? 0.02 : 0.05;\r\n        if (sire.biological_type === 'Indicus' !== (dam.biological_type === 'Indicus')) heterosisFactor = 0.12;\r\n\r\n        // --- 2. DYSTOCIA RISK (Gradual Weight Mismatch) ---\r\n        // Reflected from user feedback: \"gradual... diferencias del 50%\"\r\n        const sizeRatio = sire.weight_male_adult / dam.weight_female_adult;\r\n        let calvingPenalty = 0;\r\n\r\n        // Risk starts appearing at 10% difference and grows linearly/sharply\r\n        if (sizeRatio > 1.1) {\r\n            // Formula: Extra risk per 0.01 ratio beyond 1.1\r\n            // e.g. at 1.5 ratio (50% bigger): (1.5 - 1.1) * 20 = 8.0 points penalty.\r\n            calvingPenalty = (sizeRatio - 1.1) * 20;\r\n        }\r\n\r\n        // --- 3. ASYMMETRIC WEIGHTING ---\r\n        // S = Sire Weight, D = Dam Weight\r\n        const W_SIRE = 0.6;\r\n        const W_DAM = 0.4;\r\n\r\n        // Maternal-biased traits (Madre manda en Grasa y Leche)\r\n        const M_SIRE = 0.4;\r\n        const M_DAM = 0.6;\r\n\r\n        // --- 4. CALCULATION CORE ---\r\n\r\n        // A. Growth (ADG)\r\n        // Sire dominates growth speed\r\n        const baseAdg = (sire.adg_feedlot * W_SIRE) + (dam.adg_feedlot * W_DAM);\r\n        const milkBonus = dam.milk_potential >= 4 ? 1.05 : (dam.milk_potential <= 2 ? 0.95 : 1.0);\r\n        // User requested removing intrauterine growth penalty (\"no influye en la ganancia diaria\")\r\n        const finalAdg = baseAdg * (1 + (heterosisFactor * 1.5)) * milkBonus;\r\n\r\n        // B. Yield (Canal)\r\n        const finalYield = (sire.yield_potential * W_SIRE) + (dam.yield_potential * W_DAM);\r\n\r\n        // C. Marbling (Additive + Maternal Bias)\r\n        const finalMarbling = (sire.marbling_potential * M_SIRE) + (dam.marbling_potential * M_DAM);\r\n\r\n        // D. Adult Frame Size\r\n        const finalWeightM = ((sire.weight_male_adult * W_SIRE) + (dam.weight_male_adult * W_DAM)) * (1 + heterosisFactor);\r\n        const finalWeightF = ((sire.weight_female_adult * W_SIRE) + (dam.weight_female_adult * W_DAM)) * (1 + heterosisFactor);\r\n\r\n        // E. Conformation (Paternal Dominance)\r\n        const finalConf = (sire.conformation_potential * W_SIRE) + (dam.conformation_potential * W_DAM);\r\n\r\n        // F. Calving Ease (Daughter's ability)\r\n        const baseCalving = (sire.calving_ease * 0.3) + (dam.calving_ease * 0.7);\r\n        const finalCalving = Math.max(1, baseCalving - calvingPenalty);\r\n\r\n        return {\r\n            id: `F1_${sire.code}_${dam.code}`,\r\n            code: `${sire.code}x${dam.code}`,\r\n            name: `F1 ${dam.name} x ${sire.name}`,\r\n            subspecies: 'Cruzado',\r\n            biological_type: 'Composite',\r\n\r\n            weight_male_adult: finalWeightM,\r\n            weight_female_adult: finalWeightF,\r\n            slaughter_age_months: (sire.slaughter_age_months + dam.slaughter_age_months) / 2,\r\n            adg_feedlot: finalAdg,\r\n            adg_grazing: finalAdg * 0.7,\r\n            fcr_feedlot: ((sire.fcr_feedlot + dam.fcr_feedlot) / 2) * (1 - (heterosisFactor * 0.5)),\r\n            heat_tolerance: Math.max(sire.heat_tolerance, dam.heat_tolerance),\r\n            marbling_potential: finalMarbling,\r\n            calving_ease: finalCalving,\r\n            milk_potential: (sire.milk_potential * M_DAM) + (dam.milk_potential * M_SIRE),\r\n            conformation_potential: finalConf,\r\n            yield_potential: finalYield,\r\n            is_hybrid: true,\r\n            sire_name: sire.name,\r\n            dam_name: dam.name\r\n        };\r\n    }\r\n};\r\n","\r\nimport { Breed } from './breedManager';\r\n\r\nexport interface DietRequirement {\r\n    pb_percent: number;\r\n    em_mcal: number;\r\n    fdn_min: number;\r\n    dmi_capacity_kg: number; // Intake Capacity\r\n}\r\n\r\nexport interface DietAlert {\r\n    code: 'ACIDOSIS' | 'LOW_FIBER' | 'BLOAT' | 'BELLOTA_FIBER' | 'BELLOTA_PROTEIN' | 'BELLOTA_TOXICITY' | 'LOW_N_EFF' | 'HIGH_POLLUTION' | 'OK';\r\n    level: 'warning' | 'critical' | 'success';\r\n    message: string;\r\n    action?: string;\r\n}\r\n\r\nexport interface SynergyResult {\r\n    active: boolean;\r\n    name: string;\r\n    bonus_marbling: number;\r\n    bonus_yield: number;\r\n    description: string;\r\n}\r\n\r\nexport interface KPITargets {\r\n    adg: number;     // Target Average Daily Gain\r\n    fcr: number;     // Target Feed Conversion Ratio\r\n    energyDensity: number; // Mcal/kg DM\r\n    proteinDensity: number; // % CP\r\n    fiberMin: number; // % FDN\r\n    maxConcentrate: number; // % Max concentrates allowed\r\n}\r\n\r\nexport const NutritionEngine = {\r\n    BELLOTA_PROTOCOL: {\r\n        season_start_month: 9, // Oct\r\n        season_end_month: 1,   // Feb\r\n        min_oleic_acid: 55,\r\n        min_age_months: 14,\r\n        max_bellota_percent: 40,\r\n        min_fdn_bellota: 28,\r\n        min_protein_bellota: 12,\r\n        // Types\r\n        TYPE_ENCINA: 'ENCINA', // High Oleic\r\n        TYPE_ROBLE: 'ROBLE'    // High Tannins\r\n    },\r\n\r\n    /**\r\n     * Calculate KPI Targets based on Objective, Breed, and System\r\n     * Refactor A5: \"La dieta recomendada = funci√≥n de (etapa √ó tipo_funcional √ó entorno √ó manejo)\"\r\n     */\r\n    calculateKPITargets(\r\n        animal: { breed: string, sex: string, weight: number, ageMonths: number, functionalType?: string, stage?: string, biological_type?: string },\r\n        objective: string,\r\n        system: string\r\n    ): KPITargets {\r\n        // Defaults (Maintenance / Rustica Base)\r\n        let targets: KPITargets = {\r\n            adg: 0.1, fcr: 0, energyDensity: 2.0, proteinDensity: 10, fiberMin: 35, maxConcentrate: 30\r\n        };\r\n\r\n        // Auto-detect Functional Type from Biological Type (if not explicit)\r\n        let fType = animal.functionalType || 'rustica_adaptada';\r\n\r\n        if (!animal.functionalType && animal.biological_type) {\r\n            if (animal.biological_type === 'Rustic_European') fType = 'rustica_adaptada';\r\n            else if (animal.biological_type === 'Continental') fType = 'crecimiento_magro'; // Charolais like\r\n            else if (animal.biological_type === 'British') fType = 'infiltracion'; // Angus\r\n            else if (animal.biological_type === 'Dairy') fType = 'aptitud_lechera';\r\n            else if (animal.biological_type === 'Indicus') fType = 'rustica_adaptada';\r\n        }\r\n\r\n        const currentStage = animal.stage || (animal.ageMonths < 8 ? 'recria' : 'terminado');\r\n\r\n        // --- REGLAS DETERMINISTAS POR TIPO FUNCIONAL (A5) ---\r\n\r\n        // 1. Razas Infiltraci√≥n (Wagyu, Angus-High)\r\n        if (fType === 'infiltracion') {\r\n            if (currentStage === 'terminado' || objective.includes('Engorde') || objective.includes('Cebo') || objective.includes('Eficiencia')) {\r\n                // Objetivo Calidad > Velocidad\r\n                targets.energyDensity = 2.9; // High Energy for marbling\r\n                targets.proteinDensity = 12; // Lower protein to avoid late frame growth\r\n                targets.fiberMin = 15;       // Risk of acidosis managed by alerts\r\n                targets.maxConcentrate = 85;\r\n                targets.adg = 0.9;           // Slower, physiological gain\r\n                targets.fcr = 8.5;           // High FCR expected (fat deposition cost)\r\n            } else {\r\n                // Recr√≠a: Preparar estructura\r\n                targets.energyDensity = 2.4;\r\n                targets.proteinDensity = 14;\r\n                targets.adg = 0.8;\r\n            }\r\n        }\r\n\r\n        // 2. Crecimiento Magro (Charolais, Limousin)\r\n        else if (fType === 'crecimiento_magro') {\r\n            if (currentStage === 'terminado' || objective.includes('Engorde') || objective.includes('Cebo') || objective.includes('Eficiencia')) {\r\n                // Maximizando m√∫sculo\r\n                targets.energyDensity = 2.8;\r\n                targets.proteinDensity = 14.5; // High protein for muscle\r\n                targets.fiberMin = 18;\r\n                targets.maxConcentrate = 80;\r\n                targets.adg = 1.6;             // Aggressive gain\r\n                targets.fcr = 5.8;             // Efficient conversion expected\r\n            } else {\r\n                targets.energyDensity = 2.5;\r\n                targets.proteinDensity = 16;   // Max frame growth\r\n                targets.adg = 1.1;\r\n                targets.fcr = 5.5;\r\n            }\r\n        }\r\n\r\n        // 3. R√∫stica / Adaptada (Morucha, Avile√±a)\r\n        else if (fType === 'rustica_adaptada') {\r\n            // Prioridad: Coste bajo, fibra, salud\r\n            targets.energyDensity = 2.2;\r\n            targets.proteinDensity = 11;\r\n            targets.fiberMin = 30;         // High fiber health\r\n            targets.maxConcentrate = 40;   // Low supplement\r\n            targets.adg = 0.7;             // Moderate gain\r\n            targets.fcr = 7.5;             // Pasture efficiency\r\n\r\n            if (system.includes('Montanera')) {\r\n                targets.adg = 1.0;         // Boost in montanera\r\n                targets.energyDensity = 2.8;\r\n            }\r\n        }\r\n\r\n        // 4. Aptitud Lechera (Simmental, Pardo)\r\n        else if (fType === 'aptitud_lechera') {\r\n            // Prioridad: Soporte a lactancia y crecimiento estructura\r\n            targets.energyDensity = 2.6;\r\n            targets.proteinDensity = 15;   // High protein requirement\r\n            targets.fiberMin = 25;\r\n            targets.maxConcentrate = 60;\r\n            targets.adg = 1.2;\r\n            targets.fcr = 6.5;\r\n        }\r\n\r\n        // 5. C√°rnica General (Limousin, Blonde)\r\n        else if (fType === 'carnica_general') {\r\n            // Balance entre crecimiento y estructura\r\n            targets.energyDensity = 2.7;\r\n            targets.proteinDensity = 14;\r\n            targets.fiberMin = 20;\r\n            targets.maxConcentrate = 70;\r\n            targets.adg = 1.4;\r\n            targets.fcr = 6.2;\r\n        }\r\n\r\n        // 6. Doble Prop√≥sito (Retinta Est√°ndar, Avile√±a buena)\r\n        else if (fType === 'doble_proposito') {\r\n            targets.energyDensity = 2.4;\r\n            targets.proteinDensity = 12.5;\r\n            targets.fiberMin = 28;\r\n            targets.maxConcentrate = 50;\r\n            targets.adg = 0.9;\r\n            targets.fcr = 7.2;\r\n        }\r\n\r\n        // 4. Composito (F1s) - Hybrid Vigor logic handled by higher ADG targets implicitly or adjustment\r\n        if (fType === 'composito') {\r\n            // Intermediate/Best of both: e.g. F1 Wagyu x Morucha\r\n            targets.adg *= 1.1; // 10% Heterosis boost on target\r\n            targets.fcr *= 0.95; // Better efficiency\r\n        }\r\n\r\n        // --- OBJECTIVE OVERRIDES ---\r\n        if (objective === 'Eficiencia Econ√≥mica') {\r\n            // Reduce max ADG potential slightly to prioritize cheaper feed\r\n            targets.adg *= 0.9;\r\n            targets.maxConcentrate *= 0.8; // Reduce expensive feed limit\r\n            targets.energyDensity = Math.max(2.0, targets.energyDensity * 0.95);\r\n        } else if (objective === 'Mantenimiento') {\r\n            targets.energyDensity = 2.0;\r\n            targets.adg = 0.1;\r\n            targets.maxConcentrate = 10;\r\n        }\r\n\r\n        // --- SYSTEM CONSTRAINTS (Overrides) ---\r\n        if (system.includes('Extensivo') && !system.includes('Montanera')) {\r\n            targets.maxConcentrate = Math.min(targets.maxConcentrate, 30);\r\n            targets.adg = Math.min(targets.adg, 0.8);\r\n        }\r\n\r\n        return targets;\r\n    },\r\n\r\n    /**\r\n     * Generate Smart Diet Recommendation\r\n     * Returns a list of ingredients and amounts to meet targets.\r\n     */\r\n    generateSmartDiet(\r\n        targets: KPITargets,\r\n        animal: { weight: number },\r\n        system: string,\r\n        ingredientsDB: any[] // Provide list of available feeds\r\n    ): { feed_id: string, feed_name: string, dm_kg: number }[] {\r\n        const diet: { feed_id: string, feed_name: string, dm_kg: number }[] = [];\r\n\r\n        // Est. DMI limit\r\n        const dmiLimit = animal.weight * 0.025; // 2.5% BW\r\n        let currentDmi = 0;\r\n\r\n        // --- SPECIAL PROTOCOLS ---\r\n\r\n        // 1. MONTANERA (Bellota + Soja)\r\n        if (system.includes('Montanera')) {\r\n            // Safety Forage (Minimum)\r\n            // 'paja' ID inferred from previous code\r\n            // User feedback: \"Necesita algo de fibra\". Increased to 15% to satisfy FDN requirements (>20%)\r\n            const forageAmount = dmiLimit * 0.15;\r\n            diet.push({ feed_id: 'paja', feed_name: 'Paja de Cereales', dm_kg: parseFloat(forageAmount.toFixed(1)) });\r\n            currentDmi += forageAmount;\r\n\r\n            const remaining = dmiLimit - currentDmi;\r\n\r\n            // Bellota (80% of rest) - ID: BELLHO_01\r\n            // Default generic name, UI will refine type logic\r\n            const bellotaAmount = remaining * 0.80;\r\n            diet.push({ feed_id: 'BELLHO_01', feed_name: 'Bellota de Encina', dm_kg: parseFloat(bellotaAmount.toFixed(1)) });\r\n\r\n            // Soja (20% of rest) - ID: P01\r\n            const sojaAmount = remaining * 0.20;\r\n            diet.push({ feed_id: 'P01', feed_name: 'Soja (Harina 44%)', dm_kg: parseFloat(sojaAmount.toFixed(1)) });\r\n\r\n            return diet;\r\n        }\r\n\r\n        // --- STANDARD LOGIC ---\r\n        // Basic Solver: Fill Fiber > Fill Energy > Fill Protein\r\n\r\n        // 1. BASE: FORAGE\r\n        let forageId = 'paja';\r\n        let forageName = 'Paja de Cereales';\r\n        let forageAmount = dmiLimit * 0.2;\r\n\r\n        // If High Performance (Marbling/Feedlot) -> Less Forage\r\n        if (targets.energyDensity > 2.7) forageAmount = dmiLimit * 0.12;\r\n\r\n        // If Rustica/Maintenance -> More Forage\r\n        if (targets.energyDensity < 2.3) forageAmount = dmiLimit * 0.50;\r\n\r\n        if (system.includes('Extensivo')) {\r\n            forageId = 'F01';\r\n            forageName = 'Pasto Dehesa (Primavera)';\r\n        } else if (system.includes('Ecol√≥gico')) {\r\n            forageId = 'F03'; // Heno\r\n            forageName = 'Heno de Avena';\r\n        }\r\n\r\n        diet.push({ feed_id: forageId, feed_name: forageName, dm_kg: parseFloat(forageAmount.toFixed(1)) });\r\n        currentDmi += forageAmount;\r\n\r\n        // 2. FILLER: ENERGY\r\n        let energyId = 'C01'; // Maiz\r\n        let energyName = 'Ma√≠z (Grano)';\r\n\r\n        // Use Barley for Rustic? (Cheaper/Lower Energy?)\r\n        if (targets.energyDensity < 2.5) {\r\n            energyId = 'C02'; // Cebada\r\n            energyName = 'Cebada';\r\n        }\r\n\r\n        if (system.includes('Ecol√≥gico')) {\r\n            energyId = 'C01'; // Assuming Corn is allowed or swapping to Tritordeum if ID known. \r\n            // Let's stick to C01 for now as generic Cereal.\r\n            energyName = 'Cereal Ecol√≥gico';\r\n        }\r\n\r\n        let remainingDmi = dmiLimit - currentDmi;\r\n        // Basic Logic from targets (Regla A5 details here are implicitly handled by targets.maxConcentrate and energyDensity)\r\n        // If targets.maxConcentrate is low (Rustica), we limit energy filler\r\n        let energyAmount = remainingDmi * 0.6; // Default\r\n\r\n        // Adjust based on targets (Simplistic solver)\r\n        if (targets.energyDensity > 2.6) {\r\n            energyAmount = remainingDmi * 0.8; // High energy\r\n        }\r\n        if (targets.maxConcentrate < 60) {\r\n            energyAmount = Math.min(energyAmount, dmiLimit * (targets.maxConcentrate / 100));\r\n        }\r\n\r\n        diet.push({ feed_id: energyId, feed_name: energyName, dm_kg: parseFloat(energyAmount.toFixed(1)) });\r\n        currentDmi += energyAmount;\r\n\r\n        // 3. CORRECTOR: PROTEIN\r\n        remainingDmi = dmiLimit - currentDmi;\r\n        if (remainingDmi > 0) {\r\n            let proteinId = 'P01'; // Soja\r\n            let proteinName = 'Soja (Harina 44%)';\r\n\r\n            if (system.includes('Ecol√≥gico')) {\r\n                // Eco protein? Maybe Peas. Assuming 'P01' is conventional soy. \r\n                // Using 'Guisantes' if ID exists, otherwise keep generic.\r\n                proteinName = 'Guisantes Proteicos';\r\n            }\r\n\r\n            diet.push({ feed_id: proteinId, feed_name: proteinName, dm_kg: parseFloat(remainingDmi.toFixed(1)) });\r\n        }\r\n\r\n        return diet;\r\n    },\r\n\r\n    // --- EXISTING CALCULATIONS (Preserved and Updated if needed) ---\r\n    calculateRequirements(\r\n        weight: number,\r\n        adgTarget: number,\r\n        ageMonths: number,\r\n        state: 'Cebo' | 'Mantenimiento' | 'Gestante' | 'Lactancia',\r\n        sex: 'Macho' | 'Hembra' | 'Castrado'\r\n    ): DietRequirement {\r\n        // ... (Same as before, good baseline) ...\r\n        // Re-implementing essentially the same logic for compatibility\r\n        // DMI (Dry Matter Intake) Estimation Curve\r\n        // Standard: 2.5% for growing calves.\r\n        // Finishing (>400kg): 2.2%.\r\n        // Heavy Finishing / Oxen (>700kg): Drops due to physical capacity and fatness (1.8% - 2.0%)\r\n        let dmi_pct = 0.025;\r\n        if (weight > 400) dmi_pct = 0.022;\r\n        if (weight > 700) dmi_pct = 0.019; // Optimized for heavy oxen\r\n        if (state === 'Mantenimiento' && weight > 600) dmi_pct = 0.018;\r\n\r\n        const dmi_capacity_kg = weight * dmi_pct;\r\n\r\n        const metabolicWeight = Math.pow(weight, 0.75);\r\n        let nem_req = 0.077 * metabolicWeight;\r\n        if (state === 'Mantenimiento') nem_req *= 1.20;\r\n\r\n        let sexFactor = 1.0;\r\n        if (sex === 'Hembra') sexFactor = 1.15;\r\n        if (sex === 'Castrado') sexFactor = 1.10;\r\n\r\n        const neg_req = (0.05 * metabolicWeight * Math.pow(adgTarget, 1.1)) * sexFactor;\r\n        const total_NE_mcal = nem_req + neg_req;\r\n        const required_Mcal_kg = total_NE_mcal / dmi_capacity_kg;\r\n\r\n        let cp_pct = 12;\r\n        if (state === 'Mantenimiento') cp_pct = 8.5;\r\n        else if (state === 'Lactancia') cp_pct = 15.0;\r\n        else if (weight < 300) cp_pct = 16.0;\r\n        else if (weight > 500) cp_pct = 11.5;\r\n\r\n        let fdn_min = 30;\r\n        if (state === 'Cebo') fdn_min = 15;\r\n        if (state === 'Lactancia') fdn_min = 28;\r\n\r\n        return {\r\n            pb_percent: cp_pct,\r\n            em_mcal: parseFloat(required_Mcal_kg.toFixed(2)),\r\n            fdn_min: fdn_min,\r\n            dmi_capacity_kg: parseFloat(dmi_capacity_kg.toFixed(1))\r\n        };\r\n    },\r\n\r\n    validateDiet(\r\n        activeFeeds: { item: any, amount: number }[], // Item + Fresh Amount\r\n        metrics: { totalDMI: number, totalFDN: number, totalProteinVal: number, totalEnergy: number, reqs: DietRequirement },\r\n        system: string\r\n    ): DietAlert[] {\r\n        const alerts: DietAlert[] = [];\r\n        if (metrics.totalDMI <= 0) return alerts;\r\n\r\n        const fdnPct = (metrics.totalFDN / metrics.totalDMI); // As decimal (0.30 = 30%)\r\n        const cpPct = (metrics.totalProteinVal / 10 / metrics.totalDMI); // As decimal (0.12 = 12%)\r\n\r\n        const safeSystem = String(system || '');\r\n\r\n        // 1. ACIDOSIS RISK\r\n        // General Rule: FDN < 28% is risk in Extensive. Feedlots tolerate down to 15% with management.\r\n        let minFdn = 0.28;\r\n        if (safeSystem.includes('Cebo') || safeSystem.includes('Intensivo')) minFdn = 0.15;\r\n\r\n        if (fdnPct < minFdn) {\r\n            alerts.push({\r\n                code: 'ACIDOSIS',\r\n                level: 'critical',\r\n                message: `Riesgo de Acidosis: Fibra muy baja (${(fdnPct * 100).toFixed(1)}%). M√≠nimo recomendado: ${(minFdn * 100).toFixed(0)}%.`,\r\n                action: 'Aumente la proporci√≥n de forraje o fibra efectiva.'\r\n            });\r\n        }\r\n        else if (fdnPct < (minFdn + 0.04)) { // Warning zone\r\n            alerts.push({\r\n                code: 'LOW_FIBER',\r\n                level: 'warning',\r\n                message: `Fibra ajustada (${(fdnPct * 100).toFixed(1)}%). Vigile la rumia.`,\r\n                action: 'Considere a√±adir algo m√°s de paja o heno.'\r\n            });\r\n        }\r\n\r\n        // 2. METEORISMO (Bloat)\r\n        // Heuristic: If Legumes > 50% OR FDN < 20% (Double Trigger)\r\n        const legumeKg = activeFeeds.filter(f => f.item.category === 'Leguminosa' || f.item.name.includes('Alfalfa') || f.item.name.includes('Tr√©bol')).reduce((s, f) => s + (f.amount * (f.item.dm_percent / 100)), 0);\r\n        const legumePct = legumeKg / metrics.totalDMI;\r\n\r\n        if (legumePct > 0.5 || (legumePct > 0.3 && fdnPct < 0.22)) {\r\n            alerts.push({\r\n                code: 'BLOAT',\r\n                level: 'critical',\r\n                message: 'Alto Riesgo de Meteorismo (Hinchaz√≥n).',\r\n                action: 'Exceso de leguminosas. A√±ada paja o aceite/bloque anti-meteorismo.'\r\n            });\r\n        }\r\n\r\n        // 3. BELLOTA SPECIFIC RISKS\r\n        if (safeSystem.includes('Montanera')) {\r\n            const bellotaKg = activeFeeds.filter(f => f.item.name.toLowerCase().includes('bellota')).reduce((s, f) => s + (f.amount * (f.item.dm_percent / 100)), 0);\r\n            const bellotaPct = bellotaKg / metrics.totalDMI;\r\n\r\n            const forageKg = activeFeeds.filter(f => f.item.category === 'Forraje').reduce((s, f) => s + (f.amount * (f.item.dm_percent / 100)), 0);\r\n            const foragePct = forageKg / metrics.totalDMI;\r\n\r\n            // BELLOTA_FIBER\r\n            if (bellotaPct > 0 && foragePct < 0.10) {\r\n                alerts.push({\r\n                    code: 'BELLOTA_FIBER',\r\n                    level: 'critical',\r\n                    message: 'Falta de Fibra en Montanera.',\r\n                    action: 'La bellota no tiene fibra efectiva. El animal DEBE comer hierba o paja.'\r\n                });\r\n            }\r\n\r\n            // BELLOTA_PROTEIN\r\n            // If Bellota is high (>60%) and CP is low (<10%), muscle growth will stop.\r\n            if (bellotaPct > 0.6 && cpPct < 0.10) {\r\n                alerts.push({\r\n                    code: 'BELLOTA_PROTEIN',\r\n                    level: 'warning',\r\n                    message: 'D√©ficit Proteico en Montanera.',\r\n                    action: 'La bellota es energ√©tica pero baja en prote√≠na. Suplemente con torta de girasol/soja si busca crecimiento.'\r\n                });\r\n            }\r\n\r\n            // BELLOTA_TOXICITY (Tannins)\r\n            // Mock check: If 'Roble' type (higher tannin) is selected > 50%\r\n            const robleKg = activeFeeds.filter(f => f.item.name.toLowerCase().includes('roble')).reduce((s, f) => s + (f.amount * (f.item.dm_percent / 100)), 0);\r\n            if (robleKg / metrics.totalDMI > 0.5) {\r\n                alerts.push({\r\n                    code: 'BELLOTA_TOXICITY',\r\n                    level: 'warning',\r\n                    message: 'Precauci√≥n: Exceso de Taninos (Roble).',\r\n                    action: 'Carga alta de bellota amarga. Vigile el estre√±imiento o rechazo.'\r\n                });\r\n            }\r\n        }\r\n\r\n        // 4. NITROGEN EFFICIENCY & POLLUTION\r\n        const requiredCP = metrics.reqs.pb_percent / 100; // e.g. 0.13\r\n\r\n        // Low Efficiency: We are feeding LESS protein than needed (-2% margin)\r\n        if (cpPct < (requiredCP - 0.02)) {\r\n            alerts.push({\r\n                code: 'LOW_N_EFF',\r\n                level: 'critical',\r\n                message: `D√©ficit de Prote√≠na (${(cpPct * 100).toFixed(1)}% vs ${(requiredCP * 100).toFixed(1)}%).`,\r\n                action: 'El crecimiento se detendr√°. A√±ada proteaginosas.'\r\n            });\r\n        }\r\n\r\n        // Pollution: We are feeding TOO MUCH protein (> +4% margin)\r\n        // Costly and polluting.\r\n        if (cpPct > (requiredCP + 0.04)) {\r\n            alerts.push({\r\n                code: 'HIGH_POLLUTION',\r\n                level: 'warning',\r\n                message: `Exceso de Nitr√≥geno (+${((cpPct - requiredCP) * 100).toFixed(1)}%). Contaminante y caro.`,\r\n                action: 'Reduzca la prote√≠na para mejorar la eficiencia econ√≥mica y ambiental.'\r\n            });\r\n        }\r\n\r\n        return alerts;\r\n    },\r\n\r\n    calculateSynergies(\r\n        rationIngredients: { feed_name: string }[],\r\n        animal: { sex: string, ageMonths: number },\r\n        options: { bellotaType?: string } = {}\r\n    ): SynergyResult[] {\r\n        const results: SynergyResult[] = [];\r\n        const names = rationIngredients.map(i => i.feed_name.toLowerCase());\r\n        const hasBellota = names.some(n => n.includes('bellota'));\r\n        const hasLecithin = names.some(n => n.includes('lecitina') || n.includes('harina de soja'));\r\n\r\n        if (hasBellota && hasLecithin) {\r\n            let boost = 0.5;\r\n            if (animal.sex === 'Castrado' || animal.sex === 'Buey') boost = 0.8;\r\n\r\n            // NEW: Type specific boost\r\n            let desc = 'üî• Bellota + Lecitina: Infiltraci√≥n mejorada.';\r\n            if (options.bellotaType === 'ENCINA') {\r\n                boost += 0.4; // 1.2 Total for Castrado\r\n                desc = 'üî• Bellota Encina (Alto Oleico): Infiltraci√≥n M√°xima.';\r\n            } else if (options.bellotaType === 'ROBLE') {\r\n                // Std boost\r\n                desc = 'üçÇ Bellota Roble (Taninos): Sabor Intenso.';\r\n            }\r\n\r\n            results.push({\r\n                active: true, name: 'ACIDOS_GRASOS_EMULSIONADOS', bonus_marbling: boost, bonus_yield: 1.5,\r\n                description: desc\r\n            });\r\n        }\r\n        return results;\r\n    },\r\n\r\n    checkBellotaCompliance(animal: { ageMonths: number }, currentMonth: number) {\r\n        // Preserved\r\n        const validMonths = [9, 10, 11, 0, 1];\r\n        if (!validMonths.includes(currentMonth)) return { compliant: false, reason: 'Fuera temporada' };\r\n        if (animal.ageMonths < 14) return { compliant: false, reason: 'Muy joven <14m' };\r\n        return { compliant: true };\r\n    },\r\n\r\n    calculateNitrogenBalance(weight: number, adg: number, dietPbPercent: number, dmiKg: number) {\r\n        // Preserved\r\n        const proteinIntakeG = dmiKg * (dietPbPercent / 100) * 1000;\r\n        const nIntake = proteinIntakeG / 6.25;\r\n        const nRetained = adg * 1000 * 0.027;\r\n        const nExcreted = Math.max(0, nIntake - nRetained);\r\n        const effic = nIntake > 0 ? (nRetained / nIntake) * 100 : 0;\r\n        const excretionPerGain = adg > 0.1 ? nExcreted / adg : 0;\r\n        return {\r\n            n_intake_g: nIntake.toFixed(1),\r\n            n_retained_g: nRetained.toFixed(1),\r\n            n_excreted_g: nExcreted.toFixed(1),\r\n            efficiency_pct: effic.toFixed(1),\r\n            excretion_per_gain: excretionPerGain.toFixed(1),\r\n            is_critical: excretionPerGain > 150\r\n        };\r\n    },\r\n\r\n    predictPerformance(\r\n        breed: Breed,\r\n        dietEnergy: number,\r\n        dmi: number,\r\n        weight: number,\r\n        options: { currentMonth?: number, activeSynergies?: string[] } = {}\r\n    ): number {\r\n        // Preserved\r\n        let nemReq = 0.077 * Math.pow(weight, 0.75);\r\n\r\n        // Biological Type Adjustments (Consistent with Inventory)\r\n        if (breed.biological_type === 'Rustic_European') nemReq *= 0.9;\r\n        else if (breed.biological_type === 'Continental') nemReq *= 1.05;\r\n        else if (breed.biological_type === 'Dairy') nemReq *= 1.25;\r\n        else if (breed.biological_type === 'Indicus') nemReq *= 0.85;\r\n\r\n        if (options.currentMonth !== undefined) {\r\n            const m = options.currentMonth;\r\n            if (m >= 5 && m <= 8 && (breed.heat_tolerance || 5) < 5) nemReq *= 1.25; // Summer\r\n            if ((m === 11 || m <= 1) && breed.code === 'AZB') nemReq *= 1.15; // Winter\r\n        }\r\n        const totalEnergy = dietEnergy * dmi;\r\n        const energyForGain = totalEnergy - nemReq;\r\n        let estADG = energyForGain * 0.35;\r\n\r\n        // Functional Type Effect? \r\n        // Logic generally handled via breed.adg_feedlot cap, but could be enhanced here.\r\n        // For MVP, keeping standard breed params is fine as targets drive the diet design.\r\n\r\n        if (options.activeSynergies?.includes('ACIDOS_GRASOS_EMULSIONADOS')) estADG *= 1.10;\r\n        if (estADG > 0) estADG = Math.min(estADG, breed.adg_feedlot * 1.2);\r\n        else estADG = Math.max(estADG, -2.0);\r\n\r\n        return parseFloat(estADG.toFixed(2));\r\n    }\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useStorage } from '@/context/StorageContext';\r\nimport { SigpacService } from '@/services/sigpacService';\r\nimport { WeatherService } from '@/services/weatherService';\r\nimport { SPANISH_PROVINCES } from '@/services/locationService';\r\nimport { SoilEngine } from '@/services/soilEngine';\r\nimport { BreedManager } from '@/services/breedManager';\r\n\r\ninterface Farm {\r\n    id: string;\r\n    name: string;\r\n    municipio: string;\r\n    municipioCode?: string;\r\n    provinciaCode?: string;\r\n    poligono: string;\r\n    parcela: string;\r\n    superficie: number;\r\n    recintos: any[];\r\n    coords?: { lat: number; lng: number };\r\n    slope?: number;\r\n\r\n    // New Fields\r\n    license: string;\r\n    maxHeads: number;\r\n    soilId: string;\r\n    corrals: number;\r\n    corralNames?: string[];\r\n    feedingSystem?: string;\r\n\r\n    // Recommendations & Analysis\r\n    climateStudy?: any;\r\n    cropsRecommendation?: any[];\r\n    breedsRecommendation?: any[];\r\n    f1Recommendation?: any[];\r\n}\r\n\r\nexport function FarmsManager() {\r\n    const { read, write } = useStorage();\r\n    const [farms, setFarms] = useState<Farm[]>([]);\r\n    const [showForm, setShowForm] = useState(false);\r\n    const [sessionUser, setSessionUser] = useState('');\r\n\r\n    // Form State\r\n    const [newName, setNewName] = useState('');\r\n    const [provincia, setProvincia] = useState('45'); // Toledo default\r\n    const [municipio, setMunicipio] = useState(''); // Code\r\n    const [municipioName, setMunicipioName] = useState('');\r\n    const [poligono, setPoligono] = useState('');\r\n    const [parcela, setParcela] = useState('');\r\n\r\n    // New Fields State\r\n    const [license, setLicense] = useState('');\r\n    const [maxHeads, setMaxHeads] = useState('');\r\n    const [soilId, setSoilId] = useState('');\r\n    const [corrals, setCorrals] = useState('');\r\n    const [corralNames, setCorralNames] = useState<string[]>([]);\r\n    const [feedingSystem, setFeedingSystem] = useState('');\r\n\r\n    // Analysis State\r\n    const [climateData, setClimateData] = useState<any>(null);\r\n    const [analyzing, setAnalyzing] = useState(false);\r\n    const [recommendations, setRecommendations] = useState<any>({ crops: [], breeds: [], f1s: [] });\r\n    const [showAllBreeds, setShowAllBreeds] = useState(false);\r\n    const [showAllF1s, setShowAllF1s] = useState(false);\r\n    const [showAllCrops, setShowAllCrops] = useState(false);\r\n\r\n    // Lists\r\n    // Simplified lists for demo\r\n    // List of municipalities (populated from JSON)\r\n    const [municipalities, setMunicipalities] = useState<any[]>([]);\r\n    const [soilTypes, setSoilTypes] = useState<any[]>([]);\r\n\r\n    const [loadingSigpac, setLoadingSigpac] = useState(false);\r\n    const [searchResult, setSearchResult] = useState<any>(null);\r\n\r\n    // Initial Load & Restore Draft\r\n    useEffect(() => {\r\n        // Load Soil Types from new Engine\r\n        setSoilTypes(SoilEngine.getAllSoils().map(s => ({ id_suelo: s.id, nombre: s.name })));\r\n\r\n        const user = read<string>('sessionUser', '');\r\n        setSessionUser(user);\r\n\r\n        // Load farms\r\n        const loadedFarms = read<Farm[]>(`fincas_${user}`, []);\r\n        setFarms(loadedFarms);\r\n\r\n        // Restore Draft\r\n        const draft = localStorage.getItem(`farm_draft_${user}`);\r\n        if (draft) {\r\n            try {\r\n                const d = JSON.parse(draft);\r\n                if (confirm(\"Hemos encontrado datos de una finca que no se guard√≥. ¬øQuieres recuperarlos?\")) {\r\n                    setNewName(d.newName || '');\r\n                    setProvincia(d.provincia || '10');\r\n                    setMunicipio(d.municipio || '');\r\n                    setMunicipioName(d.municipioName || '');\r\n                    setPoligono(d.poligono || '');\r\n                    setParcela(d.parcela || '');\r\n                    setLicense(d.license || '');\r\n                    setMaxHeads(d.maxHeads || '');\r\n                    setSoilId(d.soilId || '');\r\n                    setCorrals(d.corrals || '');\r\n                    setFeedingSystem(d.feedingSystem || '');\r\n                    setShowForm(true);\r\n                } else {\r\n                    localStorage.removeItem(`farm_draft_${user}`);\r\n                }\r\n            } catch (e) {\r\n                console.error(\"Error restoring draft\", e);\r\n            }\r\n        }\r\n    }, [read]);\r\n\r\n    // Auto-Save Draft\r\n    useEffect(() => {\r\n        if (!sessionUser || !showForm) return;\r\n        if (newName || license || poligono || parcela) {\r\n            const draft = {\r\n                newName, provincia, municipio, municipioName,\r\n                poligono, parcela, license, maxHeads, soilId, corrals, feedingSystem\r\n            };\r\n            localStorage.setItem(`farm_draft_${sessionUser}`, JSON.stringify(draft));\r\n        }\r\n    }, [newName, provincia, municipio, poligono, parcela, license, maxHeads, soilId, corrals, feedingSystem, showForm, sessionUser]);\r\n\r\n    // --- Location Logic ---\r\n    const [allMunicipalities, setAllMunicipalities] = useState<any[]>([]);\r\n    const [isLoadingLoc, setIsLoadingLoc] = useState(false);\r\n\r\n    // Initial Load of Full Municipality Database\r\n    useEffect(() => {\r\n        const loadMunis = async () => {\r\n            try {\r\n                const res = await fetch('/data/municipios.json');\r\n                if (res.ok) {\r\n                    const data = await res.json();\r\n                    setAllMunicipalities(data);\r\n                }\r\n            } catch (e) {\r\n                console.error(\"Error loading municipalities\", e);\r\n            }\r\n        };\r\n        loadMunis();\r\n    }, []);\r\n\r\n    // Filter Municipalities when Province changes\r\n    useEffect(() => {\r\n        if (provincia && allMunicipalities.length > 0) {\r\n            // Filter by provincia_id. Note: JSON uses \"provincia_id\" (e.g. \"10\", \"31\")\r\n            // Ensure padding if needed, but our select values are already padded \"01\", \"10\", etc.\r\n            const filtered = allMunicipalities.filter(m => m.provincia_id === provincia);\r\n\r\n            // Map to our component format { codigo, descripcion }\r\n            const mapped = filtered.map(m => ({\r\n                codigo: m.cmun,       // INE code for municipality (e.g. \"095\")\r\n                descripcion: m.nombre // Name (e.g. \"Guadalupe\")\r\n            })).sort((a, b) => a.descripcion.localeCompare(b.descripcion));\r\n\r\n            setMunicipalities(mapped);\r\n        } else {\r\n            setMunicipalities([]);\r\n        }\r\n    }, [provincia, allMunicipalities]);\r\n\r\n    // Live Recommendation Update\r\n    useEffect(() => {\r\n        if (soilId) {\r\n            // 1. Crop Recommendations from SoilEngine\r\n            // 1. Crop Recommendations from SoilEngine (New Advanced Logic)\r\n            // Slope default to 0 if not available (ideally should come from farm data)\r\n            // Ideally we need to store slope in the farm object or get it from Sigpac search result\r\n            // Since we don't strictly persist slope in 'Farm' interface yet (only slope_avg in local search), \r\n            // we'll try to use it if we are in 'searchResult', or default to safe 5%\r\n\r\n            // NOTE: We need to access the 'slope' data. It is currently in 'searchResult.slope_avg' which might be lost on refresh.\r\n            // For now, let's assume we want to use the climateData if available.\r\n            // We'll update the interface to store slope in next steps if needed, but for now we pass 0 as safe default or parse it if we had it.\r\n            // Let's assume we add a 'slope' field to Farm?\r\n            // User requested explicit usage of \"slope from sigpac\".\r\n            // We should use `searchResult?.slope_avg` if we are creating, or `farm.slope` if editing.\r\n\r\n            const currentSlope = searchResult?.slope_avg || (editingId ? farms.find(f => f.id === editingId)?.slope : 0) || 0;\r\n\r\n            const recs = calculateFarmRecommendations(soilId, climateData, currentSlope);\r\n            setRecommendations(recs);\r\n        }\r\n    }, [soilId, climateData]);\r\n\r\n    // Helper: Centralized Recommendation Logic (Reusable for Saved Farms)\r\n    const calculateFarmRecommendations = (sId: string, clim: any, slope: number) => {\r\n        // 1. Crops\r\n        const cropRecs = SoilEngine.getRecommendedCrops(sId, clim, slope).map(c => ({\r\n            nombre_alimento: c.crop,\r\n            tipo: c.type,\r\n            reasons: [c.reason]\r\n        }));\r\n\r\n        // 2. Breeds & F1\r\n        // Generate popular F1s\r\n        const f1_candidates = [\r\n            BreedManager.calculateHybrid('ANG', 'BRA'),\r\n            BreedManager.calculateHybrid('HER', 'ANG'),\r\n            BreedManager.calculateHybrid('LIM', 'RET'),\r\n            BreedManager.calculateHybrid('LIM', 'MOR'),\r\n            BreedManager.calculateHybrid('CHA', 'RET')\r\n        ].filter(b => b !== null);\r\n\r\n        const allPure = BreedManager.getAllBreeds();\r\n\r\n        const selectBest = (candidates: any[]) => {\r\n            if (clim && clim.avgTemp > 25) {\r\n                return candidates\r\n                    .filter(b => b.heat_tolerance >= 7)\r\n                    .sort((a, b) => b.heat_tolerance - a.heat_tolerance)\r\n                    .slice(0, 3)\r\n                    .map(b => ({ breed: b.name, reasons: ['Alta tolerancia al calor', 'Adaptaci√≥n'] }));\r\n            } else {\r\n                return candidates\r\n                    .filter(b => b.adg_feedlot > 1.2)\r\n                    .sort((a, b) => b.adg_feedlot - a.adg_feedlot)\r\n                    .slice(0, 3)\r\n                    .map(b => ({ breed: b.name, reasons: ['Alta productividad', 'Eficiencia'] }));\r\n            }\r\n        };\r\n\r\n        const selectedPure = selectBest(allPure);\r\n        const selectedF1 = selectBest(f1_candidates);\r\n\r\n        // Defaults\r\n        if (selectedPure.length === 0) {\r\n            selectedPure.push(...allPure.slice(0, 3).map(b => ({ breed: b.name, reasons: ['Est√°ndar'] })));\r\n        }\r\n        if (selectedF1.length === 0 && f1_candidates.length > 0) {\r\n            selectedF1.push(...f1_candidates.slice(0, 3).map(b => ({ breed: b.name, reasons: ['Vigor H√≠brido Est√°ndar'] })));\r\n        }\r\n\r\n        return { crops: cropRecs, breeds: selectedPure, f1s: selectedF1 };\r\n    };\r\n\r\n    const handleSearchSigpac = async () => {\r\n        if (!municipio || !poligono || !parcela) {\r\n            alert(\"Completa los datos de SIGPAC\");\r\n            return;\r\n        }\r\n        setLoadingSigpac(true);\r\n        try {\r\n            // New Service Call\r\n            const data = await SigpacService.fetchParcelData(\r\n                Number(provincia),\r\n                Number(municipio),\r\n                Number(poligono),\r\n                Number(parcela)\r\n            );\r\n\r\n            if (data) {\r\n                setSearchResult(data);\r\n\r\n                // Auto-Fill Logic\r\n                // Assume 100 heads per 100ha ?\r\n                if (!maxHeads) setMaxHeads(Math.floor(data.area_ha * 2).toString()); // 2 cows per ha\r\n\r\n                // Guess Soil based on Slope/Use (Heuristic)\r\n                // If steep slope > 20%, probably \"Sierra\" (not in our basic list, map to closest or leave empty)\r\n\r\n                if (data.coordinates) {\r\n                    handleAnalyzeClimate(data.coordinates.lat, data.coordinates.lon);\r\n                } else {\r\n                    // Default center of Spain/Extremadura if no coords\r\n                    handleAnalyzeClimate(39.4, -6.0);\r\n                }\r\n\r\n                alert(`‚úÖ Parcela Localizada: ${data.area_ha.toFixed(2)} ha - Uso: ${data.use}`);\r\n            } else {\r\n                alert(\"No se encontr√≥ la parcela en SIGPAC\");\r\n            }\r\n        } catch (e) {\r\n            console.error(e);\r\n            alert(\"Error consultando SIGPAC\");\r\n        } finally {\r\n            setLoadingSigpac(false);\r\n        }\r\n    };\r\n\r\n    // Climate Source State\r\n    const [climateSource, setClimateSource] = useState<'public' | 'private'>('public');\r\n    const [privateApiUrl, setPrivateApiUrl] = useState('');\r\n    const [privateApiKey, setPrivateApiKey] = useState('');\r\n\r\n    const handleAnalyzeClimate = async (lat: number, lon: number) => {\r\n        setAnalyzing(true);\r\n        try {\r\n            if (climateSource === 'private' && privateApiUrl) {\r\n                // Mock Private Station Call\r\n                // In production: await fetch(`${privateApiUrl}?lat=${lat}&lon=${lon}&key=${privateApiKey}`)\r\n                alert(`Conectando a estaci√≥n privada en: ${privateApiUrl}... (Simulaci√≥n)`);\r\n                // Simulate data for now\r\n                setClimateData({ avgTemp: 16.5, classification: 'Clima Local (Estaci√≥n)', annualPrecip: 550 });\r\n            } else {\r\n                // Default Public API (Open-Meteo)\r\n                const analysis = await WeatherService.analyzeClimate(lat, lon);\r\n                if (analysis) {\r\n                    setClimateData(analysis);\r\n                }\r\n            }\r\n        } catch (e) {\r\n            console.error(e);\r\n        } finally {\r\n            setAnalyzing(false);\r\n        }\r\n    };\r\n\r\n    const cleanGisData = (data: any) => {\r\n        // Handle case where we only have aggregate data (no recintos)\r\n        if (!data) return [];\r\n        if (!data.recintos || data.recintos.length === 0) {\r\n            if (data.area_ha) {\r\n                // Return a single virtual recinto\r\n                return [{\r\n                    usage: data.use || 'PR',\r\n                    area: Math.round(data.area_ha * 10000), // Ha to m2\r\n                    dn_oid: 0\r\n                }];\r\n            }\r\n            return [];\r\n        }\r\n        return data.recintos.map((r: any) => ({\r\n            usage: r.uso,\r\n            area: r.superficie * 10000,\r\n            dn_oid: 0\r\n        }));\r\n    };\r\n\r\n    const [selectedFarm, setSelectedFarm] = useState<Farm | null>(null);\r\n    const [editingId, setEditingId] = useState<string | null>(null);\r\n\r\n    const handleDeleteFarm = (id: string) => {\r\n        if (confirm(\"¬øEst√°s seguro de que quieres eliminar esta finca? Esta acci√≥n no se puede deshacer.\")) {\r\n            const updated = farms.filter(f => f.id !== id);\r\n            setFarms(updated);\r\n            write(`fincas_${sessionUser}`, updated);\r\n            setSelectedFarm(null);\r\n        }\r\n    };\r\n\r\n    const handleEditFarm = (farm: Farm) => {\r\n        setEditingId(farm.id);\r\n        setNewName(farm.name);\r\n        setLicense(farm.license || '');\r\n        setProvincia(farm.provinciaCode || '');\r\n        setMunicipio(farm.municipioCode || '');\r\n        setMunicipioName(farm.municipio || '');\r\n        setPoligono(farm.poligono || '');\r\n        setParcela(farm.parcela || '');\r\n        setSoilId(farm.soilId || '');\r\n        setMaxHeads(farm.maxHeads?.toString() || '');\r\n        setCorrals(farm.corrals?.toString() || '');\r\n        setCorralNames(farm.corralNames || Array.from({ length: farm.corrals || 0 }, (_, i) => `Corral ${i + 1}`)); // Load or default\r\n        setFeedingSystem(farm.feedingSystem || ''); // Edit feeding system\r\n\r\n        if (farm.climateStudy) setClimateData(farm.climateStudy);\r\n        if (farm.cropsRecommendation) {\r\n            setRecommendations({ crops: farm.cropsRecommendation, breeds: farm.breedsRecommendation || [] });\r\n        }\r\n\r\n        setSelectedFarm(null);\r\n        setShowForm(true);\r\n    };\r\n\r\n    const [errors, setErrors] = useState<Record<string, boolean>>({});\r\n\r\n    const handleSaveFarm = () => {\r\n        const newErrors: Record<string, boolean> = {};\r\n        if (!newName) newErrors.name = true;\r\n        if (!license) newErrors.license = true;\r\n        if (!soilId) newErrors.soilId = true;\r\n        if (!maxHeads) newErrors.maxHeads = true;\r\n        if (!feedingSystem) newErrors.feedingSystem = true; // Validate\r\n\r\n        if (Object.keys(newErrors).length > 0) {\r\n            setErrors(newErrors);\r\n            alert(\"Por favor, completa todos los campos obligatorios marcados en rojo.\");\r\n            return;\r\n        }\r\n\r\n        let superficie = 0;\r\n        let recintos: any[] = [];\r\n        let coords;\r\n\r\n        if (searchResult) {\r\n            recintos = cleanGisData(searchResult);\r\n            superficie = recintos.reduce((sum: number, r: any) => sum + (r.area || 0), 0);\r\n\r\n            if (searchResult.lat && searchResult.lon) {\r\n                coords = { lat: searchResult.lat, lng: searchResult.lon };\r\n            }\r\n        }\r\n\r\n        const muniObj = municipalities.find(m => m.codigo == municipio || m.codigo == parseInt(municipio));\r\n        const finalMuniName = muniObj ? muniObj.descripcion : municipioName;\r\n\r\n        const id = editingId || (typeof crypto !== 'undefined' && crypto.randomUUID ? crypto.randomUUID() : `farm-${Date.now()}`);\r\n\r\n        const newFarm: Farm = {\r\n            id,\r\n            name: newName,\r\n            municipio: finalMuniName,\r\n            municipioCode: municipio,\r\n            provinciaCode: provincia,\r\n            poligono,\r\n            parcela,\r\n            superficie: superficie || (editingId ? farms.find(f => f.id === editingId)?.superficie || 0 : 0),\r\n            recintos: recintos.length ? recintos : (editingId ? farms.find(f => f.id === editingId)?.recintos || [] : []),\r\n            coords: coords || (editingId ? farms.find(f => f.id === editingId)?.coords : undefined),\r\n            slope: searchResult?.slope_avg || (editingId ? farms.find(f => f.id === editingId)?.slope : 0),\r\n\r\n            license,\r\n            maxHeads: Number(maxHeads),\r\n            soilId,\r\n            corrals: Number(corrals),\r\n            corralNames, // Save names\r\n            feedingSystem,\r\n            climateStudy: climateData,\r\n            cropsRecommendation: recommendations.crops,\r\n            breedsRecommendation: recommendations.breeds,\r\n            f1Recommendation: recommendations.f1s\r\n        };\r\n\r\n        const updated = editingId\r\n            ? farms.map(f => f.id === editingId ? newFarm : f)\r\n            : [...farms, newFarm];\r\n\r\n        setFarms(updated);\r\n        write(`fincas_${sessionUser}`, updated);\r\n\r\n        // Reset\r\n        setNewName('');\r\n        setLicense('');\r\n        setMaxHeads('');\r\n        setSoilId('');\r\n        setCorrals('');\r\n        setCorralNames([]);\r\n        setFeedingSystem('');\r\n        setClimateData(null);\r\n        setRecommendations({ crops: [], breeds: [] });\r\n        setErrors({}); // Clear errors\r\n\r\n        setMunicipio('');\r\n        setMunicipioName('');\r\n        setPoligono('');\r\n        setParcela('');\r\n        setSearchResult(null);\r\n        setShowForm(false);\r\n        setEditingId(null);\r\n\r\n        // Clear Draft\r\n        localStorage.removeItem(`farm_draft_${sessionUser}`);\r\n\r\n        alert(editingId ? \"‚úÖ Finca actualizada correctamente\" : \"‚úÖ Finca guardada correctamente\");\r\n    };\r\n\r\n    // Capacity Logic Helper\r\n    const getCapacityStatus = (farm: Farm) => {\r\n        // Need usage from animal list. Assuming passed or loaded. \r\n        // For now mocking/calculating locally. \r\n        // In real app, we should pass currentCounts from parent or read from storage.\r\n        const animals = read<any[]>(`animals_${sessionUser}`, []);\r\n        const current = animals.filter(a => a.farm === farm.name && (!a.status || a.status === 'Activo')).length;\r\n        const max = farm.maxHeads || 1;\r\n        const pct = (current / max) * 100;\r\n\r\n        let color = 'bg-green-500';\r\n        if (pct >= 100) color = 'bg-red-500';\r\n        else if (pct > 90) color = 'bg-yellow-500';\r\n\r\n        return { current, pct, color };\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <div className=\"flex justify-between items-center\">\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-gray-800\">Mis Fincas</h2>\r\n                    <p className=\"text-gray-600\">Gesti√≥n de parcelas y terrenos</p>\r\n                </div>\r\n                <button\r\n                    onClick={() => {\r\n                        setEditingId(null);\r\n                        setNewName('');\r\n                        setLicense('');\r\n                        setMaxHeads('');\r\n                        setSoilId('');\r\n                        setCorrals('');\r\n                        setCorralNames([]);\r\n                        setFeedingSystem(''); // Reset\r\n                        setClimateData(null);\r\n                        setRecommendations({ crops: [], breeds: [] });\r\n                        setShowForm(true);\r\n                    }}\r\n                    className=\"bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg transition-colors\"\r\n                >\r\n                    {showForm ? 'Cancelar' : 'Nueva Finca'}\r\n                </button>\r\n            </div>\r\n\r\n            {/* Form */}\r\n            {showForm && (\r\n                <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100 animate-in fade-in slide-in-from-top-4\">\r\n                    <h3 className=\"text-lg font-bold text-gray-800 mb-4\">Registrar Finca (SIGPAC)</h3>\r\n\r\n                    {/* Basic Info */}\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4\">\r\n                        <div className=\"md:col-span-2\">\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Nombre Finca *</label>\r\n                            <input type=\"text\" value={newName} onChange={e => setNewName(e.target.value)}\r\n                                className={`w-full border rounded-lg px-3 py-2 ${errors.name ? 'border-red-500 bg-red-50' : ''}`} placeholder=\"Ej: La Dehesa\" />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">N¬∫ Licencia REGA *</label>\r\n                            <input type=\"text\" value={license} onChange={e => setLicense(e.target.value)}\r\n                                className={`w-full border rounded-lg px-3 py-2 ${errors.license ? 'border-red-500 bg-red-50' : ''}`} placeholder=\"ES...\" />\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Cabezas M√°ximas *</label>\r\n                            <input type=\"number\" value={maxHeads} onChange={e => setMaxHeads(e.target.value)}\r\n                                className={`w-full border rounded-lg px-3 py-2 ${errors.maxHeads ? 'border-red-500 bg-red-50' : ''}`} placeholder=\"Ej: 150\" />\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Location */}\r\n                    {/* Location Section - Refined Layout */}\r\n                    <div className=\"space-y-4 mb-6 pt-4 border-t border-gray-100\">\r\n                        <h4 className=\"font-semibold text-gray-800 text-sm\">Ubicaci√≥n (SIGPAC)</h4>\r\n\r\n                        {/* Single Row: Province | Municipality | Poligon | Parcela */}\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Provincia</label>\r\n                                <select\r\n                                    value={provincia}\r\n                                    onChange={(e) => {\r\n                                        setProvincia(e.target.value);\r\n                                        setMunicipio('');\r\n                                    }}\r\n                                    className=\"w-full border rounded-lg px-3 py-2 bg-white focus:border-green-500 focus:outline-none\"\r\n                                >\r\n                                    <option value=\"\">Seleccione Provincia</option>\r\n                                    {SPANISH_PROVINCES.map(p => (\r\n                                        <option key={p.code} value={p.code}>\r\n                                            {p.name}\r\n                                        </option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Municipio</label>\r\n                                <select\r\n                                    value={municipio}\r\n                                    onChange={e => {\r\n                                        setMunicipio(e.target.value);\r\n                                        const m = municipalities.find(mu => mu.codigo == e.target.value);\r\n                                        if (m) setMunicipioName(m.descripcion);\r\n                                    }}\r\n                                    className=\"w-full border rounded-lg px-3 py-2 bg-white focus:border-green-500 focus:outline-none\"\r\n                                    disabled={!provincia}\r\n                                >\r\n                                    <option value=\"\">Seleccione Municipio</option>\r\n                                    {municipalities.map(m => <option key={m.codigo} value={m.codigo}>{m.descripcion}</option>)}\r\n                                </select>\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Pol√≠gono</label>\r\n                                <input type=\"text\" value={poligono} onChange={e => setPoligono(e.target.value)}\r\n                                    className=\"w-full border rounded-lg px-3 py-2 focus:border-green-500 focus:outline-none\" placeholder=\"0\" />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Parcela</label>\r\n                                <div className=\"flex gap-2\">\r\n                                    <input type=\"text\" value={parcela} onChange={e => setParcela(e.target.value)}\r\n                                        className=\"w-full border rounded-lg px-3 py-2 focus:border-green-500 focus:outline-none\" placeholder=\"0\" />\r\n                                    <button onClick={handleSearchSigpac} disabled={loadingSigpac}\r\n                                        className=\"bg-green-600 text-white px-4 rounded-lg hover:bg-green-700 font-medium transition-colors border border-green-700 shadow-sm\">\r\n                                        {loadingSigpac ? '...' : 'Buscar'}\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Technical Specs */}\r\n                    <div className=\"space-y-6\">\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Tipo de Suelo *</label>\r\n                                <select value={soilId} onChange={e => setSoilId(e.target.value)}\r\n                                    className={`w-full border rounded-lg px-3 py-2 bg-white ${errors.soilId ? 'border-red-500 bg-red-50' : ''}`}>\r\n                                    <option value=\"\">Selecciona Suelo</option>\r\n                                    {soilTypes.map(s => <option key={s.id_suelo} value={s.id_suelo}>{s.nombre}</option>)}\r\n                                </select>\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Sistema Alimentaci√≥n *</label>\r\n                                <select value={feedingSystem} onChange={e => setFeedingSystem(e.target.value)}\r\n                                    className={`w-full border rounded-lg px-3 py-2 bg-white ${errors.feedingSystem ? 'border-red-500 bg-red-50' : ''}`}>\r\n                                    <option value=\"\">Selecciona...</option>\r\n                                    <option value=\"extensivo\">Extensivo (Pastoreo)</option>\r\n                                    <option value=\"intensivo\">Intensivo (Cebadero)</option>\r\n                                    <option value=\"mixto\">Mixto (Suplementaci√≥n)</option>\r\n                                    <option value=\"ecologico\">Ecol√≥gico</option>\r\n                                </select>\r\n                            </div>\r\n                            {/* Corrals Section - Number & Names Side-by-Side */}\r\n                            <div className=\"flex gap-4\">\r\n                                <div className=\"w-1/3\">\r\n                                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">N¬∫ Corrales</label>\r\n                                    <input type=\"number\" value={corrals} onChange={e => {\r\n                                        const val = e.target.value;\r\n                                        setCorrals(val);\r\n                                        const num = parseInt(val) || 0;\r\n                                        setCorralNames(prev => {\r\n                                            const newNames = [...prev];\r\n                                            if (num > newNames.length) {\r\n                                                for (let i = newNames.length; i < num; i++) newNames.push(`Corral ${i + 1}`);\r\n                                            } else {\r\n                                                newNames.length = num;\r\n                                            }\r\n                                            return newNames;\r\n                                        });\r\n                                    }}\r\n                                        className=\"w-full border rounded-lg px-3 py-2\" placeholder=\"0\" />\r\n                                </div>\r\n                                <div className=\"flex-1\">\r\n                                    {corralNames.length > 0 && (\r\n                                        <div className=\"bg-gray-50 rounded border border-gray-100 p-2 max-h-40 overflow-y-auto\">\r\n                                            <label className=\"block text-xs font-bold text-gray-500 uppercase mb-2\">Nombres</label>\r\n                                            <div className=\"space-y-2\">\r\n                                                {corralNames.map((name, idx) => (\r\n                                                    <div key={idx} className=\"flex items-center gap-2\">\r\n                                                        <span className=\"text-xs text-gray-400 w-6\">#{idx + 1}</span>\r\n                                                        <input\r\n                                                            type=\"text\"\r\n                                                            value={name}\r\n                                                            onChange={e => {\r\n                                                                const newNames = [...corralNames];\r\n                                                                newNames[idx] = e.target.value;\r\n                                                                setCorralNames(newNames);\r\n                                                            }}\r\n                                                            className=\"flex-1 text-xs border rounded px-2 py-1 focus:ring-1 focus:ring-green-500 outline-none\"\r\n                                                        />\r\n                                                    </div>\r\n                                                ))}\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Unified Row: Climate | Pure | F1 | Crops */}\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6 items-start\">\r\n\r\n                            {/* Col 1: Climate Data (Green) */}\r\n                            <div className=\"border border-green-200 bg-green-50 p-3 rounded-lg flex flex-col h-full\">\r\n                                <div>\r\n                                    <h4 className=\"font-semibold text-green-900 text-sm mb-3\">Datos Clim√°ticos</h4>\r\n                                    <div className=\"space-y-2 mb-3\">\r\n                                        <label className=\"flex items-center gap-2 text-sm text-green-800 cursor-pointer\">\r\n                                            <input type=\"radio\" name=\"climateSource\" defaultChecked className=\"text-green-600 focus:ring-green-500\" />\r\n                                            API P√∫blica\r\n                                        </label>\r\n                                        <label className=\"flex items-center gap-2 text-sm text-green-800/50 cursor-not-allowed\">\r\n                                            <input type=\"radio\" name=\"climateSource\" disabled />\r\n                                            Estaci√≥n Propia\r\n                                        </label>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"text-sm text-green-800 pt-3 border-t border-green-200/50\">\r\n                                    {provincia && municipio ? (\r\n                                        <div className=\"space-y-1\">\r\n                                            <p className=\"flex justify-between\"><span>Media:</span> <strong>15.4¬∞C</strong></p>\r\n                                            <p className=\"flex justify-between\"><span>Clima:</span> <strong>Templado Seco</strong></p>\r\n                                            <p className=\"flex justify-between\"><span>Precip:</span> <strong>431mm</strong></p>\r\n                                        </div>\r\n                                    ) : (\r\n                                        <p className=\"text-green-600 italic\">Selecciona ubicaci√≥n...</p>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Col 2: Pure Breeds (Orange) */}\r\n                            <div className=\"border border-orange-200 bg-orange-50 p-3 rounded-lg flex flex-col h-full\">\r\n                                <h4 className=\"font-semibold text-orange-900 text-sm mb-3\">Razas Puras</h4>\r\n                                {recommendations.breeds.length > 0 ? (\r\n                                    <>\r\n                                        <ul className=\"text-sm space-y-3 flex-1\">\r\n                                            {recommendations.breeds.slice(0, showAllBreeds ? undefined : 3).map((r: any, i: number) => (\r\n                                                <li key={i} className=\"text-orange-900 pb-2 border-b border-orange-200/50 last:border-0 last:pb-0\">\r\n                                                    <strong className=\"text-orange-900 block\">{r.breed}</strong>\r\n                                                    <span className=\"text-[11px] text-orange-700\">({r.reasons.join(', ').replace('(GMD)', '')})</span>\r\n                                                </li>\r\n                                            ))}\r\n                                        </ul>\r\n                                        {recommendations.breeds.length > 3 && (\r\n                                            <button\r\n                                                onClick={() => setShowAllBreeds(!showAllBreeds)}\r\n                                                className=\"text-[11px] text-orange-700 font-medium hover:text-orange-900 mt-2 text-center w-full pt-2 border-t border-orange-200/50\"\r\n                                            >\r\n                                                {showAllBreeds ? 'Ver menos' : `Ver ${recommendations.breeds.length - 3} m√°s...`}\r\n                                            </button>\r\n                                        )}\r\n                                    </>\r\n                                ) : (\r\n                                    <p className=\"text-sm text-orange-400 italic\">Completa datos...</p>\r\n                                )}\r\n                            </div>\r\n\r\n                            {/* Col 3: F1 Crossbreeds (Amber) */}\r\n                            <div className=\"border border-amber-200 bg-amber-50 p-3 rounded-lg flex flex-col h-full\">\r\n                                <h4 className=\"font-semibold text-amber-900 text-sm mb-3\">Cruces F1</h4>\r\n                                {recommendations.f1s && recommendations.f1s.length > 0 ? (\r\n                                    <>\r\n                                        <ul className=\"text-sm space-y-3 flex-1\">\r\n                                            {recommendations.f1s.slice(0, showAllF1s ? undefined : 3).map((r: any, i: number) => (\r\n                                                <li key={i} className=\"text-amber-900 pb-2 border-b border-amber-200/50 last:border-0 last:pb-0\">\r\n                                                    <strong className=\"text-amber-900 block\" title={r.breed}>{r.breed}</strong>\r\n                                                    <span className=\"text-[11px] text-amber-700\">({r.reasons.join(', ')})</span>\r\n                                                </li>\r\n                                            ))}\r\n                                        </ul>\r\n                                        {recommendations.f1s.length > 3 && (\r\n                                            <button\r\n                                                onClick={() => setShowAllF1s(!showAllF1s)}\r\n                                                className=\"text-[11px] text-amber-700 font-medium hover:text-amber-900 mt-2 text-center w-full pt-2 border-t border-amber-200/50\"\r\n                                            >\r\n                                                {showAllF1s ? 'Ver menos' : `Ver ${recommendations.f1s.length - 3} m√°s...`}\r\n                                            </button>\r\n                                        )}\r\n                                    </>\r\n                                ) : (\r\n                                    <p className=\"text-sm text-amber-400 italic\">Calculando...</p>\r\n                                )}\r\n                            </div>\r\n\r\n                            {/* Col 4: Crops (Emerald) */}\r\n                            <div className=\"border border-emerald-200 bg-emerald-50 p-3 rounded-lg flex flex-col h-full\">\r\n                                <h4 className=\"font-semibold text-emerald-900 text-sm mb-3\">Cultivos</h4>\r\n                                {recommendations.crops.length > 0 ? (\r\n                                    <>\r\n                                        <ul className=\"text-sm space-y-3 flex-1\">\r\n                                            {recommendations.crops.slice(0, showAllCrops ? undefined : 3).map((r: any, i: number) => (\r\n                                                <li key={i} className=\"text-emerald-900 pb-2 border-b border-emerald-200/50 last:border-0 last:pb-0\">\r\n                                                    <strong className=\"text-emerald-900 block\">{r.nombre_alimento}</strong>\r\n                                                    <span className=\"text-[11px] text-emerald-700\">({r.tipo})</span>\r\n                                                </li>\r\n                                            ))}\r\n                                        </ul>\r\n                                        {recommendations.crops.length > 3 && (\r\n                                            <button\r\n                                                onClick={() => setShowAllCrops(!showAllCrops)}\r\n                                                className=\"text-[11px] text-emerald-700 font-medium hover:text-emerald-900 mt-2 text-center w-full pt-2 border-t border-emerald-200/50\"\r\n                                            >\r\n                                                {showAllCrops ? 'Ver menos' : `Ver ${recommendations.crops.length - 3} m√°s...`}\r\n                                            </button>\r\n                                        )}\r\n                                    </>\r\n                                ) : (\r\n                                    <p className=\"text-sm text-emerald-400 italic\">Completa datos...</p>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex justify-end gap-3 pt-4 border-t\">\r\n                        <button onClick={() => setShowForm(false)} className=\"text-gray-600 hover:text-gray-800 font-medium px-4\">\r\n                            Cancelar\r\n                        </button>\r\n                        <button onClick={handleSaveFarm} className=\"bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-6 rounded-lg\">\r\n                            Guardar Finca Completa\r\n                        </button>\r\n                    </div>\r\n                </div >\r\n            )\r\n            }\r\n\r\n            {/* Farm Detail Modal */}\r\n            {\r\n                selectedFarm && (\r\n                    <div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4\">\r\n                        <div className=\"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\r\n                            <div className=\"p-6\">\r\n                                <div className=\"flex justify-between items-start mb-6\">\r\n                                    <div>\r\n                                        <h2 className=\"text-2xl font-bold text-gray-900\">{selectedFarm.name}</h2>\r\n                                        <p className=\"text-gray-500 text-sm\">Licencia: {selectedFarm.license}</p>\r\n                                    </div>\r\n                                    <button onClick={() => setSelectedFarm(null)} className=\"text-gray-400 hover:text-gray-600\">‚úï</button>\r\n                                </div>\r\n\r\n                                <div className=\"grid grid-cols-2 gap-4 mb-6 text-sm\">\r\n                                    <div className=\"bg-gray-50 p-3 rounded\">\r\n                                        <p className=\"text-gray-500 text-xs uppercase mb-1\">Ubicaci√≥n</p>\r\n                                        <p className=\"font-medium\">{selectedFarm.municipio}</p>\r\n                                        <p>Pol√≠gono {selectedFarm.poligono} / Parcela {selectedFarm.parcela}</p>\r\n                                    </div>\r\n                                    <div className=\"bg-gray-50 p-3 rounded\">\r\n                                        <p className=\"text-gray-500 text-xs uppercase mb-1\">Superficie</p>\r\n                                        <p className=\"font-medium text-lg\">\r\n                                            {Number(selectedFarm.superficie / 10000).toLocaleString('es-ES', { minimumFractionDigits: 2, maximumFractionDigits: 4 })} ha\r\n                                        </p>\r\n                                    </div>\r\n                                    <div className=\"bg-gray-50 p-3 rounded\">\r\n                                        <p className=\"text-gray-500 text-xs uppercase mb-1\">Capacidad</p>\r\n                                        <p className=\"font-medium\">{getCapacityStatus(selectedFarm).current} / {selectedFarm.maxHeads} cabezas</p>\r\n                                        <div className=\"w-full bg-gray-200 rounded-full h-1.5 mt-2\">\r\n                                            <div className={`${getCapacityStatus(selectedFarm).color} h-1.5 rounded-full`}\r\n                                                style={{ width: `${Math.min(getCapacityStatus(selectedFarm).pct, 100)}%` }}></div>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"bg-gray-50 p-3 rounded\">\r\n                                        <p className=\"text-gray-500 text-xs uppercase mb-1\">Suelo / Sistema</p>\r\n                                        <p className=\"text-sm font-medium text-gray-900\">{soilTypes.find(s => s.id_suelo === selectedFarm.soilId)?.nombre || 'Desconocido'}</p>\r\n                                        <p className=\"text-sm font-medium text-gray-900 capitalize\">{selectedFarm.feedingSystem || 'No definido'}</p>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Technical Specs Display Grid - 4 Cols */}\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6 items-start\">\r\n\r\n                                    {/* Climate (Green) */}\r\n                                    {selectedFarm.climateStudy && (\r\n                                        <div className=\"border border-green-200 bg-green-50 p-3 rounded-lg flex flex-col h-full\">\r\n                                            <h4 className=\"font-semibold text-green-900 text-sm mb-3\">Datos Clim√°ticos</h4>\r\n                                            <div className=\"space-y-1 text-sm text-green-800\">\r\n                                                <p className=\"flex justify-between\"><span>Clima:</span> <strong>{selectedFarm.climateStudy.classification}</strong></p>\r\n                                                <p className=\"flex justify-between\"><span>Media:</span> <strong>{selectedFarm.climateStudy.avgTemp}¬∞C</strong></p>\r\n                                                <p className=\"flex justify-between\"><span>Precip:</span> <strong>{selectedFarm.climateStudy.annualPrecip}mm</strong></p>\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {/* Pure Breeds (Orange) */}\r\n                                    {selectedFarm.breedsRecommendation && (\r\n                                        <div className=\"border border-orange-200 bg-orange-50 p-3 rounded-lg flex flex-col h-full\">\r\n                                            <h4 className=\"font-semibold text-orange-900 text-sm mb-3\">Razas Puras</h4>\r\n                                            <ul className=\"text-sm space-y-2\">\r\n                                                {selectedFarm.breedsRecommendation.slice(0, 3).map((r: any, i: number) => (\r\n                                                    <li key={i} className=\"text-orange-900 pb-1 border-b border-orange-200/50 last:border-0\">\r\n                                                        <strong className=\"text-orange-900 block\">{r.breed}</strong>\r\n                                                        <span className=\"text-[11px] text-orange-700\">({r.reasons ? r.reasons[0].replace('(GMD)', '') : ''})</span>\r\n                                                    </li>\r\n                                                ))}\r\n                                            </ul>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {/* F1 Crosses (Amber) */}\r\n                                    <div className=\"border border-amber-200 bg-amber-50 p-3 rounded-lg flex flex-col h-full\">\r\n                                        <h4 className=\"font-semibold text-amber-900 text-sm mb-3\">Cruces F1</h4>\r\n                                        {(() => {\r\n                                            const f1s = (selectedFarm.f1Recommendation && selectedFarm.f1Recommendation.length > 0)\r\n                                                ? selectedFarm.f1Recommendation\r\n                                                : (selectedFarm.climateStudy ? calculateFarmRecommendations(selectedFarm.soilId, selectedFarm.climateStudy, selectedFarm.slope || 0).f1s : []);\r\n\r\n                                            return f1s.length > 0 ? (\r\n                                                <ul className=\"text-sm space-y-2\">\r\n                                                    {f1s.slice(0, 3).map((r: any, i: number) => (\r\n                                                        <li key={i} className=\"text-amber-900 pb-1 border-b border-amber-200/50 last:border-0\">\r\n                                                            <strong className=\"text-amber-900 block\">{r.breed}</strong>\r\n                                                            <span className=\"text-[11px] text-amber-700\">({r.reasons ? r.reasons.join(', ') : ''})</span>\r\n                                                        </li>\r\n                                                    ))}\r\n                                                </ul>\r\n                                            ) : (\r\n                                                <p className=\"text-sm text-amber-600/70 italic\">No calculados</p>\r\n                                            );\r\n                                        })()}\r\n                                    </div>\r\n\r\n                                    {/* Crops (Emerald) */}\r\n                                    {selectedFarm.cropsRecommendation && (\r\n                                        <div className=\"border border-emerald-200 bg-emerald-50 p-3 rounded-lg flex flex-col h-full\">\r\n                                            <h4 className=\"font-semibold text-emerald-900 text-sm mb-3\">Cultivos</h4>\r\n                                            <ul className=\"text-sm space-y-2\">\r\n                                                {selectedFarm.cropsRecommendation.slice(0, 3).map((r: any, i: number) => (\r\n                                                    <li key={i} className=\"text-emerald-900 pb-1 border-b border-emerald-200/50 last:border-0\">\r\n                                                        <strong className=\"text-emerald-900 block\">{r.nombre_alimento}</strong>\r\n                                                        <span className=\"text-[11px] text-emerald-700\">({r.tipo})</span>\r\n                                                    </li>\r\n                                                ))}\r\n                                            </ul>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n\r\n                                <div className=\"flex justify-end gap-3 mt-8 pt-4 border-t\">\r\n                                    {/* RBAC: Only Admin can delete */}\r\n                                    {read<any[]>('users', []).find((u: any) => u.name === sessionUser)?.role === 'admin' && (\r\n                                        <button\r\n                                            onClick={() => handleDeleteFarm(selectedFarm.id)}\r\n                                            className=\"px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg text-sm font-medium transition-colors\"\r\n                                        >\r\n                                            Eliminar Finca\r\n                                        </button>\r\n                                    )}\r\n                                    <button\r\n                                        onClick={() => handleEditFarm(selectedFarm)}\r\n                                        className=\"px-6 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 transition-colors shadow-sm\"\r\n                                    >\r\n                                        Editar Informaci√≥n\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )\r\n            }\r\n\r\n            {/* List */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                {farms.map(f => {\r\n                    const cap = getCapacityStatus(f);\r\n                    return (\r\n                        <div key={f.id}\r\n                            onClick={() => setSelectedFarm(f)}\r\n                            className=\"cursor-pointer bg-white p-6 rounded-xl shadow-sm border border-gray-100 hover:shadow-lg transition-all transform hover:-translate-y-1 group\">\r\n                            <div className=\"flex justify-between items-start mb-2\">\r\n                                <h3 className=\"text-xl font-bold text-gray-800 group-hover:text-green-700 transition-colors\">{f.name}</h3>\r\n                                <span className=\"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded\">{f.license || 'Sin Licencia'}</span>\r\n                            </div>\r\n\r\n                            <div className=\"text-sm text-gray-600 space-y-2 mb-4\">\r\n                                <p>{f.municipio} ({Number(f.superficie / 10000).toLocaleString('es-ES', { minimumFractionDigits: 2, maximumFractionDigits: 4 })} ha)</p>\r\n                                <div className=\"space-y-1\">\r\n                                    <div className=\"flex justify-between text-xs\">\r\n                                        <span>Capacidad ({cap.current}/{f.maxHeads})</span>\r\n                                        <span className={cap.pct >= 100 ? 'text-red-600 font-bold' : 'text-gray-500'}>\r\n                                            {cap.pct.toFixed(0)}%\r\n                                        </span>\r\n                                    </div>\r\n                                    <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n                                        <div className={`${cap.color} h-2 rounded-full`} style={{ width: `${Math.min(cap.pct, 100)}%` }}></div>\r\n                                    </div>\r\n                                    {cap.pct >= 100 && <p className=\"text-xs text-red-600 font-bold\">Exceso de capacidad</p>}\r\n                                </div>\r\n                                <p className=\"text-xs text-gray-500\">\r\n                                    Suelo: {soilTypes.find(s => s.id_suelo === f.soilId)?.nombre || 'Desconocido'}\r\n                                    {f.climateStudy && ` | Clima: ${f.climateStudy.classification}`}\r\n                                </p>\r\n                            </div>\r\n                            <div className=\"text-center text-xs text-green-600 font-medium opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                                Ver Ficha Completa ‚Üí\r\n                            </div>\r\n                        </div>\r\n                    );\r\n                })}\r\n            </div>\r\n        </div >\r\n    );\r\n}\r\n"],"names":[],"mappings":"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","ignoreList":[16,18,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,42,43,44,45,46,47,49]}